import{$ as Nh,A as ht,B as fS,C as pS,D as On,E as Ci,F as Rh,G as mc,H as u_,I as gS,J as mS,K as ne,L as ln,M as _t,N as c_,O as yS,P as yc,Q as _e,R as yn,S as xh,T as l_,U as Fn,V as Di,W as Ss,X as _c,Y as Mh,Z as _S,_ as Rs,a as G,aa as it,b as xe,ba as vt,c as iS,ca as d_,d as s_,e as x,f as sS,g as Ch,h as oS,i as aS,j as L,k as qo,l as Dh,m as uS,n as cS,o as Th,p as It,q as bh,r as gc,s as o_,t as lS,u as gr,v as a_,w as Ah,x as dS,y as hS,z as Sh}from"./chunk-MQJ75LOD.js";var vS=null;var h_=1,wS=Symbol("SIGNAL");function Ie(n){let e=vS;return vS=n,e}var ES={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function _j(n){if(!(g_(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===h_)){if(!n.producerMustRecompute(n)&&!f_(n)){n.dirty=!1,n.lastCleanEpoch=h_;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=h_}}function IS(n){return n&&(n.nextProducerIndex=0),Ie(n)}function CS(n,e){if(Ie(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(g_(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)p_(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function f_(n){Ph(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(_j(t),r!==t.version))return!0}return!1}function DS(n){if(Ph(n),g_(n))for(let e=0;e<n.producerNode.length;e++)p_(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function p_(n,e){if(vj(n),Ph(n),n.liveConsumerNode.length===1)for(let r=0;r<n.producerNode.length;r++)p_(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];Ph(i),i.producerIndexOfThis[r]=e}}function g_(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Ph(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function vj(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function wj(){throw new Error}var Ej=wj;function TS(n){Ej=n}function ie(n){return typeof n=="function"}function Ho(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var kh=Ho(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function xs(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var st=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(ie(r))try{r()}catch(s){e=s instanceof kh?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{bS(s)}catch(o){e=e??[],o instanceof kh?e=[...e,...o.errors]:e.push(o)}}if(e)throw new kh(e)}}add(e){var t;if(e&&e!==this)if(this.closed)bS(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&xs(t,e)}remove(e){let{_finalizers:t}=this;t&&xs(t,e),e instanceof n&&e._removeParent(this)}};st.EMPTY=(()=>{let n=new st;return n.closed=!0,n})();var m_=st.EMPTY;function Oh(n){return n instanceof st||n&&"closed"in n&&ie(n.remove)&&ie(n.add)&&ie(n.unsubscribe)}function bS(n){ie(n)?n():n.unsubscribe()}var Jn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Go={setTimeout(n,e,...t){let{delegate:r}=Go;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Go;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Fh(n){Go.setTimeout(()=>{let{onUnhandledError:e}=Jn;if(e)e(n);else throw n})}function Ms(){}var AS=y_("C",void 0,void 0);function SS(n){return y_("E",void 0,n)}function RS(n){return y_("N",n,void 0)}function y_(n,e,t){return{kind:n,value:e,error:t}}var Ns=null;function zo(n){if(Jn.useDeprecatedSynchronousErrorHandling){let e=!Ns;if(e&&(Ns={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=Ns;if(Ns=null,t)throw r}}else n()}function xS(n){Jn.useDeprecatedSynchronousErrorHandling&&Ns&&(Ns.errorThrown=!0,Ns.error=n)}var Ps=class extends st{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Oh(e)&&e.add(this)):this.destination=Dj}static create(e,t,r){return new Kr(e,t,r)}next(e){this.isStopped?v_(RS(e),this):this._next(e)}error(e){this.isStopped?v_(SS(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?v_(AS,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},Ij=Function.prototype.bind;function __(n,e){return Ij.call(n,e)}var w_=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Vh(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Vh(r)}else Vh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Vh(t)}}},Kr=class extends Ps{constructor(e,t,r){super();let i;if(ie(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&Jn.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&__(e.next,s),error:e.error&&__(e.error,s),complete:e.complete&&__(e.complete,s)}):i=e}this.destination=new w_(i)}};function Vh(n){Jn.useDeprecatedSynchronousErrorHandling?xS(n):Fh(n)}function Cj(n){throw n}function v_(n,e){let{onStoppedNotification:t}=Jn;t&&Go.setTimeout(()=>t(n,e))}var Dj={closed:!0,next:Ms,error:Cj,complete:Ms};var Wo=typeof Symbol=="function"&&Symbol.observable||"@@observable";function xt(n){return n}function E_(...n){return I_(n)}function I_(n){return n.length===0?xt:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var ce=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=bj(t)?t:new Kr(t,r,i);return zo(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=MS(r),new r((i,s)=>{let o=new Kr({next:a=>{try{t(a)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Wo](){return this}pipe(...t){return I_(t)(this)}toPromise(t){return t=MS(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function MS(n){var e;return(e=n??Jn.Promise)!==null&&e!==void 0?e:Promise}function Tj(n){return n&&ie(n.next)&&ie(n.error)&&ie(n.complete)}function bj(n){return n&&n instanceof Ps||Tj(n)&&Oh(n)}function C_(n){return ie(n?.lift)}function oe(n){return e=>{if(C_(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function se(n,e,t,r,i){return new D_(n,e,t,r,i)}var D_=class extends Ps{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Ko(){return oe((n,e)=>{let t=null;n._refCount++;let r=se(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var Qo=class extends ce{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,C_(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new st;let t=this.getSubject();e.add(this.source.subscribe(se(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=st.EMPTY)}return e}refCount(){return Ko()(this)}};var NS=Ho(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var et=(()=>{class n extends ce{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new Lh(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new NS}next(t){zo(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){zo(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){zo(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?m_:(this.currentObservers=null,s.push(t),new st(()=>{this.currentObservers=null,xs(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new ce;return t.source=this,t}}return n.create=(e,t)=>new Lh(e,t),n})(),Lh=class extends et{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:m_}};var Mt=class extends et{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var vc={now(){return(vc.delegate||Date).now()},delegate:void 0};var jh=class extends et{constructor(e=1/0,t=1/0,r=vc){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){let{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;t||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){let{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=t.now(),a=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)a=u;a&&r.splice(0,a+1)}}};var Uh=class extends st{constructor(e,t){super()}schedule(e,t=0){return this}};var wc={setInterval(n,e,...t){let{delegate:r}=wc;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=wc;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var Yo=class extends Uh{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,r=0){return wc.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&wc.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,xs(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var Zo=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};Zo.now=vc.now;var Jo=class extends Zo{constructor(e,t=Zo.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var ks=new Jo(Yo);var Bh=class extends Yo{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var $h=class extends Jo{};var T_=new $h(Bh);var Zt=new ce(n=>n.complete());function PS(n){return n&&ie(n.schedule)}function b_(n){return n[n.length-1]}function Xo(n){return ie(b_(n))?n.pop():void 0}function mr(n){return PS(b_(n))?n.pop():void 0}function kS(n,e){return typeof b_(n)=="number"?n.pop():e}var qh=n=>n&&typeof n.length=="number"&&typeof n!="function";function Hh(n){return ie(n?.then)}function Gh(n){return ie(n[Wo])}function zh(n){return Symbol.asyncIterator&&ie(n?.[Symbol.asyncIterator])}function Wh(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function Aj(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Kh=Aj();function Qh(n){return ie(n?.[Kh])}function Yh(n){return oS(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Ch(t.read());if(i)return yield Ch(void 0);yield yield Ch(r)}}finally{t.releaseLock()}})}function Zh(n){return ie(n?.getReader)}function Ve(n){if(n instanceof ce)return n;if(n!=null){if(Gh(n))return Sj(n);if(qh(n))return Rj(n);if(Hh(n))return xj(n);if(zh(n))return OS(n);if(Qh(n))return Mj(n);if(Zh(n))return Nj(n)}throw Wh(n)}function Sj(n){return new ce(e=>{let t=n[Wo]();if(ie(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Rj(n){return new ce(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function xj(n){return new ce(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Fh)})}function Mj(n){return new ce(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function OS(n){return new ce(e=>{Pj(n,e).catch(t=>e.error(t))})}function Nj(n){return OS(Yh(n))}function Pj(n,e){var t,r,i,s;return sS(this,void 0,void 0,function*(){try{for(t=aS(n);r=yield t.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function dn(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function _n(n,e=0){return oe((t,r)=>{t.subscribe(se(r,i=>dn(r,n,()=>r.next(i),e),()=>dn(r,n,()=>r.complete(),e),i=>dn(r,n,()=>r.error(i),e)))})}function Vn(n,e=0){return oe((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function FS(n,e){return Ve(n).pipe(Vn(e),_n(e))}function VS(n,e){return Ve(n).pipe(Vn(e),_n(e))}function LS(n,e){return new ce(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function jS(n,e){return new ce(t=>{let r;return dn(t,e,()=>{r=n[Kh](),dn(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>ie(r?.return)&&r.return()})}function Jh(n,e){if(!n)throw new Error("Iterable cannot be null");return new ce(t=>{dn(t,e,()=>{let r=n[Symbol.asyncIterator]();dn(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function US(n,e){return Jh(Yh(n),e)}function BS(n,e){if(n!=null){if(Gh(n))return FS(n,e);if(qh(n))return LS(n,e);if(Hh(n))return VS(n,e);if(zh(n))return Jh(n,e);if(Qh(n))return jS(n,e);if(Zh(n))return US(n,e)}throw Wh(n)}function Ce(n,e){return e?BS(n,e):Ve(n)}function Z(...n){let e=mr(n);return Ce(n,e)}function ea(n,e){let t=ie(n)?n:()=>n,r=i=>i.error(t());return new ce(e?i=>e.schedule(r,0,i):r)}function A_(n){return!!n&&(n instanceof ce||ie(n.lift)&&ie(n.subscribe))}var Qr=Ho(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Q(n,e){return oe((t,r)=>{let i=0;t.subscribe(se(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:kj}=Array;function Oj(n,e){return kj(e)?n(...e):n(e)}function Xh(n){return Q(e=>Oj(n,e))}var{isArray:Fj}=Array,{getPrototypeOf:Vj,prototype:Lj,keys:jj}=Object;function ef(n){if(n.length===1){let e=n[0];if(Fj(e))return{args:e,keys:null};if(Uj(e)){let t=jj(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function Uj(n){return n&&typeof n=="object"&&Vj(n)===Lj}function tf(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function Ec(...n){let e=mr(n),t=Xo(n),{args:r,keys:i}=ef(n);if(r.length===0)return Ce([],e);let s=new ce(Bj(r,e,i?o=>tf(i,o):xt));return t?s.pipe(Xh(t)):s}function Bj(n,e,t=xt){return r=>{$S(e,()=>{let{length:i}=n,s=new Array(i),o=i,a=i;for(let u=0;u<i;u++)$S(e,()=>{let l=Ce(n[u],e),d=!1;l.subscribe(se(r,h=>{s[u]=h,d||(d=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function $S(n,e,t){n?dn(t,n,e):e()}function qS(n,e,t,r,i,s,o,a){let u=[],l=0,d=0,h=!1,g=()=>{h&&!u.length&&!l&&e.complete()},y=D=>l<r?v(D):u.push(D),v=D=>{s&&e.next(D),l++;let A=!1;Ve(t(D,d++)).subscribe(se(e,P=>{i?.(P),s?y(P):e.next(P)},()=>{A=!0},void 0,()=>{if(A)try{for(l--;u.length&&l<r;){let P=u.shift();o?dn(e,o,()=>v(P)):v(P)}g()}catch(P){e.error(P)}}))};return n.subscribe(se(e,y,()=>{h=!0,g()})),()=>{a?.()}}function ft(n,e,t=1/0){return ie(e)?ft((r,i)=>Q((s,o)=>e(r,s,i,o))(Ve(n(r,i))),t):(typeof e=="number"&&(t=e),oe((r,i)=>qS(r,i,n,t)))}function Ti(n=1/0){return ft(xt,n)}function HS(){return Ti(1)}function ta(...n){return HS()(Ce(n,mr(n)))}function nf(n){return new ce(e=>{Ve(n()).subscribe(e)})}function S_(...n){let e=Xo(n),{args:t,keys:r}=ef(n),i=new ce(s=>{let{length:o}=t;if(!o){s.complete();return}let a=new Array(o),u=o,l=o;for(let d=0;d<o;d++){let h=!1;Ve(t[d]).subscribe(se(s,g=>{h||(h=!0,l--),a[d]=g},()=>u--,void 0,()=>{(!u||!h)&&(l||s.next(r?tf(r,a):a),s.complete())}))}});return e?i.pipe(Xh(e)):i}function na(...n){let e=mr(n),t=kS(n,1/0),r=n;return r.length?r.length===1?Ve(r[0]):Ti(t)(Ce(r,e)):Zt}function Ct(n,e){return oe((t,r)=>{let i=0;t.subscribe(se(r,s=>n.call(e,s,i++)&&r.next(s)))})}function bi(n){return oe((e,t)=>{let r=null,i=!1,s;r=e.subscribe(se(t,void 0,void 0,o=>{s=Ve(n(o,bi(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function GS(n,e,t,r,i){return(s,o)=>{let a=t,u=e,l=0;s.subscribe(se(o,d=>{let h=l++;u=a?n(u,d,h):(a=!0,d),r&&o.next(u)},i&&(()=>{a&&o.next(u),o.complete()})))}}function Ai(n,e){return ie(e)?ft(n,e,1):ft(n,1)}function Si(n){return oe((e,t)=>{let r=!1;e.subscribe(se(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Yr(n){return n<=0?()=>Zt:oe((e,t)=>{let r=0;e.subscribe(se(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function R_(n){return Q(()=>n)}function Ic(n,e=xt){return n=n??$j,oe((t,r)=>{let i,s=!0;t.subscribe(se(r,o=>{let a=e(o);(s||!n(i,a))&&(s=!1,i=a,r.next(o))}))})}function $j(n,e){return n===e}function rf(n=qj){return oe((e,t)=>{let r=!1;e.subscribe(se(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function qj(){return new Qr}function ra(n){return oe((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function vn(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Ct((i,s)=>n(i,s,r)):xt,Yr(1),t?Si(e):rf(()=>new Qr))}function ia(n){return n<=0?()=>Zt:oe((e,t)=>{let r=[];e.subscribe(se(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function x_(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Ct((i,s)=>n(i,s,r)):xt,ia(1),t?Si(e):rf(()=>new Qr))}function Cc(){return oe((n,e)=>{let t,r=!1;n.subscribe(se(e,i=>{let s=t;t=i,r&&e.next([s,i]),r=!0}))})}function yr(n,e){return oe(GS(n,e,arguments.length>=2,!0))}function Dc(n={}){let{connector:e=()=>new et,resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=n;return s=>{let o,a,u,l=0,d=!1,h=!1,g=()=>{a?.unsubscribe(),a=void 0},y=()=>{g(),o=u=void 0,d=h=!1},v=()=>{let D=o;y(),D?.unsubscribe()};return oe((D,A)=>{l++,!h&&!d&&g();let P=u=u??e();A.add(()=>{l--,l===0&&!h&&!d&&(a=M_(v,i))}),P.subscribe(A),!o&&l>0&&(o=new Kr({next:B=>P.next(B),error:B=>{h=!0,g(),a=M_(y,t,B),P.error(B)},complete:()=>{d=!0,g(),a=M_(y,r),P.complete()}}),Ve(D).subscribe(o))})(s)}}function M_(n,e,...t){if(e===!0){n();return}if(e===!1)return;let r=new Kr({next:()=>{r.unsubscribe(),n()}});return Ve(e(...t)).subscribe(r)}function sf(n,e,t){let r,i=!1;return n&&typeof n=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n:r=n??1/0,Dc({connector:()=>new jh(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function N_(n){return oe((e,t)=>{let r=!1,i=0;e.subscribe(se(t,s=>(r||(r=!n(s,i++)))&&t.next(s)))})}function Os(...n){let e=mr(n);return oe((t,r)=>{(e?ta(n,t,e):ta(n,t)).subscribe(r)})}function He(n,e){return oe((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe(se(r,u=>{i?.unsubscribe();let l=0,d=s++;Ve(n(u,d)).subscribe(i=se(r,h=>r.next(e?e(u,h,d,l++):h),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function of(n,e){return ie(e)?He(()=>n,e):He(()=>n)}function P_(n){return oe((e,t)=>{Ve(n).subscribe(se(t,()=>t.complete(),Ms)),!t.closed&&e.subscribe(t)})}function ot(n,e,t){let r=ie(n)||e||t?{next:n,error:e,complete:t}:n;return r?oe((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(se(s,u=>{var l;(l=r.next)===null||l===void 0||l.call(r,u),s.next(u)},()=>{var u;a=!1,(u=r.complete)===null||u===void 0||u.call(r),s.complete()},u=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,u),s.error(u)},()=>{var u,l;a&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):xt}function k_(...n){let e=Xo(n);return oe((t,r)=>{let i=n.length,s=new Array(i),o=n.map(()=>!1),a=!1;for(let u=0;u<i;u++)Ve(n[u]).subscribe(se(r,l=>{s[u]=l,!a&&!o[u]&&(o[u]=!0,(a=o.every(xt))&&(o=null))},Ms));t.subscribe(se(r,u=>{if(a){let l=[u,...s];r.next(e?e(...l):l)}}))})}var RR="https://g.co/ng/security#xss",ee=class extends Error{constructor(e,t){super(Bf(e,t)),this.code=e}};function Bf(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function Bc(n){return{toString:n}.toString()}var af="__parameters__";function Hj(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function xR(n,e,t){return Bc(()=>{let r=Hj(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(u,l,d){let h=u.hasOwnProperty(af)?u[af]:Object.defineProperty(u,af,{value:[]})[af];for(;h.length<=d;)h.push(null);return(h[d]=h[d]||[]).push(o),u}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var Fs=globalThis;function Le(n){for(let e in n)if(n[e]===Le)return e;throw Error("Could not find renamed property on target object.")}function Gj(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function hn(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(hn).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function zS(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var zj=Le({__forward_ref__:Le});function wa(n){return n.__forward_ref__=wa,n.toString=function(){return hn(this())},n}function Jt(n){return MR(n)?n():n}function MR(n){return typeof n=="function"&&n.hasOwnProperty(zj)&&n.__forward_ref__===wa}function Y(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Ht(n){return{providers:n.providers||[],imports:n.imports||[]}}function $f(n){return WS(n,PR)||WS(n,kR)}function NR(n){return $f(n)!==null}function WS(n,e){return n.hasOwnProperty(e)?n[e]:null}function Wj(n){let e=n&&(n[PR]||n[kR]);return e||null}function KS(n){return n&&(n.hasOwnProperty(QS)||n.hasOwnProperty(Kj))?n[QS]:null}var PR=Le({\u0275prov:Le}),QS=Le({\u0275inj:Le}),kR=Le({ngInjectableDef:Le}),Kj=Le({ngInjectorDef:Le}),H=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=Y({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function OR(n){return n&&!!n.\u0275providers}var Qj=Le({\u0275cmp:Le}),Yj=Le({\u0275dir:Le}),Zj=Le({\u0275pipe:Le}),Jj=Le({\u0275mod:Le}),_f=Le({\u0275fac:Le}),bc=Le({__NG_ELEMENT_ID__:Le}),YS=Le({__NG_ENV_ID__:Le});function qf(n){return typeof n=="string"?n:n==null?"":String(n)}function Xj(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():qf(n)}function e2(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new ee(-200,n)}function Hv(n,e){throw new ee(-201,!1)}var me=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(me||{}),X_;function FR(){return X_}function Ln(n){let e=X_;return X_=n,e}function VR(n,e,t){let r=$f(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&me.Optional)return null;if(e!==void 0)return e;Hv(n,"Injector")}var t2={},Ac=t2,ev="__NG_DI_FLAG__",vf="ngTempTokenPath",n2="ngTokenPath",r2=/\n/gm,i2="\u0275",ZS="__source",ca;function s2(){return ca}function Ri(n){let e=ca;return ca=n,e}function o2(n,e=me.Default){if(ca===void 0)throw new ee(-203,!1);return ca===null?VR(n,void 0,e):ca.get(n,e&me.Optional?null:void 0,e)}function V(n,e=me.Default){return(FR()||o2)(Jt(n),e)}function j(n,e=me.Default){return V(n,Hf(e))}function Hf(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function tv(n){let e=[];for(let t=0;t<n.length;t++){let r=Jt(n[t]);if(Array.isArray(r)){if(r.length===0)throw new ee(900,!1);let i,s=me.Default;for(let o=0;o<r.length;o++){let a=r[o],u=a2(a);typeof u=="number"?u===-1?i=a.token:s|=u:i=a}e.push(V(i,s))}else e.push(V(r))}return e}function LR(n,e){return n[ev]=e,n.prototype[ev]=e,n}function a2(n){return n[ev]}function u2(n,e,t,r){let i=n[vf];throw e[ZS]&&i.unshift(e[ZS]),n.message=c2(`
`+n.message,i,t,r),n[n2]=i,n[vf]=null,n}function c2(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==i2?n.slice(2):n;let i=hn(e);if(Array.isArray(e))i=e.map(hn).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):hn(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(r2,`
  `)}`}var tt=LR(xR("Optional"),8);var jR=LR(xR("SkipSelf"),4);function da(n,e){let t=n.hasOwnProperty(_f);return t?n[_f]:null}function Gv(n,e){n.forEach(t=>Array.isArray(t)?Gv(t,e):e(t))}function UR(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function wf(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function l2(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let s=i-2;n[i]=n[s],i--}n[e]=t,n[e+1]=r}}function d2(n,e,t){let r=$c(n,e);return r>=0?n[r|1]=t:(r=~r,l2(n,r,e,t)),r}function O_(n,e){let t=$c(n,e);if(t>=0)return n[t|1]}function $c(n,e){return h2(n,e,1)}function h2(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let s=r+(i-r>>1),o=n[s<<t];if(e===o)return s<<t;o>e?i=s:r=s+1}return~(i<<t)}var ha={},wn=[],Ls=new H(""),BR=new H("",-1),$R=new H(""),Ef=class{get(e,t=Ac){if(t===Ac){let r=new Error(`NullInjectorError: No provider for ${hn(e)}!`);throw r.name="NullInjectorError",r}return t}},qR=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(qR||{}),wr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(wr||{}),$t=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}($t||{});function f2(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}function nv(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{let s=i,o=t[++r];p2(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function HR(n){return n===3||n===4||n===6}function p2(n){return n.charCodeAt(0)===64}function Sc(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?JS(n,t,i,null,e[++r]):JS(n,t,i,null,null))}}return n}function JS(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[s+1]=i);return}else if(r===n[s+1]){n[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),r!==null&&n.splice(s++,0,r),i!==null&&n.splice(s++,0,i)}var GR="ng-template";function g2(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&f2(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(zv(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function zv(n){return n.type===4&&n.value!==GR}function m2(n,e,t){let r=n.type===4&&!t?GR:n.value;return e===r}function y2(n,e,t){let r=4,i=n.attrs,s=i!==null?w2(i):0,o=!1;for(let a=0;a<e.length;a++){let u=e[a];if(typeof u=="number"){if(!o&&!Xn(r)&&!Xn(u))return!1;if(o&&Xn(u))continue;o=!1,r=u|r&1;continue}if(!o)if(r&4){if(r=2|r&1,u!==""&&!m2(n,u,t)||u===""&&e.length===1){if(Xn(r))return!1;o=!0}}else if(r&8){if(i===null||!g2(n,i,u,t)){if(Xn(r))return!1;o=!0}}else{let l=e[++a],d=_2(u,i,zv(n),t);if(d===-1){if(Xn(r))return!1;o=!0;continue}if(l!==""){let h;if(d>s?h="":h=i[d+1].toLowerCase(),r&2&&l!==h){if(Xn(r))return!1;o=!0}}}}return Xn(r)||o}function Xn(n){return(n&1)===0}function _2(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return E2(e,n)}function v2(n,e,t=!1){for(let r=0;r<e.length;r++)if(y2(n,e[r],t))return!0;return!1}function w2(n){for(let e=0;e<n.length;e++){let t=n[e];if(HR(t))return e}return n.length}function E2(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function XS(n,e){return n?":not("+e.trim()+")":e}function I2(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Xn(o)&&(e+=XS(s,i),i=""),r=o,s=s||!Xn(r);t++}return i!==""&&(e+=XS(s,i)),e}function C2(n){return n.map(I2).join(",")}function D2(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!Xn(i))break;i=s}r++}return{attrs:e,classes:t}}function Un(n){return Bc(()=>{let e=YR(n),t=xe(G({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===qR.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||wr.Emulated,styles:n.styles||wn,_:null,schemas:n.schemas||null,tView:null,id:""});ZR(t);let r=n.dependencies;return t.directiveDefs=tR(r,!1),t.pipeDefs=tR(r,!0),t.id=A2(t),t})}function T2(n){return Mi(n)||zR(n)}function b2(n){return n!==null}function Gt(n){return Bc(()=>({type:n.type,bootstrap:n.bootstrap||wn,declarations:n.declarations||wn,imports:n.imports||wn,exports:n.exports||wn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function eR(n,e){if(n==null)return ha;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,a=$t.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(t[s]=a!==$t.None?[r,a]:r,e[s]=o):t[s]=r}return t}function Cn(n){return Bc(()=>{let e=YR(n);return ZR(e),e})}function Mi(n){return n[Qj]||null}function zR(n){return n[Yj]||null}function WR(n){return n[Zj]||null}function KR(n){let e=Mi(n)||zR(n)||WR(n);return e!==null?e.standalone:!1}function QR(n,e){let t=n[Jj]||null;if(!t&&e===!0)throw new Error(`Type ${hn(n)} does not have '\u0275mod' property.`);return t}function YR(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||ha,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||wn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:eR(n.inputs,e),outputs:eR(n.outputs),debugInfo:null}}function ZR(n){n.features?.forEach(e=>e(n))}function tR(n,e){if(!n)return null;let t=e?WR:T2;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(b2)}function A2(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function Xt(n){return{\u0275providers:n}}function Wv(...n){return{\u0275providers:JR(!0,n),\u0275fromNgModule:!0}}function JR(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return Gv(e,o=>{let a=o;rv(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&XR(i,s),t}function XR(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];Kv(i,s=>{e(s,r)})}}function rv(n,e,t,r){if(n=Jt(n),!n)return!1;let i=null,s=KS(n),o=!s&&Mi(n);if(!s&&!o){let u=n.ngModule;if(s=KS(u),s)i=u;else return!1}else{if(o&&!o.standalone)return!1;i=n}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let u=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of u)rv(l,e,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{Gv(s.imports,d=>{rv(d,e,t,r)&&(l||=[],l.push(d))})}finally{}l!==void 0&&XR(l,e)}if(!a){let l=da(i)||(()=>new i);e({provide:i,useFactory:l,deps:wn},i),e({provide:$R,useValue:i,multi:!0},i),e({provide:Ls,useValue:()=>V(i),multi:!0},i)}let u=s.providers;if(u!=null&&!a){let l=n;Kv(u,d=>{e(d,l)})}}else return!1;return i!==n&&n.providers!==void 0}function Kv(n,e){for(let t of n)OR(t)&&(t=t.\u0275providers),Array.isArray(t)?Kv(t,e):e(t)}var S2=Le({provide:String,useValue:Le});function ex(n){return n!==null&&typeof n=="object"&&S2 in n}function R2(n){return!!(n&&n.useExisting)}function x2(n){return!!(n&&n.useFactory)}function fa(n){return typeof n=="function"}function M2(n){return!!n.useClass}var Gf=new H(""),ff={},N2={},F_;function Qv(){return F_===void 0&&(F_=new Ef),F_}var fn=class{},Rc=class extends fn{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,sv(e,o=>this.processProvider(o)),this.records.set(BR,sa(void 0,this)),i.has("environment")&&this.records.set(fn,sa(void 0,this));let s=this.records.get(Gf);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get($R,wn,me.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=Ie(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ie(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=Ri(this),r=Ln(void 0),i;try{return e()}finally{Ri(t),Ln(r)}}get(e,t=Ac,r=me.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(YS))return e[YS](this);r=Hf(r);let i,s=Ri(this),o=Ln(void 0);try{if(!(r&me.SkipSelf)){let u=this.records.get(e);if(u===void 0){let l=V2(e)&&$f(e);l&&this.injectableDefInScope(l)?u=sa(iv(e),ff):u=null,this.records.set(e,u)}if(u!=null)return this.hydrate(e,u)}let a=r&me.Self?Qv():this.parent;return t=r&me.Optional&&t===Ac?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[vf]=a[vf]||[]).unshift(hn(e)),s)throw a;return u2(a,e,"R3InjectorError",this.source)}else throw a}finally{Ln(o),Ri(s)}}resolveInjectorInitializers(){let e=Ie(null),t=Ri(this),r=Ln(void 0),i;try{let s=this.get(Ls,wn,me.Self);for(let o of s)o()}finally{Ri(t),Ln(r),Ie(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(hn(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ee(205,!1)}processProvider(e){e=Jt(e);let t=fa(e)?e:Jt(e&&e.provide),r=k2(e);if(!fa(e)&&e.multi===!0){let i=this.records.get(t);i||(i=sa(void 0,ff,!0),i.factory=()=>tv(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=Ie(null);try{return t.value===ff&&(t.value=N2,t.value=t.factory()),typeof t.value=="object"&&t.value&&F2(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Ie(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Jt(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function iv(n){let e=$f(n),t=e!==null?e.factory:da(n);if(t!==null)return t;if(n instanceof H)throw new ee(204,!1);if(n instanceof Function)return P2(n);throw new ee(204,!1)}function P2(n){if(n.length>0)throw new ee(204,!1);let t=Wj(n);return t!==null?()=>t.factory(n):()=>new n}function k2(n){if(ex(n))return sa(void 0,n.useValue);{let e=tx(n);return sa(e,ff)}}function tx(n,e,t){let r;if(fa(n)){let i=Jt(n);return da(i)||iv(i)}else if(ex(n))r=()=>Jt(n.useValue);else if(x2(n))r=()=>n.useFactory(...tv(n.deps||[]));else if(R2(n))r=()=>V(Jt(n.useExisting));else{let i=Jt(n&&(n.useClass||n.provide));if(O2(n))r=()=>new i(...tv(n.deps));else return da(i)||iv(i)}return r}function sa(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function O2(n){return!!n.deps}function F2(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function V2(n){return typeof n=="function"||typeof n=="object"&&n instanceof H}function sv(n,e){for(let t of n)Array.isArray(t)?sv(t,e):t&&OR(t)?sv(t.\u0275providers,e):e(t)}function Ir(n,e){n instanceof Rc&&n.assertNotDestroyed();let t,r=Ri(n),i=Ln(void 0);try{return e()}finally{Ri(r),Ln(i)}}function nx(){return FR()!==void 0||s2()!=null}function L2(n){if(!nx())throw new ee(-203,!1)}function j2(n){return typeof n=="function"}var En=0,he=1,re=2,Nt=3,er=4,rr=5,jn=6,xc=7,Ut=8,pa=9,tr=10,Qe=11,Mc=12,nR=13,Ea=14,In=15,zf=16,oa=17,ga=18,Wf=19,rx=20,xi=21,V_=22,js=23,qt=25,ix=1,Nc=6,Jr=7,If=8,Cf=9,Bt=10,Yv=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(Yv||{});function Zr(n){return Array.isArray(n)&&typeof n[ix]=="object"}function Cr(n){return Array.isArray(n)&&n[ix]===!0}function sx(n){return(n.flags&4)!==0}function qc(n){return n.componentOffset>-1}function Zv(n){return(n.flags&1)===1}function Ni(n){return!!n.template}function ox(n){return(n[re]&512)!==0}var ov=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function ax(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function Oi(){return ux}function ux(n){return n.type.prototype.ngOnChanges&&(n.setInput=B2),U2}Oi.ngInherit=!0;function U2(){let n=lx(this),e=n?.current;if(e){let t=n.previous;if(t===ha)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function B2(n,e,t,r,i){let s=this.declaredInputs[r],o=lx(n)||$2(n,{previous:ha,current:null}),a=o.current||(o.current={}),u=o.previous,l=u[s];a[s]=new ov(l&&l.currentValue,t,u===ha),ax(n,e,i,t)}var cx="__ngSimpleChanges__";function lx(n){return n[cx]||null}function $2(n,e){return n[cx]=e}var rR=null;var _r=function(n,e,t){rR?.(n,e,t)},q2="svg",H2="math",G2=!1;function z2(){return G2}function nr(n){for(;Array.isArray(n);)n=n[En];return n}function dx(n,e){return nr(e[n])}function Dn(n,e){return nr(e[n.index])}function Jv(n,e){return n.data[e]}function Fi(n,e){let t=e[n];return Zr(t)?t:t[En]}function Xv(n){return(n[re]&128)===128}function W2(n){return Cr(n[Nt])}function Df(n,e){return e==null?null:n[e]}function hx(n){n[oa]=0}function K2(n){n[re]&1024||(n[re]|=1024,Xv(n)&&Pc(n))}function Q2(n,e){for(;n>0;)e=e[Ea],n--;return e}function ew(n){return!!(n[re]&9216||n[js]?.dirty)}function av(n){n[tr].changeDetectionScheduler?.notify(1),ew(n)?Pc(n):n[re]&64&&(z2()?(n[re]|=1024,Pc(n)):n[tr].changeDetectionScheduler?.notify())}function Pc(n){n[tr].changeDetectionScheduler?.notify();let e=kc(n);for(;e!==null&&!(e[re]&8192||(e[re]|=8192,!Xv(e)));)e=kc(e)}function fx(n,e){if((n[re]&256)===256)throw new ee(911,!1);n[xi]===null&&(n[xi]=[]),n[xi].push(e)}function Y2(n,e){if(n[xi]===null)return;let t=n[xi].indexOf(e);t!==-1&&n[xi].splice(t,1)}function kc(n){let e=n[Nt];return Cr(e)?e[Nt]:e}var ve={lFrame:wx(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Z2(){return ve.lFrame.elementDepthCount}function J2(){ve.lFrame.elementDepthCount++}function X2(){ve.lFrame.elementDepthCount--}function px(){return ve.bindingsEnabled}function Hc(){return ve.skipHydrationRootTNode!==null}function eU(n){return ve.skipHydrationRootTNode===n}function tU(n){ve.skipHydrationRootTNode=n}function nU(){ve.skipHydrationRootTNode=null}function Ge(){return ve.lFrame.lView}function ir(){return ve.lFrame.tView}function tw(n){return ve.lFrame.contextLView=n,n[Ut]}function nw(n){return ve.lFrame.contextLView=null,n}function Bn(){let n=gx();for(;n!==null&&n.type===64;)n=n.parent;return n}function gx(){return ve.lFrame.currentTNode}function rU(){let n=ve.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Gc(n,e){let t=ve.lFrame;t.currentTNode=n,t.isParent=e}function mx(){return ve.lFrame.isParent}function iU(){ve.lFrame.isParent=!1}function sU(n){return ve.lFrame.bindingIndex=n}function zc(){return ve.lFrame.bindingIndex++}function oU(n){let e=ve.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function aU(){return ve.lFrame.inI18n}function uU(n,e){let t=ve.lFrame;t.bindingIndex=t.bindingRootIndex=n,uv(e)}function cU(){return ve.lFrame.currentDirectiveIndex}function uv(n){ve.lFrame.currentDirectiveIndex=n}function lU(n){let e=ve.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function yx(n){ve.lFrame.currentQueryIndex=n}function dU(n){let e=n[he];return e.type===2?e.declTNode:e.type===1?n[rr]:null}function _x(n,e,t){if(t&me.SkipSelf){let i=e,s=n;for(;i=i.parent,i===null&&!(t&me.Host);)if(i=dU(s),i===null||(s=s[Ea],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=ve.lFrame=vx();return r.currentTNode=e,r.lView=n,!0}function rw(n){let e=vx(),t=n[he];ve.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function vx(){let n=ve.lFrame,e=n===null?null:n.child;return e===null?wx(n):e}function wx(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function Ex(){let n=ve.lFrame;return ve.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var Ix=Ex;function iw(){let n=Ex();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function hU(n){return(ve.lFrame.contextLView=Q2(n,ve.lFrame.contextLView))[Ut]}function Hs(){return ve.lFrame.selectedIndex}function Us(n){ve.lFrame.selectedIndex=n}function Cx(){let n=ve.lFrame;return Jv(n.tView,n.selectedIndex)}function Dx(){return ve.lFrame.currentNamespace}var Tx=!0;function sw(){return Tx}function Dr(n){Tx=n}function fU(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=ux(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function ow(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:l,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),u&&(n.viewHooks??=[]).push(-t,u),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function pf(n,e,t){bx(n,e,3,t)}function gf(n,e,t,r){(n[re]&3)===t&&bx(n,e,t,r)}function L_(n,e){let t=n[re];(t&3)===e&&(t&=16383,t+=1,n[re]=t)}function bx(n,e,t,r){let i=r!==void 0?n[oa]&65535:0,s=r??-1,o=e.length-1,a=0;for(let u=i;u<o;u++)if(typeof e[u+1]=="number"){if(a=e[u],r!=null&&a>=r)break}else e[u]<0&&(n[oa]+=65536),(a<s||s==-1)&&(pU(n,t,e,u),n[oa]=(n[oa]&4294901760)+u+2),u++}function iR(n,e){_r(4,n,e);let t=Ie(null);try{e.call(n)}finally{Ie(t),_r(5,n,e)}}function pU(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=n[o];i?n[re]>>14<n[oa]>>16&&(n[re]&3)===e&&(n[re]+=16384,iR(a,s)):iR(a,s)}var la=-1,Bs=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function gU(n){return n instanceof Bs}function mU(n){return(n.flags&8)!==0}function yU(n){return(n.flags&16)!==0}function Ax(n){return n!==la}function Tf(n){return n&32767}function _U(n){return n>>16}function bf(n,e){let t=_U(n),r=e;for(;t>0;)r=r[Ea],t--;return r}var cv=!0;function sR(n){let e=cv;return cv=n,e}var vU=256,Sx=vU-1,Rx=5,wU=0,vr={};function EU(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(bc)&&(r=t[bc]),r==null&&(r=t[bc]=wU++);let i=r&Sx,s=1<<i;e.data[n+(i>>Rx)]|=s}function Af(n,e){let t=xx(n,e);if(t!==-1)return t;let r=e[he];r.firstCreatePass&&(n.injectorIndex=e.length,j_(r.data,n),j_(e,null),j_(r.blueprint,null));let i=aw(n,e),s=n.injectorIndex;if(Ax(i)){let o=Tf(i),a=bf(i,e),u=a[he].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|u[o+l]}return e[s+8]=i,s}function j_(n,e){n.push(0,0,0,0,0,0,0,0,e)}function xx(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function aw(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=Ox(i),r===null)return la;if(t++,i=i[Ea],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return la}function lv(n,e,t){EU(n,e,t)}function IU(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let r=t.length,i=0;for(;i<r;){let s=t[i];if(HR(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof t[i]=="string";)i++;else{if(s===e)return t[i+1];i=i+2}}}return null}function Mx(n,e,t){if(t&me.Optional||n!==void 0)return n;Hv(e,"NodeInjector")}function Nx(n,e,t,r){if(t&me.Optional&&r===void 0&&(r=null),!(t&(me.Self|me.Host))){let i=n[pa],s=Ln(void 0);try{return i?i.get(e,r,t&me.Optional):VR(e,r,t&me.Optional)}finally{Ln(s)}}return Mx(r,e,t)}function Px(n,e,t,r=me.Default,i){if(n!==null){if(e[re]&2048&&!(r&me.Self)){let o=AU(n,e,t,r,vr);if(o!==vr)return o}let s=kx(n,e,t,r,vr);if(s!==vr)return s}return Nx(e,t,r,i)}function kx(n,e,t,r,i){let s=TU(t);if(typeof s=="function"){if(!_x(e,n,r))return r&me.Host?Mx(i,t,r):Nx(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&me.Optional))Hv(t);else return o}finally{Ix()}}else if(typeof s=="number"){let o=null,a=xx(n,e),u=la,l=r&me.Host?e[In][rr]:null;for((a===-1||r&me.SkipSelf)&&(u=a===-1?aw(n,e):e[a+8],u===la||!aR(r,!1)?a=-1:(o=e[he],a=Tf(u),e=bf(u,e)));a!==-1;){let d=e[he];if(oR(s,a,d.data)){let h=CU(a,e,t,o,r,l);if(h!==vr)return h}u=e[a+8],u!==la&&aR(r,e[he].data[a+8]===l)&&oR(s,a,e)?(o=d,a=Tf(u),e=bf(u,e)):a=-1}}return i}function CU(n,e,t,r,i,s){let o=e[he],a=o.data[n+8],u=r==null?qc(a)&&cv:r!=o&&(a.type&3)!==0,l=i&me.Host&&s===a,d=DU(a,o,t,u,l);return d!==null?ma(e,o,d,a):vr}function DU(n,e,t,r,i){let s=n.providerIndexes,o=e.data,a=s&1048575,u=n.directiveStart,l=n.directiveEnd,d=s>>20,h=r?a:a+d,g=i?a+d:l;for(let y=h;y<g;y++){let v=o[y];if(y<u&&t===v||y>=u&&v.type===t)return y}if(i){let y=o[u];if(y&&Ni(y)&&y.type===t)return u}return null}function ma(n,e,t,r){let i=n[t],s=e.data;if(gU(i)){let o=i;o.resolving&&e2(Xj(s[t]));let a=sR(o.canSeeViewProviders);o.resolving=!0;let u,l=o.injectImpl?Ln(o.injectImpl):null,d=_x(n,r,me.Default);try{i=n[t]=o.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&fU(t,s[t],e)}finally{l!==null&&Ln(l),sR(a),o.resolving=!1,Ix()}}return i}function TU(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(bc)?n[bc]:void 0;return typeof e=="number"?e>=0?e&Sx:bU:e}function oR(n,e,t){let r=1<<n;return!!(t[e+(n>>Rx)]&r)}function aR(n,e){return!(n&me.Self)&&!(n&me.Host&&e)}var Vs=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return Px(this._tNode,this._lView,e,Hf(r),t)}};function bU(){return new Vs(Bn(),Ge())}function Wc(n){return Bc(()=>{let e=n.prototype.constructor,t=e[_f]||dv(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[_f]||dv(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function dv(n){return MR(n)?()=>{let e=dv(Jt(n));return e&&e()}:da(n)}function AU(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[re]&2048&&!(o[re]&512);){let a=kx(s,o,t,r|me.Self,vr);if(a!==vr)return a;let u=s.parent;if(!u){let l=o[rx];if(l){let d=l.get(t,vr,r);if(d!==vr)return d}u=Ox(o),o=o[Ea]}s=u}return i}function Ox(n){let e=n[he],t=e.type;return t===2?e.declTNode:t===1?n[rr]:null}function uw(n){return IU(Bn(),n)}function uR(n,e=null,t=null,r){let i=Fx(n,e,t,r);return i.resolveInjectorInitializers(),i}function Fx(n,e=null,t=null,r,i=new Set){let s=[t||wn,Wv(n)];return r=r||(typeof n=="object"?void 0:hn(n)),new Rc(s,e||Qv(),r||null,i)}var Dt=(()=>{class n{static{this.THROW_IF_NOT_FOUND=Ac}static{this.NULL=new Ef}static create(t,r){if(Array.isArray(t))return uR({name:""},r,t,"");{let i=t.name??"";return uR({name:i},t.parent,t.providers,i)}}static{this.\u0275prov=Y({token:n,providedIn:"any",factory:()=>V(BR)})}static{this.__NG_ELEMENT_ID__=-1}}return n})();var SU="ngOriginalError";function U_(n){return n[SU]}var Er=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&U_(e);for(;t&&U_(t);)t=U_(t);return t||null}},Vx=new H("",{providedIn:"root",factory:()=>j(Er).handleError.bind(void 0)}),cw=(()=>{class n{static{this.__NG_ELEMENT_ID__=RU}static{this.__NG_ENV_ID__=t=>t}}return n})(),hv=class extends cw{constructor(e){super(),this._lView=e}onDestroy(e){return fx(this._lView,e),()=>Y2(this._lView,e)}};function RU(){return new hv(Ge())}function xU(){return lw(Bn(),Ge())}function lw(n,e){return new Vi(Dn(n,e))}var Vi=(()=>{class n{constructor(t){this.nativeElement=t}static{this.__NG_ELEMENT_ID__=xU}}return n})();var fv=class extends et{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,nx()&&(this.destroyRef=j(cw,{optional:!0})??void 0)}emit(e){let t=Ie(null);try{super.next(e)}finally{Ie(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=B_(s),i&&(i=B_(i)),o&&(o=B_(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof st&&e.add(a),a}};function B_(n){return e=>{setTimeout(n,void 0,e)}}var jt=fv;var MU="ngSkipHydration",NU="ngskiphydration";function Lx(n){let e=n.mergedAttrs;if(e===null)return!1;for(let t=0;t<e.length;t+=2){let r=e[t];if(typeof r=="number")return!1;if(typeof r=="string"&&r.toLowerCase()===NU)return!0}return!1}function jx(n){return n.hasAttribute(MU)}function Sf(n){return(n.flags&128)===128}function PU(n){if(Sf(n))return!0;let e=n.parent;for(;e;){if(Sf(n)||Lx(e))return!0;e=e.parent}return!1}var Ux=new Map,kU=0;function OU(){return kU++}function FU(n){Ux.set(n[Wf],n)}function VU(n){Ux.delete(n[Wf])}var cR="__ngContext__";function $s(n,e){Zr(e)?(n[cR]=e[Wf],FU(e)):n[cR]=e}function Bx(n){return qx(n[Mc])}function $x(n){return qx(n[er])}function qx(n){for(;n!==null&&!Cr(n);)n=n[er];return n}var pv;function Hx(n){pv=n}function Kf(){if(pv!==void 0)return pv;if(typeof document<"u")return document;throw new ee(210,!1)}var Qf=new H("",{providedIn:"root",factory:()=>LU}),LU="ng",dw=new H(""),at=new H("",{providedIn:"platform",factory:()=>"unknown"});var hw=new H("",{providedIn:"root",factory:()=>Kf().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function jU(){let n=new Gs;return j(at)==="browser"&&(n.store=UU(Kf(),j(Qf))),n}var Gs=(()=>{class n{constructor(){this.store={},this.onSerializeCallbacks={}}static{this.\u0275prov=Y({token:n,providedIn:"root",factory:jU})}get(t,r){return this.store[t]!==void 0?this.store[t]:r}set(t,r){this.store[t]=r}remove(t){delete this.store[t]}hasKey(t){return this.store.hasOwnProperty(t)}get isEmpty(){return Object.keys(this.store).length===0}onSerialize(t,r){this.onSerializeCallbacks[t]=r}toJson(){for(let t in this.onSerializeCallbacks)if(this.onSerializeCallbacks.hasOwnProperty(t))try{this.store[t]=this.onSerializeCallbacks[t]()}catch(r){console.warn("Exception in onSerialize callback: ",r)}return JSON.stringify(this.store).replace(/</g,"\\u003C")}}return n})();function UU(n,e){let t=n.getElementById(e+"-state");if(t?.textContent)try{return JSON.parse(t.textContent)}catch(r){console.warn("Exception while restoring TransferState for app "+e,r)}return{}}var Gx="h",zx="b",gv=function(n){return n.FirstChild="f",n.NextSibling="n",n}(gv||{}),BU="e",$U="t",fw="c",Wx="x",Rf="r",qU="i",HU="n",GU="d",zU="__nghData__",Kx=zU,$_="ngh",WU="nghm",Qx=()=>null;function KU(n,e,t=!1){let r=n.getAttribute($_);if(r==null)return null;let[i,s]=r.split("|");if(r=t?s:i,!r)return null;let o=s?`|${s}`:"",a=t?i:o,u={};if(r!==""){let d=e.get(Gs,null,{optional:!0});d!==null&&(u=d.get(Kx,[])[Number(r)])}let l={data:u,firstChild:n.firstChild??null};return t&&(l.firstChild=n,Yf(l,0,n.nextSibling)),a?n.setAttribute($_,a):n.removeAttribute($_),l}function QU(){Qx=KU}function pw(n,e,t=!1){return Qx(n,e,t)}function YU(n){let e=n._lView;return e[he].type===2?null:(ox(e)&&(e=e[qt]),e)}function ZU(n){return n.textContent?.replace(/\s/gm,"")}function JU(n){let e=Kf(),t=e.createNodeIterator(n,NodeFilter.SHOW_COMMENT,{acceptNode(s){let o=ZU(s);return o==="ngetn"||o==="ngtns"?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),r,i=[];for(;r=t.nextNode();)i.push(r);for(let s of i)s.textContent==="ngetn"?s.replaceWith(e.createTextNode("")):s.remove()}function Yf(n,e,t){n.segmentHeads??={},n.segmentHeads[e]=t}function mv(n,e){return n.segmentHeads?.[e]??null}function XU(n,e){let t=n.data,r=t[BU]?.[e]??null;return r===null&&t[fw]?.[e]&&(r=gw(n,e)),r}function Yx(n,e){return n.data[fw]?.[e]??null}function gw(n,e){let t=Yx(n,e)??[],r=0;for(let i of t)r+=i[Rf]*(i[Wx]??1);return r}function Zf(n,e){if(typeof n.disconnectedNodes>"u"){let t=n.data[GU];n.disconnectedNodes=t?new Set(t):null}return!!n.disconnectedNodes?.has(e)}var uf=new H(""),Zx=!1,Jx=new H("",{providedIn:"root",factory:()=>Zx}),eB=new H("");var cf;function tB(){if(cf===void 0&&(cf=null,Fs.trustedTypes))try{cf=Fs.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return cf}function lR(n){return tB()?.createScriptURL(n)||n}var xf=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${RR})`}};function Kc(n){return n instanceof xf?n.changingThisBreaksApplicationSecurity:n}function mw(n,e){let t=nB(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${RR})`)}return t===e}function nB(n){return n instanceof xf&&n.getTypeName()||null}var rB=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Xx(n){return n=String(n),n.match(rB)?n:"unsafe:"+n}var Jf=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(Jf||{});function iB(n){let e=tM();return e?e.sanitize(Jf.URL,n)||"":mw(n,"URL")?Kc(n):Xx(qf(n))}function sB(n){let e=tM();if(e)return lR(e.sanitize(Jf.RESOURCE_URL,n)||"");if(mw(n,"ResourceURL"))return lR(Kc(n));throw new ee(904,!1)}function oB(n,e){return e==="src"&&(n==="embed"||n==="frame"||n==="iframe"||n==="media"||n==="script")||e==="href"&&(n==="base"||n==="link")?sB:iB}function eM(n,e,t){return oB(e,t)(n)}function tM(){let n=Ge();return n&&n[tr].sanitizer}var aB=/^>|^->|<!--|-->|--!>|<!-$/g,uB=/(<|>)/g,cB="\u200B$1\u200B";function lB(n){return n.replace(aB,e=>e.replace(uB,cB))}function dB(n){return n.ownerDocument.body}function nM(n){return n instanceof Function?n():n}function Tc(n){return(n??j(Dt)).get(at)==="browser"}var Xr=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Xr||{}),hB;function yw(n,e){return hB(n,e)}function aa(n,e,t,r,i){if(r!=null){let s,o=!1;Cr(r)?s=r:Zr(r)&&(o=!0,r=r[En]);let a=nr(r);n===0&&t!==null?i==null?sM(e,t,a):Mf(e,t,a,i||null,!0):n===1&&t!==null?Mf(e,t,a,i||null,!0):n===2?Iw(e,a,o):n===3&&e.destroyNode(a),s!=null&&RB(e,n,s,t,i)}}function _w(n,e){return n.createText(e)}function fB(n,e,t){n.setValue(e,t)}function vw(n,e){return n.createComment(lB(e))}function Xf(n,e,t){return n.createElement(e,t)}function pB(n,e){rM(n,e),e[En]=null,e[rr]=null}function gB(n,e,t,r,i,s){r[En]=i,r[rr]=e,tp(n,r,t,1,i,s)}function rM(n,e){e[tr].changeDetectionScheduler?.notify(1),tp(n,e,e[Qe],2,null,null)}function mB(n){let e=n[Mc];if(!e)return q_(n[he],n);for(;e;){let t=null;if(Zr(e))t=e[Mc];else{let r=e[Bt];r&&(t=r)}if(!t){for(;e&&!e[er]&&e!==n;)Zr(e)&&q_(e[he],e),e=e[Nt];e===null&&(e=n),Zr(e)&&q_(e[he],e),t=e&&e[er]}e=t}}function yB(n,e,t,r){let i=Bt+r,s=t.length;r>0&&(t[i-1][er]=e),r<s-Bt?(e[er]=t[i],UR(t,Bt+r,e)):(t.push(e),e[er]=null),e[Nt]=t;let o=e[zf];o!==null&&t!==o&&_B(o,e);let a=e[ga];a!==null&&a.insertView(n),av(e),e[re]|=128}function _B(n,e){let t=n[Cf],i=e[Nt][Nt][In];e[In]!==i&&(n[re]|=Yv.HasTransplantedViews),t===null?n[Cf]=[e]:t.push(e)}function iM(n,e){let t=n[Cf],r=t.indexOf(e);t.splice(r,1)}function Oc(n,e){if(n.length<=Bt)return;let t=Bt+e,r=n[t];if(r){let i=r[zf];i!==null&&i!==n&&iM(i,r),e>0&&(n[t-1][er]=r[er]);let s=wf(n,Bt+e);pB(r[he],r);let o=s[ga];o!==null&&o.detachView(s[he]),r[Nt]=null,r[er]=null,r[re]&=-129}return r}function ep(n,e){if(!(e[re]&256)){let t=e[Qe];t.destroyNode&&tp(n,e,t,3,null,null),mB(e)}}function q_(n,e){if(e[re]&256)return;let t=Ie(null);try{e[re]&=-129,e[re]|=256,e[js]&&DS(e[js]),wB(n,e),vB(n,e),e[he].type===1&&e[Qe].destroy();let r=e[zf];if(r!==null&&Cr(e[Nt])){r!==e[Nt]&&iM(r,e);let i=e[ga];i!==null&&i.detachView(n)}VU(e)}finally{Ie(t)}}function vB(n,e){let t=n.cleanup,r=e[xc];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[t[s+1]];t[s].call(o)}r!==null&&(e[xc]=null);let i=e[xi];if(i!==null){e[xi]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function wB(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof Bs)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],u=s[o+1];_r(4,a,u);try{u.call(a)}finally{_r(5,a,u)}}else{_r(4,i,s);try{s.call(i)}finally{_r(5,i,s)}}}}}function EB(n,e,t){return IB(n,e.parent,t)}function IB(n,e,t){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return t[En];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=n.data[r.directiveStart+i];if(s===wr.None||s===wr.Emulated)return null}return Dn(r,t)}}function Mf(n,e,t,r,i){n.insertBefore(e,t,r,i)}function sM(n,e,t){n.appendChild(e,t)}function dR(n,e,t,r,i){r!==null?Mf(n,e,t,r,i):sM(n,e,t)}function CB(n,e,t,r){n.removeChild(e,t,r)}function ww(n,e){return n.parentNode(e)}function DB(n,e){return n.nextSibling(e)}function TB(n,e,t){return AB(n,e,t)}function bB(n,e,t){return n.type&40?Dn(n,t):null}var AB=bB,hR;function Ew(n,e,t,r){let i=EB(n,r,e),s=e[Qe],o=r.parent||e[rr],a=TB(o,r,e);if(i!=null)if(Array.isArray(t))for(let u=0;u<t.length;u++)dR(s,i,t[u],a,!1);else dR(s,i,t,a,!1);hR!==void 0&&hR(s,r,e,t,i)}function mf(n,e){if(e!==null){let t=e.type;if(t&3)return Dn(e,n);if(t&4)return yv(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return mf(n,r);{let i=n[e.index];return Cr(i)?yv(-1,i):nr(i)}}else{if(t&32)return yw(e,n)()||nr(n[e.index]);{let r=oM(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=kc(n[In]);return mf(i,r)}else return mf(n,e.next)}}}return null}function oM(n,e){if(e!==null){let r=n[In][rr],i=e.projection;return r.projection[i]}return null}function yv(n,e){let t=Bt+n+1;if(t<e.length){let r=e[t],i=r[he].firstChild;if(i!==null)return mf(r,i)}return e[Jr]}function Iw(n,e,t){let r=ww(n,e);r&&CB(n,r,e,t)}function aM(n){n.textContent=""}function Cw(n,e,t,r,i,s,o){for(;t!=null;){let a=r[t.index],u=t.type;if(o&&e===0&&(a&&$s(nr(a),r),t.flags|=2),(t.flags&32)!==32)if(u&8)Cw(n,e,t.child,r,i,s,!1),aa(e,n,i,a,s);else if(u&32){let l=yw(t,r),d;for(;d=l();)aa(e,n,i,d,s);aa(e,n,i,a,s)}else u&16?SB(n,e,r,t,i,s):aa(e,n,i,a,s);t=o?t.projectionNext:t.next}}function tp(n,e,t,r,i,s){Cw(t,r,n.firstChild,e,i,s,!1)}function SB(n,e,t,r,i,s){let o=t[In],u=o[rr].projection[r.projection];if(Array.isArray(u))for(let l=0;l<u.length;l++){let d=u[l];aa(e,n,i,d,s)}else{let l=u,d=o[Nt];Sf(r)&&(l.flags|=128),Cw(n,e,l,d,i,s,!0)}}function RB(n,e,t,r,i){let s=t[Jr],o=nr(t);s!==o&&aa(e,n,r,s,i);for(let a=Bt;a<t.length;a++){let u=t[a];tp(u[he],u,n,e,r,s)}}function xB(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let s=r.indexOf("-")===-1?void 0:Xr.DashCase;i==null?n.removeStyle(t,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Xr.Important),n.setStyle(t,r,i,s))}}function MB(n,e,t){n.setAttribute(e,"style",t)}function uM(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function cM(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&nv(n,e,r),i!==null&&uM(n,e,i),s!==null&&MB(n,e,s)}var Ia={};function $n(n=1){lM(ir(),Ge(),Hs()+n,!1)}function lM(n,e,t,r){if(!r)if((e[re]&3)===3){let s=n.preOrderCheckHooks;s!==null&&pf(e,s,t)}else{let s=n.preOrderHooks;s!==null&&gf(e,s,0,t)}Us(t)}function De(n,e=me.Default){let t=Ge();if(t===null)return V(n,e);let r=Bn();return Px(r,t,Jt(n),e)}function dM(){let n="invalid";throw new Error(n)}function hM(n,e,t,r,i,s){let o=Ie(null);try{let a=null;i&$t.SignalBased&&(a=e[r][wS]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&$t.HasDecoratorInputTransform&&(s=n.inputTransforms[r].call(e,s)),n.setInput!==null?n.setInput(e,a,s,t,r):ax(e,a,r,s)}finally{Ie(o)}}function NB(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)Us(~i);else{let s=i,o=t[++r],a=t[++r];uU(o,s);let u=e[s];a(2,u)}}}finally{Us(-1)}}function np(n,e,t,r,i,s,o,a,u,l,d){let h=e.blueprint.slice();return h[En]=i,h[re]=r|4|128|8|64,(l!==null||n&&n[re]&2048)&&(h[re]|=2048),hx(h),h[Nt]=h[Ea]=n,h[Ut]=t,h[tr]=o||n&&n[tr],h[Qe]=a||n&&n[Qe],h[pa]=u||n&&n[pa]||null,h[rr]=s,h[Wf]=OU(),h[jn]=d,h[rx]=l,h[In]=e.type==2?n[In]:h,h}function rp(n,e,t,r,i){let s=n.data[e];if(s===null)s=PB(n,e,t,r,i),aU()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=rU();s.injectorIndex=o===null?-1:o.injectorIndex}return Gc(s,!0),s}function PB(n,e,t,r,i){let s=gx(),o=mx(),a=o?s:s&&s.parent,u=n.data[e]=jB(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=u),s!==null&&(o?s.child==null&&u.parent!==null&&(s.child=u):s.next===null&&(s.next=u,u.prev=s)),u}function fM(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function pM(n,e,t,r,i){let s=Hs(),o=r&2;try{Us(-1),o&&e.length>qt&&lM(n,e,qt,!1),_r(o?2:0,i),t(r,i)}finally{Us(s),_r(o?3:1,i)}}function gM(n,e,t){if(sx(e)){let r=Ie(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=n.data[o];if(a.contentQueries){let u=t[o];a.contentQueries(1,u,o)}}}finally{Ie(r)}}}function mM(n,e,t){px()&&(zB(n,e,t,Dn(t,e)),(t.flags&64)===64&&IM(n,e,t))}function yM(n,e,t=Dn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(e,n):n[o];n[i++]=a}}}function _M(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=Dw(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function Dw(n,e,t,r,i,s,o,a,u,l,d){let h=qt+r,g=h+i,y=kB(h,g),v=typeof l=="function"?l():l;return y[he]={type:n,blueprint:y,template:t,queries:null,viewQuery:a,declTNode:e,data:y.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:g,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:u,consts:v,incompleteFirstPass:!1,ssrId:d}}function kB(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:Ia);return t}function OB(n,e,t,r){let s=r.get(Jx,Zx)||t===wr.ShadowDom,o=n.selectRootElement(e,s);return FB(o),o}function FB(n){vM(n)}var vM=()=>null;function VB(n){jx(n)?aM(n):JU(n)}function LB(){vM=VB}function jB(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return Hc()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function fR(n,e,t,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,u=$t.None;Array.isArray(o)?(a=o[0],u=o[1]):a=o;let l=s;if(i!==null){if(!i.hasOwnProperty(s))continue;l=i[s]}n===0?pR(r,t,l,a,u):pR(r,t,l,a)}return r}function pR(n,e,t,r,i){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,r):s=n[t]=[e,r],i!==void 0&&s.push(i)}function UB(n,e,t){let r=e.directiveStart,i=e.directiveEnd,s=n.data,o=e.attrs,a=[],u=null,l=null;for(let d=r;d<i;d++){let h=s[d],g=t?t.get(h):null,y=g?g.inputs:null,v=g?g.outputs:null;u=fR(0,h.inputs,d,u,y),l=fR(1,h.outputs,d,l,v);let D=u!==null&&o!==null&&!zv(e)?r$(u,d,o):null;a.push(D)}u!==null&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=l}function BB(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function $B(n,e,t,r,i,s,o,a){let u=Dn(e,t),l=e.inputs,d;!a&&l!=null&&(d=l[r])?(Tw(n,t,d,r,i),qc(e)&&qB(t,e.index)):e.type&3?(r=BB(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(u,r,i)):e.type&12}function qB(n,e){let t=Fi(e,n);t[re]&16||(t[re]|=64)}function wM(n,e,t,r){if(px()){let i=r===null?null:{"":-1},s=KB(n,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&EM(n,e,t,o,i,a),i&&QB(t,r,i)}t.mergedAttrs=Sc(t.mergedAttrs,t.attrs)}function EM(n,e,t,r,i,s){for(let l=0;l<r.length;l++)lv(Af(t,e),n,r[l].type);ZB(t,n.data.length,r.length);for(let l=0;l<r.length;l++){let d=r[l];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,u=fM(n,e,r.length,null);for(let l=0;l<r.length;l++){let d=r[l];t.mergedAttrs=Sc(t.mergedAttrs,d.hostAttrs),JB(n,t,e,u,d),YB(u,d,i),d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let h=d.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),u++}UB(n,t,s)}function HB(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;GB(o)!=a&&o.push(a),o.push(t,r,s)}}function GB(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function zB(n,e,t,r){let i=t.directiveStart,s=t.directiveEnd;qc(t)&&XB(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||Af(t,e),$s(r,e);let o=t.initialInputs;for(let a=i;a<s;a++){let u=n.data[a],l=ma(e,n,a,t);if($s(l,e),o!==null&&n$(e,a-i,l,u,t,o),Ni(u)){let d=Fi(t.index,e);d[Ut]=ma(e,n,a,t)}}}function IM(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=cU();try{Us(s);for(let a=r;a<i;a++){let u=n.data[a],l=e[a];uv(a),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&WB(u,l)}}finally{Us(-1),uv(o)}}function WB(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function KB(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(v2(e,o.selectors,!1))if(r||(r=[]),Ni(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let u=a.length;_v(n,e,u)}else r.unshift(o),_v(n,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function _v(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function QB(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new ee(-301,!1);r.push(e[i],s)}}}function YB(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;Ni(e)&&(t[""]=n)}}function ZB(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function JB(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=da(i.type,!0)),o=new Bs(s,Ni(i),De);n.blueprint[r]=o,t[r]=o,HB(n,e,r,fM(n,t,i.hostVars,Ia),i)}function XB(n,e,t){let r=Dn(e,n),i=_M(t),s=n[tr].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=ip(n,np(n,i,null,o,r,e,null,s.createRenderer(r,t),null,null,null));n[e.index]=a}function e$(n,e,t,r,i,s){let o=Dn(n,e);t$(e[Qe],o,s,n.value,t,r,i)}function t$(n,e,t,r,i,s,o){if(s==null)n.removeAttribute(e,i,t);else{let a=o==null?qf(s):o(s,r||"",i);n.setAttribute(e,i,a,t)}}function n$(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let u=o[a++],l=o[a++],d=o[a++],h=o[a++];hM(r,t,u,l,d,h)}}function r$(n,e,t){let r=null,i=0;for(;i<t.length;){let s=t[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(n.hasOwnProperty(s)){r===null&&(r=[]);let o=n[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],t[i+1]);break}}i+=2}return r}function CM(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function DM(n,e){let t=n.contentQueries;if(t!==null){let r=Ie(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=n.data[o];yx(s),a.contentQueries(2,e[o],o)}}}finally{Ie(r)}}}function ip(n,e){return n[Mc]?n[nR][er]=e:n[Mc]=e,n[nR]=e,e}function vv(n,e,t){yx(0);let r=Ie(null);try{e(n,t)}finally{Ie(r)}}function i$(n){return n[xc]||(n[xc]=[])}function s$(n){return n.cleanup||(n.cleanup=[])}function TM(n,e){let t=n[pa],r=t?t.get(Er,null):null;r&&r.handleError(e)}function Tw(n,e,t,r,i){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],u=t[s++],l=e[o],d=n.data[o];hM(d,l,r,a,u,i)}}function o$(n,e,t){let r=dx(e,n);fB(n[Qe],r,t)}function a$(n,e){let t=Fi(e,n),r=t[he];u$(r,t);let i=t[En];i!==null&&t[jn]===null&&(t[jn]=pw(i,t[pa])),bw(r,t,t[Ut])}function u$(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function bw(n,e,t){rw(e);try{let r=n.viewQuery;r!==null&&vv(1,r,t);let i=n.template;i!==null&&pM(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[ga]?.finishViewCreation(n),n.staticContentQueries&&DM(n,e),n.staticViewQueries&&vv(2,n.viewQuery,t);let s=n.components;s!==null&&c$(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[re]&=-5,iw()}}function c$(n,e){for(let t=0;t<e.length;t++)a$(n,e[t])}function Aw(n,e,t,r){let i=Ie(null);try{let s=e.tView,a=n[re]&4096?4096:16,u=np(n,s,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];u[zf]=l;let d=n[ga];return d!==null&&(u[ga]=d.createEmbeddedView(s)),bw(s,u,t),u}finally{Ie(i)}}function bM(n,e){let t=Bt+e;if(t<n.length)return n[t]}function Fc(n,e){return!e||e.firstChild===null||Sf(n)}function sp(n,e,t,r=!0){let i=e[he];if(yB(i,e,n,t),r){let o=yv(t,n),a=e[Qe],u=ww(a,n[Jr]);u!==null&&gB(i,n[rr],a,e,u,o)}let s=e[jn];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function AM(n,e){let t=Oc(n,e);return t!==void 0&&ep(t[he],t),t}function Nf(n,e,t,r,i=!1){for(;t!==null;){let s=e[t.index];s!==null&&r.push(nr(s)),Cr(s)&&l$(s,r);let o=t.type;if(o&8)Nf(n,e,t.child,r);else if(o&32){let a=yw(t,e),u;for(;u=a();)r.push(u)}else if(o&16){let a=oM(e,t);if(Array.isArray(a))r.push(...a);else{let u=kc(e[In]);Nf(u[he],u,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function l$(n,e){for(let t=Bt;t<n.length;t++){let r=n[t],i=r[he].firstChild;i!==null&&Nf(r[he],r,i,e)}n[Jr]!==n[En]&&e.push(n[Jr])}var SM=[];function d$(n){return n[js]??h$(n)}function h$(n){let e=SM.pop()??Object.create(p$);return e.lView=n,e}function f$(n){n.lView[js]!==n&&(n.lView=null,SM.push(n))}var p$=xe(G({},ES),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Pc(n.lView)},consumerOnSignalRead(){this.lView[js]=this}}),RM=100;function xM(n,e=!0,t=0){let r=n[tr],i=r.rendererFactory,s=!1;s||i.begin?.();try{g$(n,t)}catch(o){throw e&&TM(n,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function g$(n,e){wv(n,e);let t=0;for(;ew(n);){if(t===RM)throw new ee(103,!1);t++,wv(n,1)}}function m$(n,e,t,r){let i=e[re];if((i&256)===256)return;let s=!1;!s&&e[tr].inlineEffectRunner?.flush(),rw(e);let o=null,a=null;!s&&y$(n)&&(a=d$(e),o=IS(a));try{hx(e),sU(n.bindingStartIndex),t!==null&&pM(n,e,t,2,r);let u=(i&3)===3;if(!s)if(u){let h=n.preOrderCheckHooks;h!==null&&pf(e,h,null)}else{let h=n.preOrderHooks;h!==null&&gf(e,h,0,null),L_(e,0)}if(_$(e),MM(e,0),n.contentQueries!==null&&DM(n,e),!s)if(u){let h=n.contentCheckHooks;h!==null&&pf(e,h)}else{let h=n.contentHooks;h!==null&&gf(e,h,1),L_(e,1)}NB(n,e);let l=n.components;l!==null&&PM(e,l,0);let d=n.viewQuery;if(d!==null&&vv(2,d,r),!s)if(u){let h=n.viewCheckHooks;h!==null&&pf(e,h)}else{let h=n.viewHooks;h!==null&&gf(e,h,2),L_(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[V_]){for(let h of e[V_])h();e[V_]=null}s||(e[re]&=-73)}catch(u){throw Pc(e),u}finally{a!==null&&(CS(a,o),f$(a)),iw()}}function y$(n){return n.type!==2}function MM(n,e){for(let t=Bx(n);t!==null;t=$x(t))for(let r=Bt;r<t.length;r++){let i=t[r];NM(i,e)}}function _$(n){for(let e=Bx(n);e!==null;e=$x(e)){if(!(e[re]&Yv.HasTransplantedViews))continue;let t=e[Cf];for(let r=0;r<t.length;r++){let i=t[r],s=i[Nt];K2(i)}}}function v$(n,e,t){let r=Fi(e,n);NM(r,t)}function NM(n,e){Xv(n)&&wv(n,e)}function wv(n,e){let r=n[he],i=n[re],s=n[js],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&f_(s)),s&&(s.dirty=!1),n[re]&=-9217,o)m$(r,n,r.template,n[Ut]);else if(i&8192){MM(n,1);let a=r.components;a!==null&&PM(n,a,1)}}function PM(n,e,t){for(let r=0;r<e.length;r++)v$(n,e[r],t)}function Sw(n){for(n[tr].changeDetectionScheduler?.notify();n;){n[re]|=64;let e=kc(n);if(ox(n)&&!e)return n;n=e}return null}var ya=class{get rootNodes(){let e=this._lView,t=e[he];return Nf(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Ut]}set context(e){this._lView[Ut]=e}get destroyed(){return(this._lView[re]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Nt];if(Cr(e)){let t=e[If],r=t?t.indexOf(this):-1;r>-1&&(Oc(e,r),wf(t,r))}this._attachedToViewContainer=!1}ep(this._lView[he],this._lView)}onDestroy(e){fx(this._lView,e)}markForCheck(){Sw(this._cdRefInjectingView||this._lView)}detach(){this._lView[re]&=-129}reattach(){av(this._lView),this._lView[re]|=128}detectChanges(){this._lView[re]|=1024,xM(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ee(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,rM(this._lView[he],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ee(902,!1);this._appRef=e,av(this._lView)}};function kM(n){let e=n[Nc]??[],r=n[Nt][Qe];for(let i of e)w$(i,r);n[Nc]=wn}function w$(n,e){let t=0,r=n.firstChild;if(r){let i=n.data[Rf];for(;t<i;){let s=r.nextSibling;Iw(e,r,!1),r=s,t++}}}function OM(n){kM(n);for(let e=Bt;e<n.length;e++)Pf(n[e])}function E$(n){let e=n[jn]?.i18nNodes;if(e){let t=n[Qe];for(let r of e.values())Iw(t,r,!1);n[jn].i18nNodes=void 0}}function Pf(n){E$(n);let e=n[he];for(let t=qt;t<e.bindingStartIndex;t++)if(Cr(n[t])){let r=n[t];OM(r)}else Zr(n[t])&&Pf(n[t])}function I$(n){let e=n._views;for(let t of e){let r=YU(t);if(r!==null&&r[En]!==null)if(Zr(r))Pf(r);else{let i=r[En];Pf(i),OM(r)}}}var C$=new RegExp(`^(\\d+)*(${zx}|${Gx})*(.*)`);function D$(n){let e=n.match(C$),[t,r,i,s]=e,o=r?parseInt(r,10):i,a=[];for(let[u,l,d]of s.matchAll(/(f|n)(\d*)/g)){let h=parseInt(d,10)||1;a.push(l,h)}return[o,...a]}function T$(n){return!n.prev&&n.parent?.type===8}function H_(n){return n.index-qt}function b$(n,e){let t=n.i18nNodes;if(t){let r=t.get(e);return r&&t.delete(e),r}return null}function op(n,e,t,r){let i=H_(r),s=b$(n,i);if(!s){let o=n.data[HU];if(o?.[i])s=S$(o[i],t);else if(e.firstChild===r)s=n.firstChild;else{let a=r.prev===null,u=r.prev??r.parent;if(T$(r)){let l=H_(r.parent);s=mv(n,l)}else{let l=Dn(u,t);if(a)s=l.firstChild;else{let d=H_(u),h=mv(n,d);if(u.type===2&&h){let y=gw(n,d)+1;s=ap(y,h)}else s=l.nextSibling}}}}return s}function ap(n,e){let t=e;for(let r=0;r<n;r++)t=t.nextSibling;return t}function A$(n,e){let t=n;for(let r=0;r<e.length;r+=2){let i=e[r],s=e[r+1];for(let o=0;o<s;o++)switch(i){case gv.FirstChild:t=t.firstChild;break;case gv.NextSibling:t=t.nextSibling;break}}return t}function S$(n,e){let[t,...r]=D$(n),i;if(t===Gx)i=e[In][En];else if(t===zx)i=dB(e[In][En]);else{let s=Number(t);i=nr(e[s+qt])}return A$(i,r)}function R$(n,e){let t=[];for(let r of e)for(let i=0;i<(r[Wx]??1);i++){let s={data:r,firstChild:null};r[Rf]>0&&(s.firstChild=n,n=ap(r[Rf],n)),t.push(s)}return[n,t]}var FM=()=>null;function x$(n,e){let t=n[Nc];return!e||t===null||t.length===0?null:t[0].data[qU]===e?t.shift():(kM(n),null)}function M$(){FM=x$}function Vc(n,e){return FM(n,e)}var kf=class{},Ev=class{},Of=class{};function N$(n){let e=Error(`No component factory found for ${hn(n)}.`);return e[P$]=n,e}var P$="ngComponent";var Iv=class{resolveComponentFactory(e){throw N$(e)}},up=(()=>{class n{static{this.NULL=new Iv}}return n})(),Lc=class{},zs=(()=>{class n{constructor(){this.destroyNode=null}static{this.__NG_ELEMENT_ID__=()=>k$()}}return n})();function k$(){let n=Ge(),e=Bn(),t=Fi(e.index,n);return(Zr(t)?t:n)[Qe]}var O$=(()=>{class n{static{this.\u0275prov=Y({token:n,providedIn:"root",factory:()=>null})}}return n})(),G_={};var gR=new Set;function Li(n){gR.has(n)||(gR.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function mR(...n){}function F$(){let n=typeof Fs.requestAnimationFrame=="function",e=Fs[n?"requestAnimationFrame":"setTimeout"],t=Fs[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}var le=class n{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new jt(!1),this.onMicrotaskEmpty=new jt(!1),this.onStable=new jt(!1),this.onError=new jt(!1),typeof Zone>"u")throw new ee(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&t,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=F$().nativeRequestAnimationFrame,j$(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new ee(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new ee(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,V$,mR,mR);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},V$={};function Rw(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function L$(n){n.isCheckStableRunning||n.lastRequestAnimationFrameId!==-1||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Fs,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Cv(n),n.isCheckStableRunning=!0,Rw(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Cv(n))}function j$(n){let e=()=>{L$(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,i,s,o,a)=>{if(U$(a))return t.invokeTask(i,s,o,a);try{return yR(n),t.invokeTask(i,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),_R(n)}},onInvoke:(t,r,i,s,o,a,u)=>{try{return yR(n),t.invoke(i,s,o,a,u)}finally{n.shouldCoalesceRunChangeDetection&&e(),_R(n)}},onHasTask:(t,r,i,s)=>{t.hasTask(i,s),r===i&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,Cv(n),Rw(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,r,i,s)=>(t.handleError(i,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function Cv(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.lastRequestAnimationFrameId!==-1?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function yR(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function _R(n){n._nesting--,Rw(n)}function U$(n){return!Array.isArray(n)||n.length!==1?!1:n[0].data?.__ignore_ng_zone__===!0}var ua=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(ua||{}),B$={destroy(){}};function cp(n,e){!e&&L2(cp);let t=e?.injector??j(Dt);if(!Tc(t))return B$;Li("NgAfterNextRender");let r=t.get(xw),i=r.handler??=new Tv,s=e?.phase??ua.MixedReadWrite,o=()=>{i.unregister(u),a()},a=t.get(cw).onDestroy(o),u=Ir(t,()=>new Dv(s,()=>{o(),n()}));return i.register(u),{destroy:o}}var Dv=class{constructor(e,t){this.phase=e,this.callbackFn=t,this.zone=j(le),this.errorHandler=j(Er,{optional:!0}),j(kf,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},Tv=class{constructor(){this.executingCallbacks=!1,this.buckets={[ua.EarlyRead]:new Set,[ua.Write]:new Set,[ua.MixedReadWrite]:new Set,[ua.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let t of e)t.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},xw=(()=>{class n{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let t=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let r of t)r()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static{this.\u0275prov=Y({token:n,providedIn:"root",factory:()=>new n})}}return n})();function bv(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=zS(i,a);else if(s==2){let u=a,l=e[++o];r=zS(r,u+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var Ff=class extends up{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=Mi(e);return new _a(t,this.ngModule)}};function vR(n){let e=[];for(let t in n){if(!n.hasOwnProperty(t))continue;let r=n[t];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:t})}return e}function $$(n){let e=n.toLowerCase();return e==="svg"?q2:e==="math"?H2:null}var Av=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=Hf(r);let i=this.injector.get(e,G_,r);return i!==G_||t===G_?i:this.parentInjector.get(e,t,r)}},_a=class extends Of{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=vR(e.inputs);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return vR(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=C2(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let s=Ie(null);try{i=i||this.ngModule;let o=i instanceof fn?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new Av(e,o):e,u=a.get(Lc,null);if(u===null)throw new ee(407,!1);let l=a.get(O$,null),d=a.get(xw,null),h=a.get(kf,null),g={rendererFactory:u,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:d,changeDetectionScheduler:h},y=u.createRenderer(null,this.componentDef),v=this.componentDef.selectors[0][0]||"div",D=r?OB(y,r,this.componentDef.encapsulation,a):Xf(y,v,$$(v)),A=512;this.componentDef.signals?A|=4096:this.componentDef.onPush||(A|=16);let P=null;D!==null&&(P=pw(D,a,!0));let B=Dw(0,null,null,1,0,null,null,null,null,null,null),F=np(null,B,null,A,null,null,g,y,a,null,P);rw(F);let K,te;try{let X=this.componentDef,I,_=null;X.findHostDirectiveDefs?(I=[],_=new Map,X.findHostDirectiveDefs(X,I,_),I.push(X)):I=[X];let E=q$(F,D),C=H$(E,D,X,I,F,g,y);te=Jv(B,qt),D&&W$(y,X,D,r),t!==void 0&&K$(te,this.ngContentSelectors,t),K=z$(C,X,I,_,F,[Q$]),bw(B,F,null)}finally{iw()}return new Sv(this.componentType,K,lw(te,F),F,te)}finally{Ie(s)}}},Sv=class extends Ev{constructor(e,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new ya(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;Tw(s[he],s,i,e,t),this.previousInputValues.set(e,t);let o=Fi(this._tNode.index,s);Sw(o)}}get injector(){return new Vs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function q$(n,e){let t=n[he],r=qt;return n[r]=e,rp(t,r,2,"#host",null)}function H$(n,e,t,r,i,s,o){let a=i[he];G$(r,n,e,o);let u=null;e!==null&&(u=pw(e,i[pa]));let l=s.rendererFactory.createRenderer(e,t),d=16;t.signals?d=4096:t.onPush&&(d=64);let h=np(i,_M(t),null,d,i[n.index],n,s,l,null,null,u);return a.firstCreatePass&&_v(a,n,r.length-1),ip(i,h),i[n.index]=h}function G$(n,e,t,r){for(let i of n)e.mergedAttrs=Sc(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(bv(e,e.mergedAttrs,!0),t!==null&&cM(r,t,e))}function z$(n,e,t,r,i,s){let o=Bn(),a=i[he],u=Dn(o,i);EM(a,i,o,t,null,r);for(let d=0;d<t.length;d++){let h=o.directiveStart+d,g=ma(i,a,h,o);$s(g,i)}IM(a,i,o),u&&$s(u,i);let l=ma(i,a,o.directiveStart+o.componentOffset,o);if(n[Ut]=i[Ut]=l,s!==null)for(let d of s)d(l,e);return gM(a,o,i),l}function W$(n,e,t,r){if(r)nv(n,t,["ng-version","17.3.12"]);else{let{attrs:i,classes:s}=D2(e.selectors[0]);i&&nv(n,t,i),s&&s.length>0&&uM(n,t,s.join(" "))}}function K$(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null?Array.from(s):null)}}function Q$(){let n=Bn();ow(Ge()[he],n)}var lp=(()=>{class n{static{this.__NG_ELEMENT_ID__=Y$}}return n})();function Y$(){let n=Bn();return J$(n,Ge())}var Z$=lp,VM=class extends Z${constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return lw(this._hostTNode,this._hostLView)}get injector(){return new Vs(this._hostTNode,this._hostLView)}get parentInjector(){let e=aw(this._hostTNode,this._hostLView);if(Ax(e)){let t=bf(e,this._hostLView),r=Tf(e),i=t[he].data[r+8];return new Vs(i,t)}else return new Vs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=wR(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Bt}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=Vc(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,Fc(this._hostTNode,o)),a}createComponent(e,t,r,i,s){let o=e&&!j2(e),a;if(o)a=t;else{let v=t||{};a=v.index,r=v.injector,i=v.projectableNodes,s=v.environmentInjector||v.ngModuleRef}let u=o?e:new _a(Mi(e)),l=r||this.parentInjector;if(!s&&u.ngModule==null){let D=(o?l:this.parentInjector).get(fn,null);D&&(s=D)}let d=Mi(u.componentType??{}),h=Vc(this._lContainer,d?.id??null),g=h?.firstChild??null,y=u.create(l,i,g,s);return this.insertImpl(y.hostView,a,Fc(this._hostTNode,h)),y}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(W2(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let u=i[Nt],l=new VM(u,u[rr],u[Nt]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return sp(o,i,s,r),e.attachToViewContainerRef(),UR(z_(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=wR(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=Oc(this._lContainer,t);r&&(wf(z_(this._lContainer),t),ep(r[he],r))}detach(e){let t=this._adjustIndex(e,-1),r=Oc(this._lContainer,t);return r&&wf(z_(this._lContainer),t)!=null?new ya(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function wR(n){return n[If]}function z_(n){return n[If]||(n[If]=[])}function J$(n,e){let t,r=e[n.index];return Cr(r)?t=r:(t=CM(r,e,null,n),e[n.index]=t,ip(e,t)),LM(t,e,n,r),new VM(t,n,e)}function X$(n,e){let t=n[Qe],r=t.createComment(""),i=Dn(e,n),s=ww(t,i);return Mf(t,s,r,DB(t,i),!1),r}var LM=jM,Mw=()=>!1;function eq(n,e,t){return Mw(n,e,t)}function jM(n,e,t,r){if(n[Jr])return;let i;t.type&8?i=nr(r):i=X$(e,t),n[Jr]=i}function tq(n,e,t){if(n[Jr]&&n[Nc])return!0;let r=t[jn],i=e.index-qt;if(!r||PU(e)||Zf(r,i))return!1;let o=mv(r,i),a=r.data[fw]?.[i],[u,l]=R$(o,a);return n[Jr]=u,n[Nc]=l,!0}function nq(n,e,t,r){Mw(n,t,e)||jM(n,e,t,r)}function rq(){LM=nq,Mw=tq}function iq(n){return Object.getPrototypeOf(n.prototype).constructor}function ji(n){let e=iq(n.type),t=!0,r=[n];for(;e;){let i;if(Ni(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ee(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let o=n;o.inputs=lf(n.inputs),o.inputTransforms=lf(n.inputTransforms),o.declaredInputs=lf(n.declaredInputs),o.outputs=lf(n.outputs);let a=i.hostBindings;a&&cq(n,a);let u=i.viewQuery,l=i.contentQueries;if(u&&aq(n,u),l&&uq(n,l),sq(n,i),Gj(n.outputs,i.outputs),Ni(i)&&i.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(n),a===ji&&(t=!1)}}e=Object.getPrototypeOf(e)}oq(r)}function sq(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];if(r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;n.inputTransforms??={},n.inputTransforms[i]=e.inputTransforms[i]}}}function oq(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Sc(i.hostAttrs,t=Sc(t,i.hostAttrs))}}function lf(n){return n===ha?{}:n===wn?[]:n}function aq(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function uq(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,s)=>{e(r,i,s),t(r,i,s)}:n.contentQueries=e}function cq(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}function Nw(n){let e=n.inputConfig,t={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(t[r]=i[3])}n.inputTransforms=t}var Pi=class{},jc=class{};var Rv=class extends Pi{constructor(e,t,r){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Ff(this);let i=QR(e);this._bootstrapComponents=nM(i.bootstrap),this._r3Injector=Fx(e,t,[{provide:Pi,useValue:this},{provide:up,useValue:this.componentFactoryResolver},...r],hn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},xv=class extends jc{constructor(e){super(),this.moduleType=e}create(e){return new Rv(this.moduleType,e,[])}};var Vf=class extends Pi{constructor(e){super(),this.componentFactoryResolver=new Ff(this),this.instance=null;let t=new Rc([...e.providers,{provide:Pi,useValue:this},{provide:up,useValue:this.componentFactoryResolver}],e.parent||Qv(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function dp(n,e,t=null){return new Vf({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var Qc=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Mt(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function Ca(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function Yc(n){return(n.flags&32)===32}function lq(n,e,t,r,i,s,o,a,u){let l=e.consts,d=rp(e,n,4,o||null,Df(l,a));wM(e,t,d,Df(l,u)),ow(e,d);let h=d.tView=Dw(2,d,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,d),h.queries=e.queries.embeddedTView(d)),d}function ki(n,e,t,r,i,s,o,a){let u=Ge(),l=ir(),d=n+qt,h=l.firstCreatePass?lq(d,l,u,e,t,r,i,s,o):l.data[d];Gc(h,!1);let g=UM(l,u,h,n);sw()&&Ew(l,u,g,h),$s(g,u);let y=CM(g,u,g,h);return u[d]=y,ip(u,y),eq(y,h,u),Zv(h)&&mM(l,u,h),o!=null&&yM(u,h,a),ki}var UM=BM;function BM(n,e,t,r){return Dr(!0),e[Qe].createComment("")}function dq(n,e,t,r){let i=e[jn],s=!i||Hc()||Yc(t)||Zf(i,r);if(Dr(s),s)return BM(n,e,t,r);let o=i.data[$U]?.[r]??null;o!==null&&t.tView!==null&&t.tView.ssrId===null&&(t.tView.ssrId=o);let a=op(i,n,e,t);Yf(i,r,a);let u=gw(i,r);return ap(u,a)}function hq(){UM=dq}function hp(n,e,t,r){let i=Ge(),s=zc();if(Ca(i,s,e)){let o=ir(),a=Cx();e$(a,i,n,e,t,r)}return hp}function fq(n,e,t,r){return Ca(n,zc(),t)?e+qf(t)+r:Ia}function df(n,e){return n<<17|e<<2}function qs(n){return n>>17&32767}function pq(n){return(n&2)==2}function gq(n,e){return n&131071|e<<17}function Mv(n){return n|2}function va(n){return(n&131068)>>2}function W_(n,e){return n&-131069|e<<2}function mq(n){return(n&1)===1}function Nv(n){return n|1}function yq(n,e,t,r,i,s){let o=s?e.classBindings:e.styleBindings,a=qs(o),u=va(o);n[r]=t;let l=!1,d;if(Array.isArray(t)){let h=t;d=h[1],(d===null||$c(h,d)>0)&&(l=!0)}else d=t;if(i)if(u!==0){let g=qs(n[a+1]);n[r+1]=df(g,a),g!==0&&(n[g+1]=W_(n[g+1],r)),n[a+1]=gq(n[a+1],r)}else n[r+1]=df(a,0),a!==0&&(n[a+1]=W_(n[a+1],r)),a=r;else n[r+1]=df(u,0),a===0?a=r:n[u+1]=W_(n[u+1],r),u=r;l&&(n[r+1]=Mv(n[r+1])),ER(n,d,r,!0),ER(n,d,r,!1),_q(e,d,n,r,s),o=df(a,u),s?e.classBindings=o:e.styleBindings=o}function _q(n,e,t,r,i){let s=i?n.residualClasses:n.residualStyles;s!=null&&typeof e=="string"&&$c(s,e)>=0&&(t[r+1]=Nv(t[r+1]))}function ER(n,e,t,r){let i=n[t+1],s=e===null,o=r?qs(i):va(i),a=!1;for(;o!==0&&(a===!1||s);){let u=n[o],l=n[o+1];vq(u,e)&&(a=!0,n[o+1]=r?Nv(l):Mv(l)),o=r?qs(l):va(l)}a&&(n[t+1]=r?Mv(i):Nv(i))}function vq(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?$c(n,e)>=0:!1}function Pw(n,e,t){let r=Ge(),i=zc();if(Ca(r,i,e)){let s=ir(),o=Cx();$B(s,o,r,n,e,r[Qe],t,!1)}return Pw}function IR(n,e,t,r,i){let s=e.inputs,o=i?"class":"style";Tw(n,t,s[o],o,r)}function fp(n,e){return wq(n,e,null,!0),fp}function wq(n,e,t,r){let i=Ge(),s=ir(),o=oU(2);if(s.firstUpdatePass&&Iq(s,n,o,r),e!==Ia&&Ca(i,o,e)){let a=s.data[Hs()];Aq(s,a,i,i[Qe],n,i[o+1]=Sq(e,t),r,o)}}function Eq(n,e){return e>=n.expandoStartIndex}function Iq(n,e,t,r){let i=n.data;if(i[t+1]===null){let s=i[Hs()],o=Eq(n,t);Rq(s,r)&&e===null&&!o&&(e=!1),e=Cq(i,s,e,r),yq(i,s,e,t,o,r)}}function Cq(n,e,t,r){let i=lU(n),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=K_(null,n,e,t,r),t=Uc(t,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||n[o]!==i)if(t=K_(i,n,e,t,r),s===null){let u=Dq(n,e,r);u!==void 0&&Array.isArray(u)&&(u=K_(null,n,e,u[1],r),u=Uc(u,e.attrs,r),Tq(n,e,r,u))}else s=bq(n,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),t}function Dq(n,e,t){let r=t?e.classBindings:e.styleBindings;if(va(r)!==0)return n[qs(r)]}function Tq(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[qs(i)]=r}function bq(n,e,t){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=n[s].hostAttrs;r=Uc(r,o,t)}return Uc(r,e.attrs,t)}function K_(n,e,t,r,i){let s=null,o=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<o&&(s=e[a],r=Uc(r,s.hostAttrs,i),s!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function Uc(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),d2(n,o,t?!0:e[++s]))}return n===void 0?null:n}function Aq(n,e,t,r,i,s,o,a){if(!(e.type&3))return;let u=n.data,l=u[a+1],d=mq(l)?CR(u,e,t,i,va(l),o):void 0;if(!Lf(d)){Lf(s)||pq(l)&&(s=CR(u,null,t,i,a,o));let h=dx(Hs(),t);xB(r,o,h,i,s)}}function CR(n,e,t,r,i,s){let o=e===null,a;for(;i>0;){let u=n[i],l=Array.isArray(u),d=l?u[1]:u,h=d===null,g=t[i+1];g===Ia&&(g=h?wn:void 0);let y=h?O_(g,r):d===r?g:void 0;if(l&&!Lf(y)&&(y=O_(u,r)),Lf(y)&&(a=y,o))return a;let v=n[i+1];i=o?qs(v):va(v)}if(e!==null){let u=s?e.residualClasses:e.residualStyles;u!=null&&(a=O_(u,r))}return a}function Lf(n){return n!==void 0}function Sq(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=hn(Kc(n)))),n}function Rq(n,e){return(n.flags&(e?8:16))!==0}var Pv=class{destroy(e){}updateValue(e,t){}swap(e,t){let r=Math.min(e,t),i=Math.max(e,t),s=this.detach(i);if(i-r>1){let o=this.detach(r);this.attach(r,s),this.attach(i,o)}else this.attach(r,s)}move(e,t){this.attach(t,this.detach(e))}};function Q_(n,e,t,r,i){return n===t&&Object.is(e,r)?1:Object.is(i(n,e),i(t,r))?-1:0}function xq(n,e,t){let r,i,s=0,o=n.length-1;if(Array.isArray(e)){let a=e.length-1;for(;s<=o&&s<=a;){let u=n.at(s),l=e[s],d=Q_(s,u,s,l,t);if(d!==0){d<0&&n.updateValue(s,l),s++;continue}let h=n.at(o),g=e[a],y=Q_(o,h,a,g,t);if(y!==0){y<0&&n.updateValue(o,g),o--,a--;continue}let v=t(s,u),D=t(o,h),A=t(s,l);if(Object.is(A,D)){let P=t(a,g);Object.is(P,v)?(n.swap(s,o),n.updateValue(o,g),a--,o--):n.move(o,s),n.updateValue(s,l),s++;continue}if(r??=new jf,i??=TR(n,s,o,t),kv(n,r,s,A))n.updateValue(s,l),s++,o++;else if(i.has(A))r.set(v,n.detach(s)),o--;else{let P=n.create(s,e[s]);n.attach(s,P),s++,o++}}for(;s<=a;)DR(n,r,t,s,e[s]),s++}else if(e!=null){let a=e[Symbol.iterator](),u=a.next();for(;!u.done&&s<=o;){let l=n.at(s),d=u.value,h=Q_(s,l,s,d,t);if(h!==0)h<0&&n.updateValue(s,d),s++,u=a.next();else{r??=new jf,i??=TR(n,s,o,t);let g=t(s,d);if(kv(n,r,s,g))n.updateValue(s,d),s++,o++,u=a.next();else if(!i.has(g))n.attach(s,n.create(s,d)),s++,o++,u=a.next();else{let y=t(s,l);r.set(y,n.detach(s)),o--}}}for(;!u.done;)DR(n,r,t,n.length,u.value),u=a.next()}for(;s<=o;)n.destroy(n.detach(o--));r?.forEach(a=>{n.destroy(a)})}function kv(n,e,t,r){return e!==void 0&&e.has(r)?(n.attach(t,e.get(r)),e.delete(r),!0):!1}function DR(n,e,t,r,i){if(kv(n,e,r,t(r,i)))n.updateValue(r,i);else{let s=n.create(r,i);n.attach(r,s)}}function TR(n,e,t,r){let i=new Set;for(let s=e;s<=t;s++)i.add(r(s,n.at(s)));return i}var jf=class{constructor(){this.kvMap=new Map,this._vMap=void 0}has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let r=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let i=this._vMap;for(;i.has(r);)r=i.get(r);i.set(r,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,r]of this.kvMap)if(e(r,t),this._vMap!==void 0){let i=this._vMap;for(;i.has(r);)r=i.get(r),e(r,t)}}};function Zc(n,e,t){Li("NgControlFlow");let r=Ge(),i=zc(),s=Lv(r,qt+n),o=0;if(Ca(r,i,e)){let a=Ie(null);try{if(AM(s,o),e!==-1){let u=jv(r[he],qt+e),l=Vc(s,u.tView.ssrId),d=Aw(r,u,t,{dehydratedView:l});sp(s,d,o,Fc(u,l))}}finally{Ie(a)}}else{let a=bM(s,o);a!==void 0&&(a[Ut]=t)}}var Ov=class{constructor(e,t,r){this.lContainer=e,this.$implicit=t,this.$index=r}get $count(){return this.lContainer.length-Bt}};function $M(n){return n}var Fv=class{constructor(e,t,r){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=r}};function qM(n,e,t,r,i,s,o,a,u,l,d,h,g){Li("NgControlFlow");let y=u!==void 0,v=Ge(),D=a?o.bind(v[In][Ut]):o,A=new Fv(y,D);v[qt+n]=A,ki(n+1,e,t,r,i,s),y&&ki(n+2,u,l,d,h,g)}var Vv=class extends Pv{constructor(e,t,r){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=r,this.needsIndexUpdate=!1}get length(){return this.lContainer.length-Bt}at(e){return this.getLView(e)[Ut].$implicit}attach(e,t){let r=t[jn];this.needsIndexUpdate||=e!==this.length,sp(this.lContainer,t,e,Fc(this.templateTNode,r))}detach(e){return this.needsIndexUpdate||=e!==this.length-1,Mq(this.lContainer,e)}create(e,t){let r=Vc(this.lContainer,this.templateTNode.tView.ssrId);return Aw(this.hostLView,this.templateTNode,new Ov(this.lContainer,t,e),{dehydratedView:r})}destroy(e){ep(e[he],e)}updateValue(e,t){this.getLView(e)[Ut].$implicit=t}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[Ut].$index=e}getLView(e){return Nq(this.lContainer,e)}};function HM(n){let e=Ie(null),t=Hs();try{let r=Ge(),i=r[he],s=r[t];if(s.liveCollection===void 0){let a=t+1,u=Lv(r,a),l=jv(i,a);s.liveCollection=new Vv(u,r,l)}else s.liveCollection.reset();let o=s.liveCollection;if(xq(o,n,s.trackByFn),o.updateIndexes(),s.hasEmptyBlock){let a=zc(),u=o.length===0;if(Ca(r,a,u)){let l=t+2,d=Lv(r,l);if(u){let h=jv(i,l),g=Vc(d,h.tView.ssrId),y=Aw(r,h,void 0,{dehydratedView:g});sp(d,y,0,Fc(h,g))}else AM(d,0)}}}finally{Ie(e)}}function Lv(n,e){return n[e]}function Mq(n,e){return Oc(n,e)}function Nq(n,e){return bM(n,e)}function jv(n,e){return Jv(n,e)}function Pq(n,e,t,r,i,s){let o=e.consts,a=Df(o,i),u=rp(e,n,2,r,a);return wM(e,t,u,Df(o,s)),u.attrs!==null&&bv(u,u.attrs,!1),u.mergedAttrs!==null&&bv(u,u.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,u),u}function Te(n,e,t,r){let i=Ge(),s=ir(),o=qt+n,a=i[Qe],u=s.firstCreatePass?Pq(o,s,i,e,t,r):s.data[o],l=GM(s,i,u,a,e,n);i[o]=l;let d=Zv(u);return Gc(u,!0),cM(a,l,u),!Yc(u)&&sw()&&Ew(s,i,l,u),Z2()===0&&$s(l,i),J2(),d&&(mM(s,i,u),gM(s,u,i)),r!==null&&yM(i,u),Te}function we(){let n=Bn();mx()?iU():(n=n.parent,Gc(n,!1));let e=n;eU(e)&&nU(),X2();let t=ir();return t.firstCreatePass&&(ow(t,n),sx(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&mU(e)&&IR(t,e,Ge(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&yU(e)&&IR(t,e,Ge(),e.stylesWithoutHost,!1),we}function qn(n,e,t,r){return Te(n,e,t,r),we(),qn}var GM=(n,e,t,r,i,s)=>(Dr(!0),Xf(r,i,Dx()));function kq(n,e,t,r,i,s){let o=e[jn],a=!o||Hc()||Yc(t)||Zf(o,s);if(Dr(a),a)return Xf(r,i,Dx());let u=op(o,n,e,t);return Yx(o,s)&&Yf(o,s,u.nextSibling),o&&(Lx(t)||jx(u))&&qc(t)&&(tU(t),aM(u)),u}function Oq(){GM=kq}var Fq=(n,e,t,r)=>(Dr(!0),vw(e[Qe],""));function Vq(n,e,t,r){let i,s=e[jn],o=!s||Hc()||Yc(t);if(Dr(o),o)return vw(e[Qe],"");let a=op(s,n,e,t),u=XU(s,r);return Yf(s,r,a),i=ap(u,a),i}function Lq(){Fq=Vq}function zM(){return Ge()}var Uf="en-US";var jq=Uf;function Uq(n){typeof n=="string"&&(jq=n.toLowerCase().replace(/_/g,"-"))}function WM(n,e,t){let r=n[Qe];switch(t){case Node.COMMENT_NODE:return vw(r,e);case Node.TEXT_NODE:return _w(r,e);case Node.ELEMENT_NODE:return Xf(r,e,null)}}var Bq=(n,e,t,r)=>(Dr(!0),WM(n,t,r));function $q(n,e,t,r){return Dr(!0),WM(n,t,r)}function qq(){Bq=$q}function sr(n,e,t,r){let i=Ge(),s=ir(),o=Bn();return Gq(s,i,i[Qe],o,n,e,r),sr}function Hq(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let a=e[xc],u=i[s+2];return a.length>u?a[u]:null}typeof o=="string"&&(s+=2)}return null}function Gq(n,e,t,r,i,s,o){let a=Zv(r),l=n.firstCreatePass&&s$(n),d=e[Ut],h=i$(e),g=!0;if(r.type&3||o){let D=Dn(r,e),A=o?o(D):D,P=h.length,B=o?K=>o(nr(K[r.index])):r.index,F=null;if(!o&&a&&(F=Hq(n,e,i,r.index)),F!==null){let K=F.__ngLastListenerFn__||F;K.__ngNextListenerFn__=s,F.__ngLastListenerFn__=s,g=!1}else{s=AR(r,e,d,s,!1);let K=t.listen(A,i,s);h.push(s,K),l&&l.push(i,B,P,P+1)}}else s=AR(r,e,d,s,!1);let y=r.outputs,v;if(g&&y!==null&&(v=y[i])){let D=v.length;if(D)for(let A=0;A<D;A+=2){let P=v[A],B=v[A+1],te=e[P][B].subscribe(s),X=h.length;h.push(s,te),l&&l.push(i,r.index,X,-(X+1))}}}function bR(n,e,t,r){let i=Ie(null);try{return _r(6,e,t),t(r)!==!1}catch(s){return TM(n,s),!1}finally{_r(7,e,t),Ie(i)}}function AR(n,e,t,r,i){return function s(o){if(o===Function)return r;let a=n.componentOffset>-1?Fi(n.index,e):e;Sw(a);let u=bR(e,t,r,o),l=s.__ngNextListenerFn__;for(;l;)u=bR(e,t,l,o)&&u,l=l.__ngNextListenerFn__;return i&&u===!1&&o.preventDefault(),u}}function kw(n=1){return hU(n)}function ke(n,e=""){let t=Ge(),r=ir(),i=n+qt,s=r.firstCreatePass?rp(r,i,1,e,null):r.data[i],o=KM(r,t,s,e,n);t[i]=o,sw()&&Ew(r,t,o,s),Gc(s,!1)}var KM=(n,e,t,r,i)=>(Dr(!0),_w(e[Qe],r));function zq(n,e,t,r,i){let s=e[jn],o=!s||Hc()||Yc(t)||Zf(s,i);return Dr(o),o?_w(e[Qe],r):op(s,n,e,t)}function Wq(){KM=zq}function Da(n,e,t){let r=Ge(),i=fq(r,n,e,t);return i!==Ia&&o$(r,Hs(),i),Da}function Kq(n,e,t){let r=ir();if(r.firstCreatePass){let i=Ni(n);Uv(t,r.data,r.blueprint,i,!0),Uv(e,r.data,r.blueprint,i,!1)}}function Uv(n,e,t,r,i){if(n=Jt(n),Array.isArray(n))for(let s=0;s<n.length;s++)Uv(n[s],e,t,r,i);else{let s=ir(),o=Ge(),a=Bn(),u=fa(n)?n:Jt(n.provide),l=tx(n),d=a.providerIndexes&1048575,h=a.directiveStart,g=a.providerIndexes>>20;if(fa(n)||!n.multi){let y=new Bs(l,i,De),v=Z_(u,e,i?d:d+g,h);v===-1?(lv(Af(a,o),s,u),Y_(s,n,e.length),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(y),o.push(y)):(t[v]=y,o[v]=y)}else{let y=Z_(u,e,d+g,h),v=Z_(u,e,d,d+g),D=y>=0&&t[y],A=v>=0&&t[v];if(i&&!A||!i&&!D){lv(Af(a,o),s,u);let P=Zq(i?Yq:Qq,t.length,i,r,l);!i&&A&&(t[v].providerFactory=P),Y_(s,n,e.length,0),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(P),o.push(P)}else{let P=QM(t[i?v:y],l,!i&&r);Y_(s,n,y>-1?y:v,P)}!i&&r&&A&&t[v].componentProviders++}}}function Y_(n,e,t,r){let i=fa(e),s=M2(e);if(i||s){let u=(s?Jt(e.useClass):e).prototype.ngOnDestroy;if(u){let l=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let d=l.indexOf(t);d===-1?l.push(t,[r,u]):l[d+1].push(r,u)}else l.push(t,u)}}}function QM(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Z_(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function Qq(n,e,t,r){return Bv(this.multi,[])}function Yq(n,e,t,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=ma(t,t[he],this.providerFactory.index,r);s=a.slice(0,o),Bv(i,s);for(let u=o;u<a.length;u++)s.push(a[u])}else s=[],Bv(i,s);return s}function Bv(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function Zq(n,e,t,r,i){let s=new Bs(n,t,De);return s.multi=[],s.index=e,s.componentProviders=0,QM(s,i,r&&!t),s}function pp(n,e=[]){return t=>{t.providersResolver=(r,i)=>Kq(r,i?i(n):n,e)}}var Jq=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=JR(!1,t.type),i=r.length>0?dp([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=Y({token:n,providedIn:"environment",factory:()=>new n(V(fn))})}}return n})();function Hn(n){Li("NgStandalone"),n.getStandaloneInjector=e=>e.get(Jq).getOrCreateStandaloneInjector(n)}var ei=class{constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},gp=new ei("17.3.12"),mp=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})();var YM=new H("");function Ws(n){return!!n&&typeof n.then=="function"}function ZM(n){return!!n&&typeof n.subscribe=="function"}var yp=new H(""),JM=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r}),this.appInits=j(yp,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let s=i();if(Ws(s))t.push(s);else if(ZM(s)){let o=new Promise((a,u)=>{s.subscribe({complete:a,error:u})});t.push(o)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Ks=new H("");function Xq(){TS(()=>{throw new ee(600,!1)})}function eH(n){return n.isBoundToModule}function tH(n,e,t){try{let r=t();return Ws(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}var Ui=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=j(Vx),this.afterRenderEffectManager=j(xw),this.externalTestViews=new Set,this.beforeRender=new et,this.afterTick=new et,this.componentTypes=[],this.components=[],this.isStable=j(Qc).hasPendingTasks.pipe(Q(t=>!t)),this._injector=j(fn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,r){let i=t instanceof Of;if(!this._injector.get(JM).done){let g=!i&&KR(t),y=!1;throw new ee(405,y)}let o;i?o=t:o=this._injector.get(up).resolveComponentFactory(t),this.componentTypes.push(o.componentType);let a=eH(o)?void 0:this._injector.get(Pi),u=r||o.selector,l=o.create(Dt.NULL,[],u,a),d=l.location.nativeElement,h=l.injector.get(YM,null);return h?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),J_(this.components,l),h?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){this._tick(!0)}_tick(t){if(this._runningTick)throw new ee(101,!1);let r=Ie(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(t)}catch(i){this.internalErrorHandler(i)}finally{this.afterTick.next(),this._runningTick=!1,Ie(r)}}detectChangesInAttachedViews(t){let r=0,i=this.afterRenderEffectManager;for(;;){if(r===RM)throw new ee(103,!1);if(t){let s=r===0;this.beforeRender.next(s);for(let{_lView:o,notifyErrorHandler:a}of this._views)nH(o,s,a)}if(r++,i.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:s})=>$v(s))&&(i.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:s})=>$v(s))))break}}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;J_(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);let r=this._injector.get(Ks,[]);[...this._bootstrapListeners,...r].forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>J_(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ee(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function J_(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}var hf;function Ow(n){hf??=new WeakMap;let e=hf.get(n);if(e)return e;let t=n.isStable.pipe(vn(r=>r)).toPromise().then(()=>{});return hf.set(n,t),n.onDestroy(()=>hf?.delete(n)),t}function nH(n,e,t){!e&&!$v(n)||rH(n,t,e)}function $v(n){return ew(n)}function rH(n,e,t){let r;t?(r=0,n[re]|=1024):n[re]&64?r=0:r=1,xM(n,e,r)}var qv=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},_p=(()=>{class n{compileModuleSync(t){return new xv(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=QR(t),s=nM(i.declarations).reduce((o,a)=>{let u=Mi(a);return u&&o.push(new _a(u)),o},[]);return new qv(r,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var iH=(()=>{class n{constructor(){this.zone=j(le),this.applicationRef=j(Ui)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function sH(n){return[{provide:le,useFactory:n},{provide:Ls,multi:!0,useFactory:()=>{let e=j(iH,{optional:!0});return()=>e.initialize()}},{provide:Ls,multi:!0,useFactory:()=>{let e=j(cH);return()=>{e.initialize()}}},{provide:Vx,useFactory:oH}]}function oH(){let n=j(le),e=j(Er);return t=>n.runOutsideAngular(()=>e.handleError(t))}function aH(n){let e=sH(()=>new le(uH(n)));return Xt([[],e])}function uH(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var cH=(()=>{class n{constructor(){this.subscription=new st,this.initialized=!1,this.zone=j(le),this.pendingTasks=j(Qc)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{le.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{le.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function lH(){return typeof $localize<"u"&&$localize.locale||Uf}var Fw=new H("",{providedIn:"root",factory:()=>j(Fw,me.Optional|me.SkipSelf)||lH()});var XM=new H("");var yf=null;function dH(n=[],e){return Dt.create({name:e,providers:[{provide:Gf,useValue:"platform"},{provide:XM,useValue:new Set([()=>yf=null])},...n]})}function hH(n=[]){if(yf)return yf;let e=dH(n);return yf=e,Xq(),fH(e),e}function fH(n){n.get(dw,null)?.forEach(t=>t())}function Vw(){return!1}var Ta=(()=>{class n{static{this.__NG_ELEMENT_ID__=pH}}return n})();function pH(n){return gH(Bn(),Ge(),(n&16)===16)}function gH(n,e,t){if(qc(n)&&!t){let r=Fi(n.index,e);return new ya(r,r)}else if(n.type&47){let r=e[In];return new ya(r,e)}return null}function eN(n){try{let{rootComponent:e,appProviders:t,platformProviders:r}=n,i=hH(r),s=[aH(),...t||[]],a=new Vf({providers:s,parent:i,debugName:"",runEnvironmentInitializers:!1}).injector,u=a.get(le);return u.run(()=>{a.resolveInjectorInitializers();let l=a.get(Er,null),d;u.runOutsideAngular(()=>{d=u.onError.subscribe({next:y=>{l.handleError(y)}})});let h=()=>a.destroy(),g=i.get(XM);return g.add(h),a.onDestroy(()=>{d.unsubscribe(),g.delete(h)}),tH(l,u,()=>{let y=a.get(JM);return y.runInitializers(),y.donePromise.then(()=>{let v=a.get(Fw,Uf);Uq(v||Uf);let D=a.get(Ui);return e!==void 0&&D.bootstrap(e),D})})})}catch(e){return Promise.reject(e)}}var SR=!1,mH=!1;function yH(){SR||(SR=!0,QU(),Oq(),Wq(),Lq(),hq(),rq(),M$(),LB(),qq())}function _H(n,e){return Ow(n)}function tN(){return Xt([{provide:uf,useFactory:()=>{let n=!0;return Tc()&&(n=!!j(Gs,{optional:!0})?.get(Kx,null)),n&&Li("NgHydration"),n}},{provide:Ls,useValue:()=>{mH=!!j(eB,{optional:!0}),Tc()&&j(uf)&&(vH(),yH())},multi:!0},{provide:Jx,useFactory:()=>Tc()&&j(uf)},{provide:Ks,useFactory:()=>{if(Tc()&&j(uf)){let n=j(Ui),e=j(Dt);return()=>{_H(n,e).then(()=>{I$(n)})}}return()=>{}},multi:!0}])}function vH(){let n=Kf(),e;for(let t of n.body.childNodes)if(t.nodeType===Node.COMMENT_NODE&&t.textContent?.trim()===WU){e=t;break}if(!e)throw new ee(-507,!1)}function ba(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function nN(n){let e=Mi(n);if(!e)return null;let t=new _a(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var sN=null;function ni(){return sN}function oN(n){sN??=n}var vp=class{};var tn=new H(""),Uw=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:()=>j(wH),providedIn:"platform"})}}return n})(),aN=new H(""),wH=(()=>{class n extends Uw{constructor(){super(),this._doc=j(tn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ni().getBaseHref(this._doc)}onPopState(t){let r=ni().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=ni().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:()=>new n,providedIn:"platform"})}}return n})();function Bw(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function rN(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function ti(n){return n&&n[0]!=="?"?"?"+n:n}var ri=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:()=>j($w),providedIn:"root"})}}return n})(),uN=new H(""),$w=(()=>{class n extends ri{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??j(tn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Bw(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+ti(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+ti(s));this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+ti(s));this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||n)(V(Uw),V(uN,8))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),cN=(()=>{class n extends ri{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],r!=null&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(t){let r=Bw(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+ti(s));o.length==0&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+ti(s));o.length==0&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||n)(V(Uw),V(uN,8))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})(),Aa=(()=>{class n{constructor(t){this._subject=new jt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=CH(rN(iN(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+ti(r))}normalize(t){return n.stripTrailingSlash(IH(this._basePath,iN(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ti(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ti(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}static{this.normalizeQueryParams=ti}static{this.joinWithSlash=Bw}static{this.stripTrailingSlash=rN}static{this.\u0275fac=function(r){return new(r||n)(V(ri))}}static{this.\u0275prov=Y({token:n,factory:()=>EH(),providedIn:"root"})}}return n})();function EH(){return new Aa(V(ri))}function IH(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function iN(n){return n.replace(/\/index.html$/,"")}function CH(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function qw(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var Qs=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Gt({type:n})}static{this.\u0275inj=Ht({})}}return n})(),Hw="browser",DH="server";function TH(n){return n===Hw}function ii(n){return n===DH}var lN=(()=>{class n{static{this.\u0275prov=Y({token:n,providedIn:"root",factory:()=>TH(j(at))?new Lw(j(tn),window):new jw})}}return n})(),Lw=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=bH(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function bH(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var jw=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},wp=class{};var Ip=class n{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let i=t.slice(0,r),s=i.toLowerCase(),o=t.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.setHeaderEntries(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,t);let i=(e.op==="a"?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let o=this.headers.get(t);if(!o)return;o=o.filter(a=>s.indexOf(a)===-1),o.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}break}}setHeaderEntries(e,t){let r=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var _N=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(_N||{}),Gw=class{constructor(e,t=vN.Ok,r="OK"){this.headers=e.headers||new Ip,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}};var Cp=class n extends Gw{constructor(e={}){super(e),this.type=_N.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}};var vN=function(n){return n[n.Continue=100]="Continue",n[n.SwitchingProtocols=101]="SwitchingProtocols",n[n.Processing=102]="Processing",n[n.EarlyHints=103]="EarlyHints",n[n.Ok=200]="Ok",n[n.Created=201]="Created",n[n.Accepted=202]="Accepted",n[n.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",n[n.NoContent=204]="NoContent",n[n.ResetContent=205]="ResetContent",n[n.PartialContent=206]="PartialContent",n[n.MultiStatus=207]="MultiStatus",n[n.AlreadyReported=208]="AlreadyReported",n[n.ImUsed=226]="ImUsed",n[n.MultipleChoices=300]="MultipleChoices",n[n.MovedPermanently=301]="MovedPermanently",n[n.Found=302]="Found",n[n.SeeOther=303]="SeeOther",n[n.NotModified=304]="NotModified",n[n.UseProxy=305]="UseProxy",n[n.Unused=306]="Unused",n[n.TemporaryRedirect=307]="TemporaryRedirect",n[n.PermanentRedirect=308]="PermanentRedirect",n[n.BadRequest=400]="BadRequest",n[n.Unauthorized=401]="Unauthorized",n[n.PaymentRequired=402]="PaymentRequired",n[n.Forbidden=403]="Forbidden",n[n.NotFound=404]="NotFound",n[n.MethodNotAllowed=405]="MethodNotAllowed",n[n.NotAcceptable=406]="NotAcceptable",n[n.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",n[n.RequestTimeout=408]="RequestTimeout",n[n.Conflict=409]="Conflict",n[n.Gone=410]="Gone",n[n.LengthRequired=411]="LengthRequired",n[n.PreconditionFailed=412]="PreconditionFailed",n[n.PayloadTooLarge=413]="PayloadTooLarge",n[n.UriTooLong=414]="UriTooLong",n[n.UnsupportedMediaType=415]="UnsupportedMediaType",n[n.RangeNotSatisfiable=416]="RangeNotSatisfiable",n[n.ExpectationFailed=417]="ExpectationFailed",n[n.ImATeapot=418]="ImATeapot",n[n.MisdirectedRequest=421]="MisdirectedRequest",n[n.UnprocessableEntity=422]="UnprocessableEntity",n[n.Locked=423]="Locked",n[n.FailedDependency=424]="FailedDependency",n[n.TooEarly=425]="TooEarly",n[n.UpgradeRequired=426]="UpgradeRequired",n[n.PreconditionRequired=428]="PreconditionRequired",n[n.TooManyRequests=429]="TooManyRequests",n[n.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",n[n.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",n[n.InternalServerError=500]="InternalServerError",n[n.NotImplemented=501]="NotImplemented",n[n.BadGateway=502]="BadGateway",n[n.ServiceUnavailable=503]="ServiceUnavailable",n[n.GatewayTimeout=504]="GatewayTimeout",n[n.HttpVersionNotSupported=505]="HttpVersionNotSupported",n[n.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",n[n.InsufficientStorage=507]="InsufficientStorage",n[n.LoopDetected=508]="LoopDetected",n[n.NotExtended=510]="NotExtended",n[n.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",n}(vN||{});var RH=new H("");var dN="b",hN="h",fN="s",pN="st",gN="u",mN="rt",Ep=new H(""),xH=["GET","HEAD"];function MH(n,e){let h=j(Ep),{isCacheActive:t}=h,r=iS(h,["isCacheActive"]),{transferCache:i,method:s}=n;if(!t||s==="POST"&&!r.includePostRequests&&!i||s!=="POST"&&!xH.includes(s)||i===!1||r.filter?.(n)===!1)return e(n);let o=j(Gs),a=PH(n),u=o.get(a,null),l=r.includeHeaders;if(typeof i=="object"&&i.includeHeaders&&(l=i.includeHeaders),u){let{[dN]:g,[mN]:y,[hN]:v,[fN]:D,[pN]:A,[gN]:P}=u,B=g;switch(y){case"arraybuffer":B=new TextEncoder().encode(g).buffer;break;case"blob":B=new Blob([g]);break}let F=new Ip(v);return Z(new Cp({body:B,headers:F,status:D,statusText:A,url:P}))}let d=ii(j(at));return e(n).pipe(ot(g=>{g instanceof Cp&&d&&o.set(a,{[dN]:g.body,[hN]:NH(g.headers,l),[fN]:g.status,[pN]:g.statusText,[gN]:g.url||"",[mN]:n.responseType})}))}function NH(n,e){if(!e)return{};let t={};for(let r of e){let i=n.getAll(r);i!==null&&(t[r]=i)}return t}function yN(n){return[...n.keys()].sort().map(e=>`${e}=${n.getAll(e)}`).join("&")}function PH(n){let{params:e,method:t,responseType:r,url:i}=n,s=yN(e),o=n.serializeBody();o instanceof URLSearchParams?o=yN(o):typeof o!="string"&&(o="");let a=[t,r,i,o,s].join("|"),u=kH(a);return u}function kH(n){let e=0;for(let t of n)e=Math.imul(31,e)+t.charCodeAt(0)<<0;return e+=2147483648,e.toString()}function wN(n){return[{provide:Ep,useFactory:()=>(Li("NgHttpTransferCache"),G({isCacheActive:!0},n))},{provide:RH,useValue:MH,multi:!0,deps:[Gs,Ep]},{provide:Ks,multi:!0,useFactory:()=>{let e=j(Ui),t=j(Ep);return()=>{Ow(e).then(()=>{t.isCacheActive=!1})}}}]}var Kw=class extends vp{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Qw=class n extends Kw{static makeCurrent(){oN(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=OH();return t==null?null:FH(t)}resetBaseElement(){Jc=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return qw(document.cookie,e)}},Jc=null;function OH(){return Jc=Jc||document.querySelector("base"),Jc?Jc.getAttribute("href"):null}function FH(n){return new URL(n,document.baseURI).pathname}var VH=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})(),Yw=new H(""),DN=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new ee(5101,!1);return this._eventNameToPlugin.set(t,r),r}static{this.\u0275fac=function(r){return new(r||n)(V(Yw),V(le))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})(),Dp=class{constructor(e){this._doc=e}},zw="ng-app-id",TN=(()=>{class n{constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=ii(s),this.resetHostNodes()}addStyles(t){for(let r of t)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(t){for(let r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){let r=this.styleRef;r.get(t)?.elements?.forEach(i=>i.remove()),r.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${zw}="${this.appId}"]`);if(t?.length){let r=new Map;return t.forEach(i=>{i.textContent!=null&&r.set(i.textContent,i)}),r}return null}changeUsageCount(t,r){let i=this.styleRef;if(i.has(t)){let s=i.get(t);return s.usage+=r,s.usage}return i.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){let i=this.styleNodesInDOM,s=i?.get(r);if(s?.parentNode===t)return i.delete(r),s.removeAttribute(zw),s;{let o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=r,this.platformIsServer&&o.setAttribute(zw,this.appId),t.appendChild(o),o}}addStyleToHost(t,r){let i=this.getStyleElement(t,r),s=this.styleRef,o=s.get(r)?.elements;o?o.push(i):s.set(r,{elements:[i],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||n)(V(tn),V(Qf),V(hw,8),V(at))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})(),Ww={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Xw=/%COMP%/g,bN="%COMP%",LH=`_nghost-${bN}`,jH=`_ngcontent-${bN}`,UH=!0,BH=new H("",{providedIn:"root",factory:()=>UH});function $H(n){return jH.replace(Xw,n)}function qH(n){return LH.replace(Xw,n)}function AN(n,e){return e.map(t=>t.replace(Xw,n))}var EN=(()=>{class n{constructor(t,r,i,s,o,a,u,l=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=u,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=ii(a),this.defaultRenderer=new Xc(t,o,u,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===wr.ShadowDom&&(r=xe(G({},r),{encapsulation:wr.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof Tp?i.applyToHost(t):i instanceof el&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let o=this.doc,a=this.ngZone,u=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(r.encapsulation){case wr.Emulated:s=new Tp(u,l,r,this.appId,d,o,a,h);break;case wr.ShadowDom:return new Zw(u,l,t,r,o,a,this.nonce,h);default:s=new el(u,l,r,d,o,a,h);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||n)(V(DN),V(TN),V(Qf),V(BH),V(tn),V(at),V(le),V(hw))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})(),Xc=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(Ww[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(IN(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(IN(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new ee(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=Ww[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=Ww[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Xr.DashCase|Xr.Important)?e.style.setProperty(t,r,i&Xr.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Xr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=ni().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function IN(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Zw=class extends Xc{constructor(e,t,r,i,s,o,a,u){super(e,s,o,u),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=AN(i.id,i.styles);for(let d of l){let h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=d,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},el=class extends Xc{constructor(e,t,r,i,s,o,a,u){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=u?AN(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Tp=class extends el{constructor(e,t,r,i,s,o,a,u){let l=i+"-"+r.id;super(e,t,r,s,o,a,u,l),this.contentAttr=$H(l),this.hostAttr=qH(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},HH=(()=>{class n extends Dp{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}static{this.\u0275fac=function(r){return new(r||n)(V(tn))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})(),CN=["alt","control","meta","shift"],GH={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},zH={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},WH=(()=>{class n extends Dp{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i){let s=n.parseEventName(r),o=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ni().onAndCancel(t,s.domEventName,o))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),CN.forEach(l=>{let d=r.indexOf(l);d>-1&&(r.splice(d,1),o+=l+".")}),o+=s,r.length!=0||s.length===0)return null;let u={};return u.domEventName=i,u.fullKey=o,u}static matchEventFullKeyCode(t,r){let i=GH[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),CN.forEach(o=>{if(o!==i){let a=zH[o];a(t)&&(s+=o+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(r){return new(r||n)(V(tn))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})();function SN(n,e){return eN(G({rootComponent:n},KH(e)))}function KH(n){return{appProviders:[...XH,...n?.providers??[]],platformProviders:JH}}function QH(){Qw.makeCurrent()}function YH(){return new Er}function ZH(){return Hx(document),document}var JH=[{provide:at,useValue:Hw},{provide:dw,useValue:QH,multi:!0},{provide:tn,useFactory:ZH,deps:[]}];var XH=[{provide:Gf,useValue:"root"},{provide:Er,useFactory:YH,deps:[]},{provide:Yw,useClass:HH,multi:!0,deps:[tn,le,at]},{provide:Yw,useClass:WH,multi:!0,deps:[tn]},EN,TN,DN,{provide:Lc,useExisting:EN},{provide:wp,useClass:VH,deps:[]},[]];var RN=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(r){return new(r||n)(V(tn))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Jw=function(n){return n[n.NoHttpTransferCache=0]="NoHttpTransferCache",n[n.HttpTransferCacheOptions=1]="HttpTransferCacheOptions",n}(Jw||{});function xN(...n){let e=[],t=new Set,r=t.has(Jw.HttpTransferCacheOptions);for(let{\u0275providers:i,\u0275kind:s}of n)t.add(s),i.length&&e.push(i);return Xt([[],tN(),t.has(Jw.NoHttpTransferCache)||r?[]:wN({}),e])}var fe="primary",ml=Symbol("RouteTitle"),iE=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Na(n){return new iE(n)}function t4(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function n4(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Tr(n[t],e[t]))return!1;return!0}function Tr(n,e){let t=n?sE(n):void 0,r=e?sE(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!jN(n[i],e[i]))return!1;return!0}function sE(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function jN(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function UN(n){return n.length>0?n[n.length-1]:null}function Hi(n){return A_(n)?n:Ws(n)?Ce(Promise.resolve(n)):Z(n)}var r4={exact:$N,subset:qN},BN={exact:i4,subset:s4,ignored:()=>!0};function MN(n,e,t){return r4[t.paths](n.root,e.root,t.matrixParams)&&BN[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function i4(n,e){return Tr(n,e)}function $N(n,e,t){if(!Zs(n.segments,e.segments)||!Sp(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!$N(n.children[r],e.children[r],t))return!1;return!0}function s4(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>jN(n[t],e[t]))}function qN(n,e,t){return HN(n,e,e.segments,t)}function HN(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Zs(i,t)||e.hasChildren()||!Sp(i,t,r))}else if(n.segments.length===t.length){if(!Zs(n.segments,t)||!Sp(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!qN(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!Zs(n.segments,i)||!Sp(n.segments,i,r)||!n.children[fe]?!1:HN(n.children[fe],e,s,r)}}function Sp(n,e,t){return e.every((r,i)=>BN[t](n[i].parameters,r.parameters))}var Bi=class{constructor(e=new Pe([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Na(this.queryParams),this._queryParamMap}toString(){return u4.serialize(this)}},Pe=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Rp(this)}},Ys=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Na(this.parameters),this._parameterMap}toString(){return zN(this)}};function o4(n,e){return Zs(n,e)&&n.every((t,r)=>Tr(t.parameters,e[r].parameters))}function Zs(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function a4(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===fe&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==fe&&(t=t.concat(e(i,r)))}),t}var yl=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:()=>new al,providedIn:"root"})}}return n})(),al=class{parse(e){let t=new aE(e);return new Bi(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${tl(e.root,!0)}`,r=d4(e.queryParams),i=typeof e.fragment=="string"?`#${c4(e.fragment)}`:"";return`${t}${r}${i}`}},u4=new al;function Rp(n){return n.segments.map(e=>zN(e)).join("/")}function tl(n,e){if(!n.hasChildren())return Rp(n);if(e){let t=n.children[fe]?tl(n.children[fe],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==fe&&r.push(`${i}:${tl(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=a4(n,(r,i)=>i===fe?[tl(n.children[fe],!1)]:[`${i}:${tl(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[fe]!=null?`${Rp(n)}/${t[0]}`:`${Rp(n)}/(${t.join("//")})`}}function GN(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function bp(n){return GN(n).replace(/%3B/gi,";")}function c4(n){return encodeURI(n)}function oE(n){return GN(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function xp(n){return decodeURIComponent(n)}function NN(n){return xp(n.replace(/\+/g,"%20"))}function zN(n){return`${oE(n.path)}${l4(n.parameters)}`}function l4(n){return Object.entries(n).map(([e,t])=>`;${oE(e)}=${oE(t)}`).join("")}function d4(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${bp(t)}=${bp(i)}`).join("&"):`${bp(t)}=${bp(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var h4=/^[^\/()?;#]+/;function eE(n){let e=n.match(h4);return e?e[0]:""}var f4=/^[^\/()?;=#]+/;function p4(n){let e=n.match(f4);return e?e[0]:""}var g4=/^[^=?&#]+/;function m4(n){let e=n.match(g4);return e?e[0]:""}var y4=/^[^&#]+/;function _4(n){let e=n.match(y4);return e?e[0]:""}var aE=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Pe([],{}):new Pe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[fe]=new Pe(e,t)),r}parseSegment(){let e=eE(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new ee(4009,!1);return this.capture(e),new Ys(xp(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=p4(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=eE(this.remaining);i&&(r=i,this.capture(r))}e[xp(t)]=xp(r)}parseQueryParam(e){let t=m4(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=_4(this.remaining);o&&(r=o,this.capture(r))}let i=NN(t),s=NN(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=eE(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new ee(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=fe);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[fe]:new Pe([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new ee(4011,!1)}};function WN(n){return n.segments.length>0?new Pe([],{[fe]:n}):n}function KN(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=KN(i);if(r===fe&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new Pe(n.segments,e);return v4(t)}function v4(n){if(n.numberOfChildren===1&&n.children[fe]){let e=n.children[fe];return new Pe(n.segments.concat(e.segments),e.children)}return n}function Pa(n){return n instanceof Bi}function w4(n,e,t=null,r=null){let i=QN(n);return YN(i,e,t,r)}function QN(n){let e;function t(s){let o={};for(let u of s.children){let l=t(u);o[u.outlet]=l}let a=new Pe(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=WN(r);return e??i}function YN(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return tE(i,i,i,t,r);let s=E4(e);if(s.toRoot())return tE(i,i,new Pe([],{}),t,r);let o=I4(s,i,n),a=o.processChildren?il(o.segmentGroup,o.index,s.commands):JN(o.segmentGroup,o.index,s.commands);return tE(i,o.segmentGroup,a,t,r)}function Mp(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function ul(n){return typeof n=="object"&&n!=null&&n.outlets}function tE(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([u,l])=>{s[u]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`});let o;n===e?o=t:o=ZN(n,e,t);let a=WN(KN(o));return new Bi(a,s,i)}function ZN(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=ZN(s,e,t)}),new Pe(n.segments,r)}var Np=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Mp(r[0]))throw new ee(4003,!1);let i=r.find(ul);if(i&&i!==UN(r))throw new ee(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function E4(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Np(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([u,l])=>{a[u]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,u)=>{u==0&&a==="."||(u==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Np(t,e,r)}var xa=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function I4(n,e,t){if(n.isAbsolute)return new xa(e,!0,0);if(!t)return new xa(e,!1,NaN);if(t.parent===null)return new xa(t,!0,0);let r=Mp(n.commands[0])?0:1,i=t.segments.length-1+r;return C4(t,i,n.numberOfDoubleDots)}function C4(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new ee(4005,!1);i=r.segments.length}return new xa(r,!1,i-s)}function D4(n){return ul(n[0])?n[0].outlets:{[fe]:n}}function JN(n,e,t){if(n??=new Pe([],{}),n.segments.length===0&&n.hasChildren())return il(n,e,t);let r=T4(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new Pe(n.segments.slice(0,r.pathIndex),{});return s.children[fe]=new Pe(n.segments.slice(r.pathIndex),n.children),il(s,0,i)}else return r.match&&i.length===0?new Pe(n.segments,{}):r.match&&!n.hasChildren()?uE(n,e,t):r.match?il(n,0,i):uE(n,e,t)}function il(n,e,t){if(t.length===0)return new Pe(n.segments,{});{let r=D4(t),i={};if(Object.keys(r).some(s=>s!==fe)&&n.children[fe]&&n.numberOfChildren===1&&n.children[fe].segments.length===0){let s=il(n.children[fe],e,t);return new Pe(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=JN(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Pe(n.segments,i)}}function T4(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(ul(a))break;let u=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&u===void 0)break;if(u&&l&&typeof l=="object"&&l.outlets===void 0){if(!kN(u,l,o))return s;r+=2}else{if(!kN(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function uE(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(ul(s)){let u=b4(s.outlets);return new Pe(r,u)}if(i===0&&Mp(t[0])){let u=n.segments[e];r.push(new Ys(u.path,PN(t[0]))),i++;continue}let o=ul(s)?s.outlets[fe]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&Mp(a)?(r.push(new Ys(o,PN(a))),i+=2):(r.push(new Ys(o,{})),i++)}return new Pe(r,{})}function b4(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=uE(new Pe([],{}),0,r))}),e}function PN(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function kN(n,e,t){return n==t.path&&Tr(e,t.parameters)}var sl="imperative",Tt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Tt||{}),Gn=class{constructor(e,t){this.id=e,this.url=t}},ka=class extends Gn{constructor(e,t,r="imperative",i=null){super(e,t),this.type=Tt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},br=class extends Gn{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=Tt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},bn=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(bn||{}),Pp=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Pp||{}),$i=class extends Gn{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Tt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},qi=class extends Gn{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Tt.NavigationSkipped}},cl=class extends Gn{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=Tt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},kp=class extends Gn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Tt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},cE=class extends Gn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Tt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},lE=class extends Gn{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=Tt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},dE=class extends Gn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Tt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},hE=class extends Gn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Tt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},fE=class{constructor(e){this.route=e,this.type=Tt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},pE=class{constructor(e){this.route=e,this.type=Tt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},gE=class{constructor(e){this.snapshot=e,this.type=Tt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},mE=class{constructor(e){this.snapshot=e,this.type=Tt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},yE=class{constructor(e){this.snapshot=e,this.type=Tt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},_E=class{constructor(e){this.snapshot=e,this.type=Tt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Op=class{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=Tt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},ll=class{},dl=class{constructor(e){this.url=e}};var vE=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new _l,this.attachRef=null}},_l=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new vE,this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Fp=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=wE(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=wE(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=EE(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return EE(e,this._root).map(t=>t.value)}};function wE(n,e){if(n===e.value)return e;for(let t of e.children){let r=wE(n,t);if(r)return r}return null}function EE(n,e){if(n===e.value)return[e];for(let t of e.children){let r=EE(n,t);if(r.length)return r.unshift(e),r}return[]}var Tn=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Ra(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Vp=class extends Fp{constructor(e,t){super(e),this.snapshot=t,ME(this,e)}toString(){return this.snapshot.toString()}};function XN(n){let e=A4(n),t=new Mt([new Ys("",{})]),r=new Mt({}),i=new Mt({}),s=new Mt({}),o=new Mt(""),a=new Ar(t,r,s,o,i,fe,n,e.root);return a.snapshot=e.root,new Vp(new Tn(a,[]),e)}function A4(n){let e={},t={},r={},i="",s=new hl([],e,r,i,t,fe,n,null,{});return new Lp("",new Tn(s,[]))}var Ar=class{constructor(e,t,r,i,s,o,a,u){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(Q(l=>l[ml]))??Z(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Q(e=>Na(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Q(e=>Na(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function xE(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:G(G({},e.params),n.params),data:G(G({},e.data),n.data),resolve:G(G(G(G({},n.data),e.data),i?.data),n._resolvedData)}:r={params:G({},n.params),data:G({},n.data),resolve:G(G({},n.data),n._resolvedData??{})},i&&tP(i)&&(r.resolve[ml]=i.title),r}var hl=class{get title(){return this.data?.[ml]}constructor(e,t,r,i,s,o,a,u,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=u,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Na(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Na(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Lp=class extends Fp{constructor(e,t){super(t),this.url=e,ME(this,t)}toString(){return eP(this._root)}};function ME(n,e){e.value._routerState=n,e.children.forEach(t=>ME(n,t))}function eP(n){let e=n.children.length>0?` { ${n.children.map(eP).join(", ")} } `:"";return`${n.value}${e}`}function nE(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Tr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Tr(e.params,t.params)||n.paramsSubject.next(t.params),n4(e.url,t.url)||n.urlSubject.next(t.url),Tr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function IE(n,e){let t=Tr(n.params,e.params)&&o4(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||IE(n.parent,e.parent))}function tP(n){return typeof n.title=="string"||n.title===null}var vl=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=fe,this.activateEvents=new jt,this.deactivateEvents=new jt,this.attachEvents=new jt,this.detachEvents=new jt,this.parentContexts=j(_l),this.location=j(lp),this.changeDetector=j(Ta),this.environmentInjector=j(fn),this.inputBinder=j($p,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ee(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ee(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ee(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new ee(4013,!1);this._activatedRoute=t;let i=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,u=new CE(t,a,i.injector);this.activated=i.createComponent(o,{index:i.length,injector:u,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=Cn({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Oi]})}}return n})(),CE=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===Ar?this.route:e===_l?this.childContexts:this.parent.get(e,t)}},$p=new H(""),ON=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:r}=t,i=Ec([r.queryParams,r.params,r.data]).pipe(He(([s,o,a],u)=>(a=G(G(G({},s),o),a),u===0?Z(a):Promise.resolve(a)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==r||r.component===null){this.unsubscribeFromRouteData(t);return}let o=nN(r.component);if(!o){this.unsubscribeFromRouteData(t);return}for(let{templateName:a}of o.inputs)t.activatedComponentRef.setInput(a,s[a])});this.outletDataSubscriptions.set(t,i)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})();function S4(n,e,t){let r=fl(n,e._root,t?t._root:void 0);return new Vp(r,e)}function fl(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=R4(n,e,t);return new Tn(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>fl(n,a)),o}}let r=x4(e.value),i=e.children.map(s=>fl(n,s));return new Tn(r,i)}}function R4(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return fl(n,r,i);return fl(n,r)})}function x4(n){return new Ar(new Mt(n.url),new Mt(n.params),new Mt(n.queryParams),new Mt(n.fragment),new Mt(n.data),n.outlet,n.component,n)}var nP="ngNavigationCancelingError";function rP(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Pa(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=iP(!1,bn.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function iP(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[nP]=!0,t.cancellationCode=e,t}function M4(n){return sP(n)&&Pa(n.url)}function sP(n){return!!n&&n[nP]}var N4=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Un({type:n,selectors:[["ng-component"]],standalone:!0,features:[Hn],decls:1,vars:0,template:function(r,i){r&1&&qn(0,"router-outlet")},dependencies:[vl],encapsulation:2})}}return n})();function P4(n,e){return n.providers&&!n._injector&&(n._injector=dp(n.providers,e,`Route: ${n.path}`)),n._injector??e}function NE(n){let e=n.children&&n.children.map(NE),t=e?xe(G({},n),{children:e}):G({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==fe&&(t.component=N4),t}function Sr(n){return n.outlet||fe}function k4(n,e){let t=n.filter(r=>Sr(r)===e);return t.push(...n.filter(r=>Sr(r)!==e)),t}function wl(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var O4=(n,e,t,r)=>Q(i=>(new DE(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),DE=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),nE(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=Ra(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Ra(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Ra(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=Ra(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new _E(s.value.snapshot))}),e.children.length&&this.forwardEvent(new mE(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(nE(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),nE(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=wl(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},jp=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Ma=class{constructor(e,t){this.component=e,this.route=t}};function F4(n,e,t){let r=n._root,i=e?e._root:null;return nl(r,i,t,[r.value])}function V4(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Fa(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!NR(n)?n:e.get(n):r}function nl(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Ra(e);return n.children.forEach(o=>{L4(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>ol(a,t.getContext(o),i)),i}function L4(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let u=j4(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new jp(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?nl(n,e,a?a.children:null,r,i):nl(n,e,t,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Ma(a.outlet.component,o))}else o&&ol(e,a,i),i.canActivateChecks.push(new jp(r)),s.component?nl(n,null,a?a.children:null,r,i):nl(n,null,t,r,i);return i}function j4(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Zs(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Zs(n.url,e.url)||!Tr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!IE(n,e)||!Tr(n.queryParams,e.queryParams);case"paramsChange":default:return!IE(n,e)}}function ol(n,e,t){let r=Ra(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?ol(o,e.children.getContext(s),t):ol(o,null,t):ol(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Ma(e.outlet.component,i)):t.canDeactivateChecks.push(new Ma(null,i)):t.canDeactivateChecks.push(new Ma(null,i))}function El(n){return typeof n=="function"}function U4(n){return typeof n=="boolean"}function B4(n){return n&&El(n.canLoad)}function $4(n){return n&&El(n.canActivate)}function q4(n){return n&&El(n.canActivateChild)}function H4(n){return n&&El(n.canDeactivate)}function G4(n){return n&&El(n.canMatch)}function oP(n){return n instanceof Qr||n?.name==="EmptyError"}var Ap=Symbol("INITIAL_VALUE");function Oa(){return He(n=>Ec(n.map(e=>e.pipe(Yr(1),Os(Ap)))).pipe(Q(e=>{for(let t of e)if(t!==!0){if(t===Ap)return Ap;if(t===!1||t instanceof Bi)return t}return!0}),Ct(e=>e!==Ap),Yr(1)))}function z4(n,e){return ft(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?Z(xe(G({},t),{guardsResult:!0})):W4(o,r,i,n).pipe(ft(a=>a&&U4(a)?K4(r,s,n,e):Z(a)),Q(a=>xe(G({},t),{guardsResult:a})))})}function W4(n,e,t,r){return Ce(n).pipe(ft(i=>X4(i.component,i.route,t,e,r)),vn(i=>i!==!0,!0))}function K4(n,e,t,r){return Ce(e).pipe(Ai(i=>ta(Y4(i.route.parent,r),Q4(i.route,r),J4(n,i.path,t),Z4(n,i.route,t))),vn(i=>i!==!0,!0))}function Q4(n,e){return n!==null&&e&&e(new yE(n)),Z(!0)}function Y4(n,e){return n!==null&&e&&e(new gE(n)),Z(!0)}function Z4(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return Z(!0);let i=r.map(s=>nf(()=>{let o=wl(e)??t,a=Fa(s,o),u=$4(a)?a.canActivate(e,n):Ir(o,()=>a(e,n));return Hi(u).pipe(vn())}));return Z(i).pipe(Oa())}function J4(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>V4(o)).filter(o=>o!==null).map(o=>nf(()=>{let a=o.guards.map(u=>{let l=wl(o.node)??t,d=Fa(u,l),h=q4(d)?d.canActivateChild(r,n):Ir(l,()=>d(r,n));return Hi(h).pipe(vn())});return Z(a).pipe(Oa())}));return Z(s).pipe(Oa())}function X4(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return Z(!0);let o=s.map(a=>{let u=wl(e)??i,l=Fa(a,u),d=H4(l)?l.canDeactivate(n,e,t,r):Ir(u,()=>l(n,e,t,r));return Hi(d).pipe(vn())});return Z(o).pipe(Oa())}function eG(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return Z(!0);let s=i.map(o=>{let a=Fa(o,n),u=B4(a)?a.canLoad(e,t):Ir(n,()=>a(e,t));return Hi(u)});return Z(s).pipe(Oa(),aP(r))}function aP(n){return E_(ot(e=>{if(Pa(e))throw rP(n,e)}),Q(e=>e===!0))}function tG(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return Z(!0);let s=i.map(o=>{let a=Fa(o,n),u=G4(a)?a.canMatch(e,t):Ir(n,()=>a(e,t));return Hi(u)});return Z(s).pipe(Oa(),aP(r))}var pl=class{constructor(e){this.segmentGroup=e||null}},Up=class extends Error{constructor(e){super(),this.urlTree=e}};function Sa(n){return ea(new pl(n))}function nG(n){return ea(new ee(4e3,!1))}function rG(n){return ea(iP(!1,bn.GuardRejected))}var TE=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return Z(r);if(i.numberOfChildren>1||!i.children[fe])return nG(e.redirectTo);i=i.children[fe]}}applyRedirectCommands(e,t,r){let i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t.startsWith("/"))throw new Up(i);return i}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new Bi(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,u])=>{o[a]=this.createSegmentGroup(e,u,r,i)}),new Pe(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new ee(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},bE={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function iG(n,e,t,r,i){let s=PE(n,e,t);return s.matched?(r=P4(e,r),tG(r,e,t,i).pipe(Q(o=>o===!0?s:G({},bE)))):Z(s)}function PE(n,e,t){if(e.path==="**")return sG(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?G({},bE):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||t4)(t,n,e);if(!i)return G({},bE);let s={};Object.entries(i.posParams??{}).forEach(([a,u])=>{s[a]=u.path});let o=i.consumed.length>0?G(G({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function sG(n){return{matched:!0,parameters:n.length>0?UN(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function FN(n,e,t,r){return t.length>0&&uG(n,t,r)?{segmentGroup:new Pe(e,aG(r,new Pe(t,n.children))),slicedSegments:[]}:t.length===0&&cG(n,t,r)?{segmentGroup:new Pe(n.segments,oG(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new Pe(n.segments,n.children),slicedSegments:t}}function oG(n,e,t,r){let i={};for(let s of t)if(qp(n,e,s)&&!r[Sr(s)]){let o=new Pe([],{});i[Sr(s)]=o}return G(G({},r),i)}function aG(n,e){let t={};t[fe]=e;for(let r of n)if(r.path===""&&Sr(r)!==fe){let i=new Pe([],{});t[Sr(r)]=i}return t}function uG(n,e,t){return t.some(r=>qp(n,e,r)&&Sr(r)!==fe)}function cG(n,e,t){return t.some(r=>qp(n,e,r))}function qp(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function lG(n,e,t,r){return Sr(n)!==r&&(r===fe||!qp(e,t,n))?!1:PE(e,n,t).matched}function dG(n,e,t){return e.length===0&&!n.children[t]}var AE=class{};function hG(n,e,t,r,i,s,o="emptyOnly"){return new SE(n,e,t,r,i,o,s).recognize()}var fG=31,SE=class{constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new TE(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new ee(4002,`'${e.segmentGroup}'`)}recognize(){let e=FN(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Q(t=>{let r=new hl([],Object.freeze({}),Object.freeze(G({},this.urlTree.queryParams)),this.urlTree.fragment,{},fe,this.rootComponentType,null,{}),i=new Tn(r,t),s=new Lp("",i),o=w4(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,fe).pipe(bi(r=>{if(r instanceof Up)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof pl?this.noMatchError(r):r}))}inheritParamsAndData(e,t){let r=e.value,i=xE(r,t,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,t,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0).pipe(Q(s=>s instanceof Tn?[s]:[]))}processChildren(e,t,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return Ce(i).pipe(Ai(s=>{let o=r.children[s],a=k4(t,s);return this.processSegmentGroup(e,a,o,s)}),yr((s,o)=>(s.push(...o),s)),Si(null),x_(),ft(s=>{if(s===null)return Sa(r);let o=uP(s);return pG(o),Z(o)}))}processSegment(e,t,r,i,s,o){return Ce(t).pipe(Ai(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,r,i,s,o).pipe(bi(u=>{if(u instanceof pl)return Z(null);throw u}))),vn(a=>!!a),bi(a=>{if(oP(a))return dG(r,i,s)?Z(new AE):Sa(r);throw a}))}processSegmentAgainstRoute(e,t,r,i,s,o,a){return lG(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o):Sa(i):Sa(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o){let{matched:a,consumedSegments:u,positionalParamSegments:l,remainingSegments:d}=PE(t,i,s);if(!a)return Sa(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>fG&&(this.allowRedirects=!1));let h=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,h).pipe(ft(g=>this.processSegment(e,r,t,g.concat(d),o,!1)))}matchSegmentAgainstRoute(e,t,r,i,s){let o=iG(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),o.pipe(He(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(He(({routes:u})=>{let l=r._loadedInjector??e,{consumedSegments:d,remainingSegments:h,parameters:g}=a,y=new hl(d,g,Object.freeze(G({},this.urlTree.queryParams)),this.urlTree.fragment,mG(r),Sr(r),r.component??r._loadedComponent??null,r,yG(r)),{segmentGroup:v,slicedSegments:D}=FN(t,d,h,u);if(D.length===0&&v.hasChildren())return this.processChildren(l,u,v).pipe(Q(P=>P===null?null:new Tn(y,P)));if(u.length===0&&D.length===0)return Z(new Tn(y,[]));let A=Sr(r)===s;return this.processSegment(l,u,v,D,A?fe:s,!0).pipe(Q(P=>new Tn(y,P instanceof Tn?[P]:[])))}))):Sa(t)))}getChildConfig(e,t,r){return t.children?Z({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?Z({routes:t._loadedRoutes,injector:t._loadedInjector}):eG(e,t,r,this.urlSerializer).pipe(ft(i=>i?this.configLoader.loadChildren(e,t).pipe(ot(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):rG(t))):Z({routes:[],injector:e})}};function pG(n){n.sort((e,t)=>e.value.outlet===fe?-1:t.value.outlet===fe?1:e.value.outlet.localeCompare(t.value.outlet))}function gG(n){let e=n.value.routeConfig;return e&&e.path===""}function uP(n){let e=[],t=new Set;for(let r of n){if(!gG(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=uP(r.children);e.push(new Tn(r.value,i))}return e.filter(r=>!t.has(r))}function mG(n){return n.data||{}}function yG(n){return n.resolve||{}}function _G(n,e,t,r,i,s){return ft(o=>hG(n,e,t,r,o.extractedUrl,i,s).pipe(Q(({state:a,tree:u})=>xe(G({},o),{targetSnapshot:a,urlAfterRedirects:u}))))}function vG(n,e){return ft(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return Z(t);let s=new Set(i.map(u=>u.route)),o=new Set;for(let u of s)if(!o.has(u))for(let l of cP(u))o.add(l);let a=0;return Ce(o).pipe(Ai(u=>s.has(u)?wG(u,r,n,e):(u.data=xE(u,u.parent,n).resolve,Z(void 0))),ot(()=>a++),ia(1),ft(u=>a===o.size?Z(t):Zt))})}function cP(n){let e=n.children.map(t=>cP(t)).flat();return[n,...e]}function wG(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!tP(i)&&(s[ml]=i.title),EG(s,n,e,r).pipe(Q(o=>(n._resolvedData=o,n.data=xE(n,n.parent,t).resolve,null)))}function EG(n,e,t,r){let i=sE(n);if(i.length===0)return Z({});let s={};return Ce(i).pipe(ft(o=>IG(n[o],e,t,r).pipe(vn(),ot(a=>{s[o]=a}))),ia(1),R_(s),bi(o=>oP(o)?Zt:ea(o)))}function IG(n,e,t,r){let i=wl(e)??r,s=Fa(n,i),o=s.resolve?s.resolve(e,t):Ir(i,()=>s(e,t));return Hi(o)}function rE(n){return He(e=>{let t=n(e);return t?Ce(t).pipe(Q(()=>e)):Z(e)})}var lP=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===fe);return r}getResolvedTitleForRoute(t){return t.data[ml]}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:()=>j(CG),providedIn:"root"})}}return n})(),CG=(()=>{class n extends lP{constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static{this.\u0275fac=function(r){return new(r||n)(V(RN))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Il=new H("",{providedIn:"root",factory:()=>({})}),gl=new H(""),kE=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=j(_p)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Z(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=Hi(t.loadComponent()).pipe(Q(dP),ot(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),ra(()=>{this.componentLoaders.delete(t)})),i=new Qo(r,()=>new et).pipe(Ko());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Z({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let s=DG(r,this.compiler,t,this.onLoadEndListener).pipe(ra(()=>{this.childrenLoaders.delete(r)})),o=new Qo(s,()=>new et).pipe(Ko());return this.childrenLoaders.set(r,o),o}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function DG(n,e,t,r){return Hi(n.loadChildren()).pipe(Q(dP),ft(i=>i instanceof jc||Array.isArray(i)?Z(i):Ce(e.compileModuleAsync(i))),Q(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(t).injector,o=s.get(gl,[],{optional:!0,self:!0}).flat()),{routes:o.map(NE),injector:s}}))}function TG(n){return n&&typeof n=="object"&&"default"in n}function dP(n){return TG(n)?n.default:n}var OE=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:()=>j(bG),providedIn:"root"})}}return n})(),bG=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),hP=new H(""),fP=new H("");function AG(n,e,t){let r=n.get(fP),i=n.get(tn);return n.get(le).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(l=>setTimeout(l));let s,o=new Promise(l=>{s=l}),a=i.startViewTransition(()=>(s(),SG(n))),{onViewTransitionCreated:u}=r;return u&&Ir(n,()=>u({transition:a,from:e,to:t})),o})}function SG(n){return new Promise(e=>{cp(e,{injector:n})})}var FE=(()=>{class n{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new et,this.transitionAbortSubject=new et,this.configLoader=j(kE),this.environmentInjector=j(fn),this.urlSerializer=j(yl),this.rootContexts=j(_l),this.location=j(Aa),this.inputBindingEnabled=j($p,{optional:!0})!==null,this.titleStrategy=j(lP),this.options=j(Il,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=j(OE),this.createViewTransition=j(hP,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Z(void 0),this.rootComponentType=null;let t=i=>this.events.next(new fE(i)),r=i=>this.events.next(new pE(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(xe(G(G({},this.transitions.value),t),{id:r}))}setupNavigations(t,r,i){return this.transitions=new Mt({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:sl,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Ct(s=>s.id!==0),Q(s=>xe(G({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),He(s=>{let o=!1,a=!1;return Z(s).pipe(He(u=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",bn.SupersededByNewNavigation),Zt;this.currentTransition=s,this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?xe(G({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let l=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=u.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!l&&d!=="reload"){let h="";return this.events.next(new qi(u.id,this.urlSerializer.serialize(u.rawUrl),h,Pp.IgnoredSameUrlNavigation)),u.resolve(null),Zt}if(this.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return Z(u).pipe(He(h=>{let g=this.transitions?.getValue();return this.events.next(new ka(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),g!==this.transitions?.getValue()?Zt:Promise.resolve(h)}),_G(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),ot(h=>{s.targetSnapshot=h.targetSnapshot,s.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=xe(G({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let g=new kp(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(g)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){let{id:h,extractedUrl:g,source:y,restoredState:v,extras:D}=u,A=new ka(h,this.urlSerializer.serialize(g),y,v);this.events.next(A);let P=XN(this.rootComponentType).snapshot;return this.currentTransition=s=xe(G({},u),{targetSnapshot:P,urlAfterRedirects:g,extras:xe(G({},D),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=g,Z(s)}else{let h="";return this.events.next(new qi(u.id,this.urlSerializer.serialize(u.extractedUrl),h,Pp.IgnoredByUrlHandlingStrategy)),u.resolve(null),Zt}}),ot(u=>{let l=new cE(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(l)}),Q(u=>(this.currentTransition=s=xe(G({},u),{guards:F4(u.targetSnapshot,u.currentSnapshot,this.rootContexts)}),s)),z4(this.environmentInjector,u=>this.events.next(u)),ot(u=>{if(s.guardsResult=u.guardsResult,Pa(u.guardsResult))throw rP(this.urlSerializer,u.guardsResult);let l=new lE(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(l)}),Ct(u=>u.guardsResult?!0:(this.cancelNavigationTransition(u,"",bn.GuardRejected),!1)),rE(u=>{if(u.guards.canActivateChecks.length)return Z(u).pipe(ot(l=>{let d=new dE(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),He(l=>{let d=!1;return Z(l).pipe(vG(this.paramsInheritanceStrategy,this.environmentInjector),ot({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",bn.NoDataFromResolver)}}))}),ot(l=>{let d=new hE(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),rE(u=>{let l=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(ot(g=>{d.component=g}),Q(()=>{})));for(let g of d.children)h.push(...l(g));return h};return Ec(l(u.targetSnapshot.root)).pipe(Si(null),Yr(1))}),rE(()=>this.afterPreactivation()),He(()=>{let{currentSnapshot:u,targetSnapshot:l}=s,d=this.createViewTransition?.(this.environmentInjector,u.root,l.root);return d?Ce(d).pipe(Q(()=>s)):Z(s)}),Q(u=>{let l=S4(t.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=s=xe(G({},u),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,s}),ot(()=>{this.events.next(new ll)}),O4(this.rootContexts,t.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),Yr(1),ot({next:u=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new br(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),this.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{o=!0}}),P_(this.transitionAbortSubject.pipe(ot(u=>{throw u}))),ra(()=>{!o&&!a&&this.cancelNavigationTransition(s,"",bn.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),bi(u=>{if(a=!0,sP(u))this.events.next(new $i(s.id,this.urlSerializer.serialize(s.extractedUrl),u.message,u.cancellationCode)),M4(u)?this.events.next(new dl(u.url)):s.resolve(!1);else{this.events.next(new cl(s.id,this.urlSerializer.serialize(s.extractedUrl),u,s.targetSnapshot??void 0));try{s.resolve(t.errorHandler(u))}catch(l){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(l)}}return Zt}))}))}cancelNavigationTransition(t,r,i){let s=new $i(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function RG(n){return n!==sl}var xG=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:()=>j(MG),providedIn:"root"})}}return n})(),RE=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},MG=(()=>{class n extends RE{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=Wc(n)))(i||n)}})()}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),pP=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:()=>j(NG),providedIn:"root"})}}return n})(),NG=(()=>{class n extends pP{constructor(){super(...arguments),this.location=j(Aa),this.urlSerializer=j(yl),this.options=j(Il,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=j(OE),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Bi,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=XN(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&t(r.url,r.state)})}handleRouterEvent(t,r){if(t instanceof ka)this.stateMemento=this.createStateMemento();else if(t instanceof qi)this.rawUrlTree=r.initialUrl;else if(t instanceof kp){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(i,r)}}else t instanceof ll?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r))):t instanceof $i&&(t.code===bn.GuardRejected||t.code===bn.NoDataFromResolver)?this.restoreHistory(r):t instanceof cl?this.restoreHistory(r,!0):t instanceof br&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,r){let i=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let s=this.browserPageId,o=G(G({},r.extras.state),this.generateNgRouterState(r.id,s));this.location.replaceState(i,"",o)}else{let s=G(G({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",s)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&s===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=Wc(n)))(i||n)}})()}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),rl=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(rl||{});function gP(n,e){n.events.pipe(Ct(t=>t instanceof br||t instanceof $i||t instanceof cl||t instanceof qi),Q(t=>t instanceof br||t instanceof qi?rl.COMPLETE:(t instanceof $i?t.code===bn.Redirect||t.code===bn.SupersededByNewNavigation:!1)?rl.REDIRECTING:rl.FAILED),Ct(t=>t!==rl.REDIRECTING),Yr(1)).subscribe(()=>{e()})}function PG(n){throw n}var kG={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},OG={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},An=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=j(mp),this.stateManager=j(pP),this.options=j(Il,{optional:!0})||{},this.pendingTasks=j(Qc),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=j(FE),this.urlSerializer=j(yl),this.location=j(Aa),this.urlHandlingStrategy=j(OE),this._events=new et,this.errorHandler=this.options.errorHandler||PG,this.navigated=!1,this.routeReuseStrategy=j(xG),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=j(gl,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!j($p,{optional:!0}),this.eventsSubscription=new st,this.isNgZoneEnabled=j(le)instanceof le&&le.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof $i&&r.code!==bn.Redirect&&r.code!==bn.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof br)this.navigated=!0;else if(r instanceof dl){let o=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),a={info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||RG(i.source)};this.scheduleNavigation(o,sl,null,a,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}VG(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),sl,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",r)},0)})}navigateToSyncWithBrowser(t,r,i){let s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){let u=G({},i);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(s.state=u)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(NE),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:u}=r,l=u?this.currentUrlTree.fragment:o,d=null;switch(a){case"merge":d=G(G({},this.currentUrlTree.queryParams),s);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let g=i?i.snapshot:this.routerState.snapshot.root;h=QN(g)}catch{(typeof t[0]!="string"||!t[0].startsWith("/"))&&(t=[]),h=this.currentUrlTree.root}return YN(h,t,d,l??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=Pa(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,sl,null,r)}navigate(t,r={skipLocationChange:!1}){return FG(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=G({},kG):r===!1?i=G({},OG):i=r,Pa(t))return MN(this.currentUrlTree,t,i);let s=this.parseUrl(t);return MN(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(t,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,u,l;o?(a=o.resolve,u=o.reject,l=o.promise):l=new Promise((h,g)=>{a=h,u=g});let d=this.pendingTasks.add();return gP(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:u,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(h=>Promise.reject(h))}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function FG(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new ee(4008,!1)}function VG(n){return!(n instanceof ll)&&!(n instanceof dl)}var Va=(()=>{class n{constructor(t,r,i,s,o,a){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=s,this.el=o,this.locationStrategy=a,this.href=null,this.commands=null,this.onChanges=new et,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let u=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement=u==="a"||u==="area",this.isAnchorElement?this.subscription=t.events.subscribe(l=>{l instanceof br&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){t!=null?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,r,i,s,o){let a=this.urlTree;if(a===null||this.isAnchorElement&&(t!==0||r||i||s||o||typeof this.target=="string"&&this.target!="_self"))return!0;let u={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,u),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.href=t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t)):null;let r=this.href===null?null:eM(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",r)}applyAttributeValue(t,r){let i=this.renderer,s=this.el.nativeElement;r!==null?i.setAttribute(s,t,r):i.removeAttribute(s,t)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static{this.\u0275fac=function(r){return new(r||n)(De(An),De(Ar),uw("tabindex"),De(zs),De(Vi),De(ri))}}static{this.\u0275dir=Cn({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,i){r&1&&sr("click",function(o){return i.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),r&2&&hp("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[$t.HasDecoratorInputTransform,"preserveFragment","preserveFragment",ba],skipLocationChange:[$t.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",ba],replaceUrl:[$t.HasDecoratorInputTransform,"replaceUrl","replaceUrl",ba],routerLink:"routerLink"},standalone:!0,features:[Nw,Oi]})}}return n})();var Bp=class{};var LG=(()=>{class n{constructor(t,r,i,s,o){this.router=t,this.injector=i,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Ct(t=>t instanceof br),Ai(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){let i=[];for(let s of r){s.providers&&!s._injector&&(s._injector=dp(s.providers,t,`Route: ${s.path}`));let o=s._injector??t,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&s.canLoad===void 0||s.loadComponent&&!s._loadedComponent)&&i.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&i.push(this.processRoutes(a,s.children??s._loadedRoutes))}return Ce(i).pipe(Ti())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;r.loadChildren&&r.canLoad===void 0?i=this.loader.loadChildren(t,r):i=Z(null);let s=i.pipe(ft(o=>o===null?Z(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));if(r.loadComponent&&!r._loadedComponent){let o=this.loader.loadComponent(r);return Ce([s,o]).pipe(Ti())}else return s})}static{this.\u0275fac=function(r){return new(r||n)(V(An),V(_p),V(fn),V(Bp),V(kE))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),mP=new H(""),jG=(()=>{class n{constructor(t,r,i,s,o={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=i,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=j(fn),o.scrollPositionRestoration||="disabled",o.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof ka?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof br?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof qi&&t.code===Pp.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Op&&(t.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(t.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(()=>x(this,null,function*(){yield new Promise(i=>{setTimeout(()=>{i()}),cp(()=>{i()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new Op(t,this.lastSource==="popstate"?this.store[this.restoredId]:null,r))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function(r){dM()}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})();function yP(n,...e){return Xt([{provide:gl,multi:!0,useValue:n},[],{provide:Ar,useFactory:_P,deps:[An]},{provide:Ks,multi:!0,useFactory:vP},e.map(t=>t.\u0275providers)])}function _P(n){return n.routerState.root}function Cl(n,e){return{\u0275kind:n,\u0275providers:e}}function vP(){let n=j(Dt);return e=>{let t=n.get(Ui);if(e!==t.components[0])return;let r=n.get(An),i=n.get(wP);n.get(VE)===1&&r.initialNavigation(),n.get(EP,null,me.Optional)?.setUpPreloading(),n.get(mP,null,me.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var wP=new H("",{factory:()=>new et}),VE=new H("",{providedIn:"root",factory:()=>1});function UG(){return Cl(2,[{provide:VE,useValue:0},{provide:yp,multi:!0,deps:[Dt],useFactory:e=>{let t=e.get(aN,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=e.get(An),s=e.get(wP);gP(i,()=>{r(!0)}),e.get(FE).afterPreactivation=()=>(r(!0),s.closed?Z(void 0):s),i.initialNavigation()}))}}])}function BG(){return Cl(3,[{provide:yp,multi:!0,useFactory:()=>{let e=j(An);return()=>{e.setUpLocationChangeListener()}}},{provide:VE,useValue:2}])}var EP=new H("");function $G(n){return Cl(0,[{provide:EP,useExisting:LG},{provide:Bp,useExisting:n}])}function qG(){return Cl(8,[ON,{provide:$p,useExisting:ON}])}function HG(n){let e=[{provide:hP,useValue:AG},{provide:fP,useValue:G({skipNextTransition:!!n?.skipInitialTransition},n)}];return Cl(9,e)}var VN=new H("ROUTER_FORROOT_GUARD"),GG=[Aa,{provide:yl,useClass:al},An,_l,{provide:Ar,useFactory:_P,deps:[An]},kE,[]],La=(()=>{class n{constructor(t){}static forRoot(t,r){return{ngModule:n,providers:[GG,[],{provide:gl,multi:!0,useValue:t},{provide:VN,useFactory:QG,deps:[[An,new tt,new jR]]},{provide:Il,useValue:r||{}},r?.useHash?WG():KG(),zG(),r?.preloadingStrategy?$G(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?YG(r):[],r?.bindToComponentInputs?qG().\u0275providers:[],r?.enableViewTransitions?HG().\u0275providers:[],ZG()]}}static forChild(t){return{ngModule:n,providers:[{provide:gl,multi:!0,useValue:t}]}}static{this.\u0275fac=function(r){return new(r||n)(V(VN,8))}}static{this.\u0275mod=Gt({type:n})}static{this.\u0275inj=Ht({})}}return n})();function zG(){return{provide:mP,useFactory:()=>{let n=j(lN),e=j(le),t=j(Il),r=j(FE),i=j(yl);return t.scrollOffset&&n.setOffset(t.scrollOffset),new jG(i,r,n,e,t)}}}function WG(){return{provide:ri,useClass:cN}}function KG(){return{provide:ri,useClass:$w}}function QG(n){return"guarded"}function YG(n){return[n.initialNavigation==="disabled"?BG().\u0275providers:[],n.initialNavigation==="enabledBlocking"?UG().\u0275providers:[]]}var LN=new H("");function ZG(){return[{provide:LN,useFactory:vP},{provide:Ks,multi:!0,useExisting:LN}]}var IP=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Un({type:n,selectors:[["app-home"]],standalone:!0,features:[Hn],decls:2,vars:0,consts:[["type","button","routerLink","employee-list",1,"btn","btn-primary"]],template:function(r,i){r&1&&(Te(0,"button",0),ke(1,` Employee List
`),we())},dependencies:[Qs,La,Va]})}}return n})();var jE=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Un({type:n,selectors:[["app-employee-details"]],standalone:!0,features:[Hn],decls:2,vars:0,template:function(r,i){r&1&&(Te(0,"p"),ke(1,"employee-details works!"),we())}})}}return n})();var JG="firebase",XG="10.14.1";it(JG,XG,"app");var bt=new ei("ANGULARFIRE2_VERSION");function Ua(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Xs=(n,e)=>{let t=e?[e]:Nh(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},nn=class{constructor(){return Xs(ez)}},ez="app-check";function ja(){}var Hp=class{zone;delegate;constructor(e,t=T_){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,t,r)}},UE=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",ja,{},ja,ja)),t.pipe(ot({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},pn=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Hp(Zone.current)),this.insideAngular=t.run(()=>new Hp(Zone.current,ks)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(V(le))};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Gp(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function tz(n){return Gp().ngZone.runOutsideAngular(()=>n())}function Js(n){return Gp().ngZone.run(()=>n())}function nt(n){return nz(Gp())(n)}function nz(n){return function(t){return t=t.lift(new UE(n.ngZone)),t.pipe(Vn(n.outsideAngular),_n(n.insideAngular))}}var rz=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Js(()=>n.apply(void 0,r))},Gi=(n,e)=>function(){let t,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(t||=Js(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",ja,{},ja,ja))),r[s]=rz(r[s],t));let i=tz(()=>n.apply(this,r));if(!e)if(i instanceof ce){let s=Gp();return i.pipe(Vn(s.outsideAngular),_n(s.insideAngular))}else return Js(()=>i);return i instanceof ce?i.pipe(nt):i instanceof Promise?Js(()=>new Promise((s,o)=>i.then(a=>Js(()=>s(a)),a=>Js(()=>o(a))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:Js(()=>i)};var or=class{constructor(e){return e}},si=class{constructor(){return Nh()}};function iz(n){return n&&n.length===1?n[0]:new or(Rs())}var $E=new H("angularfire2._apps"),sz={provide:or,useFactory:iz,deps:[[new tt,$E]]},oz={provide:si,deps:[[new tt,$E]]};function az(n){return(e,t)=>{let r=t.get(at);it("angularfire",bt.full,"core"),it("angularfire",bt.full,"app"),it("angular",gp.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new or(i)}}function CP(n,...e){return Xt([sz,oz,{provide:$E,useFactory:az(n),multi:!0,deps:[le,Dt,pn,...e]}])}var DP=Gi(_S,!0);var uz=new Map,cz={activated:!1,tokenObservers:[]},lz={initialized:!1,enabled:!1};function ar(n){return uz.get(n)||Object.assign({},cz)}function RP(){return lz}var dz="https://content-firebaseappcheck.googleapis.com/v1";var hz="exchangeDebugToken",TP={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},fre=24*60*60*1e3;var HE=class{constructor(e,t,r,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return x(this,null,function*(){this.stop();try{this.pending=new It,this.pending.promise.catch(t=>{}),yield fz(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new It,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function fz(n){return new Promise(e=>{setTimeout(e,n)})}var pz={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},zi=new hS("appCheck","AppCheck",pz);function xP(n){if(!ar(n).activated)throw zi.create("use-before-activation",{appName:n.name})}function MP(r,i){return x(this,arguments,function*({url:n,body:e},t){let s={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});if(o){let y=yield o.getHeartbeatsHeader();y&&(s["X-Firebase-Client"]=y)}let a={method:"POST",body:JSON.stringify(e),headers:s},u;try{u=yield fetch(n,a)}catch(y){throw zi.create("fetch-network-error",{originalErrorMessage:y?.message})}if(u.status!==200)throw zi.create("fetch-status-error",{httpStatus:u.status});let l;try{l=yield u.json()}catch(y){throw zi.create("fetch-parse-error",{originalErrorMessage:y?.message})}let d=l.ttl.match(/^([\d.]+)(s)$/);if(!d||!d[2]||isNaN(Number(d[1])))throw zi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let h=Number(d[1])*1e3,g=Date.now();return{token:l.token,expireTimeMillis:g+h,issuedAtTimeMillis:g}})}function NP(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${dz}/projects/${t}/apps/${r}:${hz}?key=${i}`,body:{debug_token:e}}}var gz="firebase-app-check-database",mz=1,GE="firebase-app-check-store";var zp=null;function yz(){return zp||(zp=new Promise((n,e)=>{try{let t=indexedDB.open(gz,mz);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(zi.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(GE,{keyPath:"compositeKey"})}}}catch(t){e(zi.create("storage-open",{originalErrorMessage:t?.message}))}}),zp)}function _z(n,e){return vz(wz(n),e)}function vz(n,e){return x(this,null,function*(){let r=(yield yz()).transaction(GE,"readwrite"),s=r.objectStore(GE).put({compositeKey:n,value:e});return new Promise((o,a)=>{s.onsuccess=u=>{o()},r.onerror=u=>{var l;a(zi.create("storage-set",{originalErrorMessage:(l=u.target.error)===null||l===void 0?void 0:l.message}))}})})}function wz(n){return`${n.options.appId}-${n.name}`}var zE=new Di("@firebase/app-check");function qE(n,e){return Ah()?_z(n,e).catch(t=>{zE.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function PP(){return RP().enabled}function kP(){return x(this,null,function*(){let n=RP();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var Ez={error:"UNKNOWN_ERROR"};function Iz(n){return Dh.encodeString(JSON.stringify(n),!1)}function WE(n,e=!1){return x(this,null,function*(){let t=n.app;xP(t);let r=ar(t),i=r.token,s;if(i&&!Dl(i)&&(r.token=void 0,i=void 0),!i){let u=yield r.cachedTokenPromise;u&&(Dl(u)?i=u:yield qE(t,void 0))}if(!e&&i&&Dl(i))return{token:i.token};let o=!1;if(PP()){r.exchangeTokenPromise||(r.exchangeTokenPromise=MP(NP(t,yield kP()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let u=yield r.exchangeTokenPromise;return yield qE(t,u),r.token=u,{token:u.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield ar(t).exchangeTokenPromise}catch(u){u.code==="appCheck/throttled"?zE.warn(u.message):zE.error(u),s=u}let a;return i?s?Dl(i)?a={token:i.token,internalError:s}:a=AP(s):(a={token:i.token},r.token=i,yield qE(t,i)):a=AP(s),o&&bz(t,a),a})}function Cz(n){return x(this,null,function*(){let e=n.app;xP(e);let{provider:t}=ar(e);if(PP()){let r=yield kP(),{token:i}=yield MP(NP(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function Dz(n,e,t,r){let{app:i}=n,s=ar(i),o={next:t,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Dl(s.token)){let a=s.token;Promise.resolve().then(()=>{t({token:a.token}),bP(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>bP(n))}function OP(n,e){let t=ar(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function bP(n){let{app:e}=n,t=ar(e),r=t.tokenRefresher;r||(r=Tz(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function Tz(n){let{app:e}=n;return new HE(()=>x(this,null,function*(){let t=ar(e),r;if(t.token?r=yield WE(n,!0):r=yield WE(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=ar(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},TP.RETRIAL_MIN_WAIT,TP.RETRIAL_MAX_WAIT)}function bz(n,e){let t=ar(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Dl(n){return n.expireTimeMillis-Date.now()>0}function AP(n){return{token:Iz(Ez),error:n}}var KE=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=ar(this.app);for(let t of e)OP(this.app,t.next);return Promise.resolve()}};function Az(n,e){return new KE(n,e)}function Sz(n){return{getToken:e=>WE(n,e),getLimitedUseToken:()=>Cz(n),addTokenListener:e=>Dz(n,"INTERNAL",e),removeTokenListener:e=>OP(n.app,e)}}var Rz="@firebase/app-check",xz="0.8.8";var Mz="app-check",SP="app-check-internal";function Nz(){Ss(new yn(Mz,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return Az(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(SP).initialize()})),Ss(new yn(SP,n=>{let e=n.getProvider("app-check").getImmediate();return Sz(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),it(Rz,xz)}Nz();var Pz=["localhost","0.0.0.0","127.0.0.1"],Tre=typeof window<"u"&&Pz.includes(window.location.hostname);var kz="firebase",Oz="10.14.1";vt.registerVersion(kz,Oz,"app-compat");var Fz=["ngOnDestroy"],VP=(n,e,t,r={})=>new Proxy(n,{get:(i,s)=>t.runOutsideAngular(()=>{if(n[s])return r?.spy?.get&&r.spy.get(s,n[s]),n[s];if(Fz.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let u=a?.[s];return typeof u=="function"?u.bind(a):u?.then?u.then(l=>t.run(()=>l)):t.run(()=>u)});return new Proxy(()=>{},{get:(a,u)=>o[u],apply:(a,u,l)=>o.then(d=>{let h=d?.(...l);return r?.spy?.apply&&r.spy.apply(s,l,h),h})})})});var Wp=class{constructor(e){return e}},Wi=new H("angularfire2.app.options"),Ki=new H("angularfire2.app.name");function eo(n,e,t){let r=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||r;let o=vt.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>vt.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(o.options)){let a=!!module.hot;Vz("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Wp(o)}var Vz=(n,...e)=>{Vw()&&typeof console<"u"&&console[n](...e)},Lz={provide:Wp,useFactory:eo,deps:[Wi,le,[new tt,Ki]]},LP=(()=>{class n{static initializeApp(t,r){return{ngModule:n,providers:[{provide:Wi,useValue:t},{provide:Ki,useValue:r}]}}constructor(t){vt.registerVersion("angularfire",bt.full,"core"),vt.registerVersion("angularfire",bt.full,"app-compat"),vt.registerVersion("angular",gp.full,t.toString())}static \u0275fac=function(r){return new(r||n)(V(at))};static \u0275mod=Gt({type:n});static \u0275inj=Ht({providers:[Lz]})}return n})();function Ba(n,e,t,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(s)return jz(i,o)||(FP("error",`${e} was already initialized on the ${t} Firebase App with different settings.${Uz?" You may need to reload as Firebase is not HMR aware.":""}`),FP("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([n,a,i]),a}}function jz(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var Uz=typeof module<"u"&&!!module.hot,FP=(n,...e)=>{Vw()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var Tl=new H("angularfire2.auth.use-emulator"),bl=new H("angularfire2.auth.settings"),Al=new H("angularfire2.auth.tenant-id"),Sl=new H("angularfire2.auth.langugage-code"),Rl=new H("angularfire2.auth.use-device-language"),xl=new H("angularfire.auth.persistence"),Ml=(n,e,t,r,i,s,o,a)=>Ba(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let u=e.runOutsideAngular(()=>n.auth());if(t&&u.useEmulator(...t),r&&(u.tenantId=r),u.languageCode=i,s&&u.useDeviceLanguage(),o)for(let[l,d]of Object.entries(o))u.settings[l]=d;return a&&u.setPersistence(a),u},[t,r,i,s,o,a]),Nl=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,r,i,s,o,a,u,l,d,h,g,y){let v=new et,D=Z(void 0).pipe(_n(o.outsideAngular),He(()=>s.runOutsideAngular(()=>import("./chunk-EL3S5GG3.js"))),Q(()=>eo(t,s,r)),Q(A=>Ml(A,s,a,l,d,h,u,g)),sf({bufferSize:1,refCount:!1}));if(ii(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Z(null);else{D.pipe(vn()).subscribe();let A=D.pipe(He(F=>F.getRedirectResult().then(K=>K,()=>null)),nt,sf({bufferSize:1,refCount:!1})),P=D.pipe(He(F=>new ce(K=>({unsubscribe:s.runOutsideAngular(()=>F.onAuthStateChanged(te=>K.next(te),te=>K.error(te),()=>K.complete()))})))),B=D.pipe(He(F=>new ce(K=>({unsubscribe:s.runOutsideAngular(()=>F.onIdTokenChanged(te=>K.next(te),te=>K.error(te),()=>K.complete()))}))));this.authState=A.pipe(of(P),Vn(o.outsideAngular),_n(o.insideAngular)),this.user=A.pipe(of(B),Vn(o.outsideAngular),_n(o.insideAngular)),this.idToken=this.user.pipe(He(F=>F?Ce(F.getIdToken()):Z(null))),this.idTokenResult=this.user.pipe(He(F=>F?Ce(F.getIdTokenResult()):Z(null))),this.credential=na(A,v,this.authState.pipe(Ct(F=>!F))).pipe(Q(F=>F?.user?F:null),Vn(o.outsideAngular),_n(o.insideAngular))}return VP(this,D,s,{spy:{apply:(A,P,B)=>{(A.startsWith("signIn")||A.startsWith("createUser"))&&B.then(F=>v.next(F))}}})}static \u0275fac=function(r){return new(r||n)(V(Wi),V(Ki,8),V(at),V(le),V(pn),V(Tl,8),V(bl,8),V(Al,8),V(Sl,8),V(Rl,8),V(xl,8),V(nn,8))};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),jP=(()=>{class n{constructor(){vt.registerVersion("angularfire",bt.full,"auth-compat")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Gt({type:n});static \u0275inj=Ht({providers:[Nl]})}return n})();var BP="@firebase/database",$P="1.0.8";var aC="";function uC(n){aC=n}var rI=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ht(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Sh(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var iI=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return On(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var vk=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new rI(e)}}catch{}return new iI},no=vk("localStorage"),sI=vk("sessionStorage");var Ga=new Di("@firebase/database"),wk=function(){let n=1;return function(){return n++}}(),Ek=function(n){let e=yS(n),t=new mS;t.update(e);let r=t.digest();return Dh.encodeByteArray(r)},nd=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=nd.apply(null,r):typeof r=="object"?e+=ht(r):e+=r,e+=" "}return e},ro=null,qP=!0,Ik=function(n,e){L(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Ga.logLevel=Fn.VERBOSE,ro=Ga.log.bind(Ga),e&&sI.set("logging_enabled",!0)):typeof n=="function"?ro=n:(ro=null,sI.remove("logging_enabled"))},At=function(...n){if(qP===!0&&(qP=!1,ro===null&&sI.get("logging_enabled")===!0&&Ik(!0)),ro){let e=nd.apply(null,n);ro(e)}},rd=function(n){return function(...e){At(n,...e)}},oI=function(...n){let e="FIREBASE INTERNAL ERROR: "+nd(...n);Ga.error(e)},Mr=function(...n){let e=`FIREBASE FATAL ERROR: ${nd(...n)}`;throw Ga.error(e),new Error(e)},zt=function(...n){let e="FIREBASE WARNING: "+nd(...n);Ga.warn(e)},Bz=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&zt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Eg=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},$z=function(n){if(gr()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Ji="[MIN_NAME]",oi="[MAX_NAME]",so=function(n,e){if(n===e)return 0;if(n===Ji||e===oi)return-1;if(e===Ji||n===oi)return 1;{let t=HP(n),r=HP(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},qz=function(n,e){return n===e?0:n<e?-1:1},Pl=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+ht(e))},cC=function(n){if(typeof n!="object"||n===null)return ht(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=ht(e[r]),t+=":",t+=cC(n[e[r]]);return t+="}",t},Ck=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function St(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var Dk=function(n){L(!Eg(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,s,o,a,u;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));let l=[];for(u=t;u;u-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(u=e;u;u-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let d=l.join(""),h="";for(u=0;u<64;u+=8){let g=parseInt(d.substr(u,8),2).toString(16);g.length===1&&(g="0"+g),h=h+g}return h.toLowerCase()},Hz=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Gz=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function zz(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");let r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}var Wz=new RegExp("^-?(0*)\\d{1,10}$"),Kz=-2147483648,Qz=2147483647,HP=function(n){if(Wz.test(n)){let e=Number(n);if(e>=Kz&&e<=Qz)return e}return null},eu=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw zt("Exception was thrown by user callback.",t),e},Math.floor(0))}},Yz=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Vl=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var aI=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){zt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var uI=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(At("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',zt(e)}},Ll=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),Qp="5",Tk="v",bk="s",Ak="r",Sk="f",Rk=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,xk="ls",Mk="p",cI="ac",Nk="websocket",Pk="long_polling";var Yp=class{constructor(e,t,r,i,s=!1,o="",a=!1,u=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=no.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&no.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function Zz(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function kk(n,e,t){L(typeof e=="string","typeof type must == string"),L(typeof t=="object","typeof params must == object");let r;if(e===Nk)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===Pk)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Zz(n)&&(t.ns=n.namespace);let i=[];return St(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var lI=class{constructor(){this.counters_={}}incrementCounter(e,t=1){On(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return cS(this.counters_)}};var YE={},ZE={};function lC(n){let e=n.toString();return YE[e]||(YE[e]=new lI),YE[e]}function Jz(n,e){let t=n.toString();return ZE[t]||(ZE[t]=e()),ZE[t]}var dI=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&eu(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var GP="start",Xz="close",eW="pLPCommand",tW="pRTLPCB",Ok="id",Fk="pw",Vk="ser",nW="cb",rW="seg",iW="ts",sW="d",oW="dframe",Lk=1870,jk=30,aW=Lk-jk,uW=25e3,cW=3e4,$l=class n{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=rd(e),this.stats_=lC(t),this.urlFn=u=>(this.appCheckToken&&(u[cI]=this.appCheckToken),kk(t,Pk,u))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new dI(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(cW)),$z(()=>{if(this.isClosed_)return;this.scriptTagHolder=new hI((...s)=>{let[o,a,u,l,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===GP)this.id=a,this.password=u;else if(o===Xz)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[GP]="t",r[Vk]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[nW]=this.scriptTagHolder.uniqueCallbackIdentifier),r[Tk]=Qp,this.transportSessionId&&(r[bk]=this.transportSessionId),this.lastSessionId&&(r[xk]=this.lastSessionId),this.applicationId&&(r[Mk]=this.applicationId),this.appCheckToken&&(r[cI]=this.appCheckToken),typeof location<"u"&&location.hostname&&Rk.test(location.hostname)&&(r[Ak]=Sk);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return gr()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Hz()&&!Gz()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=ht(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=uS(t),i=Ck(r,aW);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(gr())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[oW]="t",r[Ok]=e,r[Fk]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=ht(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},hI=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,gr())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=wk(),window[eW+this.uniqueCallbackIdentifier]=e,window[tW+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){At("frame writing exception"),a.stack&&At(a.stack),At(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||At("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[Ok]=this.myID,e[Fk]=this.myPW,e[Vk]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+jk+r.length<=Lk;){let o=this.pendingSegs.shift();r=r+"&"+rW+i+"="+o.seg+"&"+iW+i+"="+o.ts+"&"+sW+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(uW)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){gr()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{At("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var lW=16384,dW=45e3,Zp=null;typeof MozWebSocket<"u"?Zp=MozWebSocket:typeof WebSocket<"u"&&(Zp=WebSocket);var qa=(()=>{class n{constructor(t,r,i,s,o,a,u){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=rd(this.connId),this.stats_=lC(r),this.connURL=n.connectionURL_(r,a,u,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){let a={};return a[Tk]=Qp,!gr()&&typeof location<"u"&&location.hostname&&Rk.test(location.hostname)&&(a[Ak]=Sk),r&&(a[bk]=r),i&&(a[xk]=i),s&&(a[cI]=s),o&&(a[Mk]=o),kk(t,Nk,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,no.set("previous_websocket_failure",!0);try{let i;if(gr()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Qp}/${aC}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Zp(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&Zp!==null&&!n.forceDisallow_}static previouslyFailed(){return no.isInMemoryStorage||no.get("previous_websocket_failure")===!0}markConnectionHealthy(){no.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=Sh(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(L(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=ht(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=Ck(r,lW);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(dW))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),Uk=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[$l,qa]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let r=qa&&qa.isAvailable(),i=r&&!qa.previouslyFailed();if(t.webSocketOnly&&(r||zt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[qa];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),hW=6e4,fW=5e3,pW=10*1024,gW=100*1024,JE="t",zP="d",mW="s",WP="r",yW="e",KP="o",QP="a",YP="n",ZP="p",_W="h",fI=class{constructor(e,t,r,i,s,o,a,u,l,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=u,this.onKill_=l,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=rd("c:"+this.id+":"),this.transportManager_=new Uk(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Vl(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>gW?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>pW?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(JE in e){let t=e[JE];t===QP?this.upgradeIfSecondaryHealthy_():t===WP?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===KP&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=Pl("t",e),r=Pl("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:ZP,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:QP,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:YP,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=Pl("t",e),r=Pl("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=Pl(JE,e);if(zP in e){let r=e[zP];if(t===_W){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===YP){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===mW?this.onConnectionShutdown_(r):t===WP?this.onReset_(r):t===yW?oI("Server Error: "+r):t===KP?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):oI("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Qp!==r&&zt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Vl(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(hW))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Vl(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(fW))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:ZP,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(no.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Jp=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var Xp=class{constructor(e){this.allowedEvents_=e,this.listeners_={},L(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){L(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var eg=class n extends Xp{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!o_()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new n}getInitialEvent(e){return L(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var JP=32,XP=768,Ne=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function Me(){return new Ne("")}function pe(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Xi(n){return n.pieces_.length-n.pieceNum_}function je(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Ne(n.pieces_,e)}function dC(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function vW(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function ql(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function Bk(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Ne(e,0)}function We(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof Ne)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new Ne(t,0)}function ge(n){return n.pieceNum_>=n.pieces_.length}function rn(n,e){let t=pe(n),r=pe(e);if(t===null)return e;if(t===r)return rn(je(n),je(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function wW(n,e){let t=ql(n,0),r=ql(e,0);for(let i=0;i<t.length&&i<r.length;i++){let s=so(t[i],r[i]);if(s!==0)return s}return t.length===r.length?0:t.length<r.length?-1:1}function hC(n,e){if(Xi(n)!==Xi(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function zn(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Xi(n)>Xi(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var pI=class{constructor(e,t){this.errorPrefix_=t,this.parts_=ql(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=yc(this.parts_[r]);$k(this)}};function EW(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=yc(e),$k(n)}function IW(n){let e=n.parts_.pop();n.byteLength_-=yc(e),n.parts_.length>0&&(n.byteLength_-=1)}function $k(n){if(n.byteLength_>XP)throw new Error(n.errorPrefix_+"has a key path longer than "+XP+" bytes ("+n.byteLength_+").");if(n.parts_.length>JP)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+JP+") or object contains a cycle "+to(n))}function to(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var gI=class n extends Xp{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new n}getInitialEvent(e){return L(e==="visible","Unknown event type: "+e),[this.visible_]}};var kl=1e3,CW=60*5*1e3,ek=30*1e3,DW=1.3,TW=3e4,bW="server_kill",tk=3,fC=(()=>{class n extends Jp{constructor(t,r,i,s,o,a,u,l){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=u,this.authOverride_=l,this.id=n.nextPersistentConnectionId_++,this.log_=rd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=kl,this.maxReconnectDelay_=CW,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!gr())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");gI.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&eg.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_(ht(o)),L(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();let r=new It,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let u=a.d;a.s==="ok"?r.resolve(u):r.reject(u)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(t,r,i,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),L(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),L(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let u={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,u),this.connected_&&this.sendListen_(u)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,u=>{let l=u.d,d=u.s;n.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",u),d!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(d,l))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&On(t,"w")){let i=Ci(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();zt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||pS(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=ek)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=fS(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),L(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);let o={p:t},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let u=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(u):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+ht(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):oI("Unrecognized action received from server: "+ht(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){L(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=kl,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=kl,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>TW&&(this.reconnectDelay_=kl),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*DW)}this.onConnectStatus_(!1)}establishConnection_(){return x(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,a=!1,u=null,l=function(){u?u.close():(a=!0,i())},d=function(g){L(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(g)};this.realtime_={close:l,sendRequest:d};let h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[g,y]=yield Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);a?At("getToken() completed but was canceled"):(At("getToken() completed. Creating connection."),this.authToken_=g&&g.accessToken,this.appCheckToken_=y&&y.token,u=new fI(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,v=>{zt(v+" ("+this.repoInfo_.toString()+")"),this.interrupt(bW)},o))}catch(g){this.log_("Failed to get token: "+g),a||(this.repoInfo_.nodeAdmin&&zt(g),l())}}})}interrupt(t){At("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){At("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Rh(this.interruptReasons_)&&(this.reconnectDelay_=kl,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(o=>cC(o)).join("$"):i="default";let s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){let i=new Ne(t).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){At("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=tk&&(this.reconnectDelay_=ek,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){At("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=tk&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";gr()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+aC.replace(/\./g,"-")]=1,o_()?t["framework.cordova"]=1:lS()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=eg.getInstance().currentlyOnline();return Rh(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),ye=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var za=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new ye(Ji,e),i=new ye(Ji,t);return this.compare(r,i)!==0}minPost(){return ye.MIN}};var Kp,tg=class extends za{static get __EMPTY_NODE(){return Kp}static set __EMPTY_NODE(e){Kp=e}compare(e,t){return so(e.name,t.name)}isDefinedOn(e){throw qo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return ye.MIN}maxPost(){return new ye(oi,Kp)}makePost(e,t){return L(typeof e=="string","KeyIndex indexValue must always be a string."),new ye(e,Kp)}toString(){return".key"}},xr=new tg;var Ha=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},ur=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??Wn.EMPTY_NODE,this.right=o??Wn.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Wn.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return Wn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),mI=class{copy(e,t,r,i,s){return this}insert(e,t,r){return new ur(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Wn=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,ur.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,ur.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ha(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Ha(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Ha(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Ha(this.root_,null,this.comparator_,!0,e)}};Wn.EMPTY_NODE=new mI;function AW(n,e){return so(n.name,e.name)}function pC(n,e){return so(n,e)}var yI;function SW(n){yI=n}var qk=function(n){return typeof n=="number"?"number:"+Dk(n):"string:"+n},Hk=function(n){if(n.isLeafNode()){let e=n.val();L(typeof e=="string"||typeof e=="number"||typeof e=="object"&&On(e,".sv"),"Priority must be a string or number.")}else L(n===yI||n.isEmpty(),"priority of unexpected type.");L(n===yI||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var nk,Wa=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,L(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Hk(this.priorityNode_)}static set __childrenNodeConstructor(t){nk=t}static get __childrenNodeConstructor(){return nk}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return ge(t)?this:pe(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=pe(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(L(i!==".priority"||Xi(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(je(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+qk(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=Dk(this.value_):t+=this.value_,this.lazyHash_=Ek(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(L(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return L(s>=0,"Unknown leaf type: "+r),L(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),Gk,zk;function RW(n){Gk=n}function xW(n){zk=n}var _I=class extends za{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?so(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return ye.MIN}maxPost(){return new ye(oi,new Wa("[PRIORITY-POST]",zk))}makePost(e,t){let r=Gk(e);return new ye(t,new Wa("[PRIORITY-POST]",r))}toString(){return".priority"}},Be=new _I;var MW=Math.log(2),vI=class{constructor(e){let t=s=>parseInt(Math.log(s)/MW,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},ng=function(n,e,t,r){n.sort(e);let i=function(u,l){let d=l-u,h,g;if(d===0)return null;if(d===1)return h=n[u],g=t?t(h):h,new ur(g,h.node,ur.BLACK,null,null);{let y=parseInt(d/2,10)+u,v=i(u,y),D=i(y+1,l);return h=n[y],g=t?t(h):h,new ur(g,h.node,ur.BLACK,v,D)}},s=function(u){let l=null,d=null,h=n.length,g=function(v,D){let A=h-v,P=h;h-=v;let B=i(A+1,P),F=n[A],K=t?t(F):F;y(new ur(K,F.node,D,null,B))},y=function(v){l?(l.left=v,l=v):(d=v,l=v)};for(let v=0;v<u.count;++v){let D=u.nextBitIsOne(),A=Math.pow(2,u.count-(v+1));D?g(A,ur.BLACK):(g(A,ur.BLACK),g(A,ur.RED))}return d},o=new vI(n.length),a=s(o);return new Wn(r||e,a)};var XE,$a={},Ka=class n{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return L($a&&Be,"ChildrenNode.ts has not been loaded"),XE=XE||new n({".priority":$a},{".priority":Be}),XE}get(e){let t=Ci(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Wn?t:null}hasIndex(e){return On(this.indexSet_,e.toString())}addIndex(e,t){L(e!==xr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(ye.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=ng(r,e.getCompare()):a=$a;let u=e.toString(),l=Object.assign({},this.indexSet_);l[u]=e;let d=Object.assign({},this.indexes_);return d[u]=a,new n(d,l)}addToIndexes(e,t){let r=mc(this.indexes_,(i,s)=>{let o=Ci(this.indexSet_,s);if(L(o,"Missing index implementation for "+s),i===$a)if(o.isDefinedOn(e.node)){let a=[],u=t.getIterator(ye.Wrap),l=u.getNext();for(;l;)l.name!==e.name&&a.push(l),l=u.getNext();return a.push(e),ng(a,o.getCompare())}else return $a;else{let a=t.get(e.name),u=i;return a&&(u=u.remove(new ye(e.name,a))),u.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=mc(this.indexes_,i=>{if(i===$a)return i;{let s=t.get(e.name);return s?i.remove(new ye(e.name,s)):i}});return new n(r,this.indexSet_)}};var Ol,ue=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&Hk(this.priorityNode_),this.children_.isEmpty()&&L(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Ol||(Ol=new n(new Wn(pC),null,Ka.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ol}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?Ol:r}}getChild(t){let r=pe(t);return r===null?this:this.getImmediateChild(r).getChild(je(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(L(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new ye(t,r),s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Ol:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){let i=pe(t);if(i===null)return r;{L(pe(t)!==".priority"||Xi(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(je(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Be,(a,u)=>{r[a]=u.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){let a=[];for(let u in r)a[u]=r[u];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+qk(this.getPriority().val())+":"),this.forEachChild(Be,(r,i)=>{let s=i.hash();s!==""&&(t+=":"+r+":"+s)}),this.lazyHash_=t===""?"":Ek(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new ye(t,r));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new ye(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new ye(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,ye.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,ye.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===id?-1:0}withIndex(t){if(t===xr||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===xr||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Be),s=r.getIterator(Be),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===xr?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),wI=class extends ue{constructor(){super(new Wn(pC),ue.EMPTY_NODE,Ka.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ue.EMPTY_NODE}isEmpty(){return!1}},id=new wI;Object.defineProperties(ye,{MIN:{value:new ye(Ji,ue.EMPTY_NODE)},MAX:{value:new ye(oi,id)}});tg.__EMPTY_NODE=ue.EMPTY_NODE;Wa.__childrenNodeConstructor=ue;SW(id);xW(id);var NW=!0;function Ye(n,e=null){if(n===null)return ue.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),L(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new Wa(t,Ye(e))}if(!(n instanceof Array)&&NW){let t=[],r=!1;if(St(n,(o,a)=>{if(o.substring(0,1)!=="."){let u=Ye(a);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),t.push(new ye(o,u)))}}),t.length===0)return ue.EMPTY_NODE;let s=ng(t,AW,o=>o.name,pC);if(r){let o=ng(t,Be.getCompare());return new ue(s,Ye(e),new Ka({".priority":o},{".priority":Be}))}else return new ue(s,Ye(e),Ka.Default)}else{let t=ue.EMPTY_NODE;return St(n,(r,i)=>{if(On(n,r)&&r.substring(0,1)!=="."){let s=Ye(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(Ye(e))}}RW(Ye);var Hl=class extends za{constructor(e){super(),this.indexPath_=e,L(!ge(e)&&pe(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?so(e.name,t.name):s}makePost(e,t){let r=Ye(e),i=ue.EMPTY_NODE.updateChild(this.indexPath_,r);return new ye(t,i)}maxPost(){let e=ue.EMPTY_NODE.updateChild(this.indexPath_,id);return new ye(oi,e)}toString(){return ql(this.indexPath_,0).join("/")}};var EI=class extends za{compare(e,t){let r=e.node.compareTo(t.node);return r===0?so(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return ye.MIN}maxPost(){return ye.MAX}makePost(e,t){let r=Ye(e);return new ye(t,r)}toString(){return".value"}},gC=new EI;function Wk(n){return{type:"value",snapshotNode:n}}function Qa(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Gl(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function zl(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function PW(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var Wl=class{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){L(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(Gl(t,a)):L(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Qa(t,r)):o.trackChildChange(zl(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Be,(i,s)=>{t.hasChild(i)||r.trackChildChange(Gl(i,s))}),t.isLeafNode()||t.forEachChild(Be,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(zl(i,s,o))}else r.trackChildChange(Qa(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?ue.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var rg=class n{constructor(e){this.indexedFilter_=new Wl(e.getIndex()),this.index_=e.getIndex(),this.startPost_=n.getStartPost_(e),this.endPost_=n.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new ye(t,r))||(r=ue.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=ue.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(ue.EMPTY_NODE);let s=this;return t.forEachChild(Be,(o,a)=>{s.matches(new ye(o,a))||(i=i.updateImmediateChild(o,ue.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}};var II=class{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{let r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new rg(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new ye(t,r))||(r=ue.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=ue.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=ue.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(ue.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,ue.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){let h=this.index_.getCompare();o=(g,y)=>h(y,g)}else o=this.index_.getCompare();let a=e;L(a.numChildren()===this.limit_,"");let u=new ye(t,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(u);if(a.hasChild(t)){let h=a.getImmediateChild(t),g=i.getChildAfterChild(this.index_,l,this.reverse_);for(;g!=null&&(g.name===t||a.hasChild(g.name));)g=i.getChildAfterChild(this.index_,g,this.reverse_);let y=g==null?1:o(g,u);if(d&&!r.isEmpty()&&y>=0)return s?.trackChildChange(zl(t,r,h)),a.updateImmediateChild(t,r);{s?.trackChildChange(Gl(t,h));let D=a.updateImmediateChild(t,ue.EMPTY_NODE);return g!=null&&this.rangedFilter_.matches(g)?(s?.trackChildChange(Qa(g.name,g.node)),D.updateImmediateChild(g.name,g.node)):D}}else return r.isEmpty()?e:d&&o(l,u)>=0?(s!=null&&(s.trackChildChange(Gl(l.name,l.node)),s.trackChildChange(Qa(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(l.name,ue.EMPTY_NODE)):e}};var Kl=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Be}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return L(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return L(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ji}hasEnd(){return this.endSet_}getIndexEndValue(){return L(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return L(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:oi}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return L(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Be}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function kW(n){return n.loadsAllData()?new Wl(n.getIndex()):n.hasLimit()?new II(n):new rg(n)}function OW(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function FW(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function CI(n,e,t){let r=n.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,t!=null?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function VW(n,e,t){let r;return n.index_===xr||t?r=CI(n,e,t):r=CI(n,e,oi),r.startAfterSet_=!0,r}function DI(n,e,t){let r=n.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,t!==void 0?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function LW(n,e,t){let r;return n.index_===xr||t?r=DI(n,e,t):r=DI(n,e,Ji),r.endBeforeSet_=!0,r}function Ig(n,e){let t=n.copy();return t.index_=e,t}function rk(n){let e={};if(n.isDefault())return e;let t;if(n.index_===Be?t="$priority":n.index_===gC?t="$value":n.index_===xr?t="$key":(L(n.index_ instanceof Hl,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=ht(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=ht(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+ht(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=ht(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+ht(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function ik(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Be&&(e.i=n.index_.toString()),e}var TI=class n extends Jp{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=rd("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(L(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,r),a={};this.listens_[o]=a;let u=rk(e._queryParams);this.restRequest_(s+".json",u,(l,d)=>{let h=d;if(l===404&&(h=null,l=null),l===null&&this.onDataUpdate_(s,h,!1,r),Ci(this.listens_,o)===a){let g;l?l===401?g="permission_denied":g="rest_error:"+l:g="ok",i(g,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=rk(e._queryParams),r=e._path.toString(),i=new It;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+gS(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let u=null;if(a.status>=200&&a.status<300){try{u=Sh(a.responseText)}catch{zt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,u)}else a.status!==401&&a.status!==404&&zt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var bI=class{constructor(){this.rootNode_=ue.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function ig(){return{value:null,children:new Map}}function tu(n,e,t){if(ge(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=pe(e);n.children.has(r)||n.children.set(r,ig());let i=n.children.get(r);e=je(e),tu(i,e,t)}}function AI(n,e){if(ge(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{let t=n.value;return n.value=null,t.forEachChild(Be,(r,i)=>{tu(n,new Ne(r),i)}),AI(n,e)}}else if(n.children.size>0){let t=pe(e);return e=je(e),n.children.has(t)&&AI(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function SI(n,e,t){n.value!==null?t(e,n.value):jW(n,(r,i)=>{let s=new Ne(e.toString()+"/"+r);SI(i,s,t)})}function jW(n,e){n.children.forEach((t,r)=>{e(r,t)})}var RI=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&St(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var sk=10*1e3,UW=30*1e3,BW=5*60*1e3,xI=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new RI(e);let r=sk+(UW-sk)*Math.random();Vl(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;St(e,(i,s)=>{s>0&&On(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),Vl(this.reportStats_.bind(this),Math.floor(Math.random()*2*BW))}};var Rr=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(Rr||{});function mC(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function yC(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function _C(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var MI=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Rr.ACK_USER_WRITE,this.source=mC()}operationForChild(e){if(ge(this.path)){if(this.affectedTree.value!=null)return L(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new Ne(e));return new n(Me(),t,this.revert)}}else return L(pe(this.path)===e,"operationForChild called for unrelated child."),new n(je(this.path),this.affectedTree,this.revert)}};var sg=class n{constructor(e,t){this.source=e,this.path=t,this.type=Rr.LISTEN_COMPLETE}operationForChild(e){return ge(this.path)?new n(this.source,Me()):new n(this.source,je(this.path))}};var Ya=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Rr.OVERWRITE}operationForChild(e){return ge(this.path)?new n(this.source,Me(),this.snap.getImmediateChild(e)):new n(this.source,je(this.path),this.snap)}};var Ql=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Rr.MERGE}operationForChild(e){if(ge(this.path)){let t=this.children.subtree(new Ne(e));return t.isEmpty()?null:t.value?new Ya(this.source,Me(),t.value):new n(this.source,Me(),t)}else return L(pe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,je(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Nr=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ge(e))return this.isFullyInitialized()&&!this.filtered_;let t=pe(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var NI=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function $W(n,e,t,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(PW(o.childName,o.snapshotNode))}),Fl(n,i,"child_removed",e,r,t),Fl(n,i,"child_added",e,r,t),Fl(n,i,"child_moved",s,r,t),Fl(n,i,"child_changed",e,r,t),Fl(n,i,"value",e,r,t),i}function Fl(n,e,t,r,i,s){let o=r.filter(a=>a.type===t);o.sort((a,u)=>HW(n,a,u)),o.forEach(a=>{let u=qW(n,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(u,n.query_))})})}function qW(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function HW(n,e,t){if(e.childName==null||t.childName==null)throw qo("Should only compare child_ events.");let r=new ye(e.childName,e.snapshotNode),i=new ye(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function Cg(n,e){return{eventCache:n,serverCache:e}}function jl(n,e,t,r){return Cg(new Nr(e,t,r),n.serverCache)}function Kk(n,e,t,r){return Cg(n.eventCache,new Nr(e,t,r))}function og(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function io(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var eI,GW=()=>(eI||(eI=new Wn(qz)),eI),sn=class n{constructor(e,t=GW()){this.value=e,this.children=t}static fromObject(e){let t=new n(null);return St(e,(r,i)=>{t=t.set(new Ne(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Me(),value:this.value};if(ge(e))return null;{let r=pe(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(je(e),t);return s!=null?{path:We(new Ne(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ge(e))return this;{let t=pe(e),r=this.children.get(t);return r!==null?r.subtree(je(e)):new n(null)}}set(e,t){if(ge(e))return new n(t,this.children);{let r=pe(e),s=(this.children.get(r)||new n(null)).set(je(e),t),o=this.children.insert(r,s);return new n(this.value,o)}}remove(e){if(ge(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=pe(e),r=this.children.get(t);if(r){let i=r.remove(je(e)),s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(ge(e))return this.value;{let t=pe(e),r=this.children.get(t);return r?r.get(je(e)):null}}setTree(e,t){if(ge(e))return t;{let r=pe(e),s=(this.children.get(r)||new n(null)).setTree(je(e),t),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new n(this.value,o)}}fold(e){return this.fold_(Me(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(We(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Me(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(ge(e))return null;{let s=pe(e),o=this.children.get(s);return o?o.findOnPath_(je(e),We(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Me(),t)}foreachOnPath_(e,t,r){if(ge(e))return this;{this.value&&r(t,this.value);let i=pe(e),s=this.children.get(i);return s?s.foreachOnPath_(je(e),We(t,i),r):new n(null)}}foreach(e){this.foreach_(Me(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(We(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var cr=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new sn(null))}};function Ul(n,e,t){if(ge(e))return new cr(new sn(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=rn(i,e);return s=s.updateChild(o,t),new cr(n.writeTree_.set(i,s))}else{let i=new sn(t),s=n.writeTree_.setTree(e,i);return new cr(s)}}}function PI(n,e,t){let r=n;return St(t,(i,s)=>{r=Ul(r,We(e,i),s)}),r}function ok(n,e){if(ge(e))return cr.empty();{let t=n.writeTree_.setTree(e,new sn(null));return new cr(t)}}function kI(n,e){return oo(n,e)!=null}function oo(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(rn(t.path,e)):null}function ak(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Be,(r,i)=>{e.push(new ye(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ye(r,i.value))}),e}function Yi(n,e){if(ge(e))return n;{let t=oo(n,e);return t!=null?new cr(new sn(t)):new cr(n.writeTree_.subtree(e))}}function OI(n){return n.writeTree_.isEmpty()}function Za(n,e){return Qk(Me(),n.writeTree_,e)}function Qk(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(L(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=Qk(We(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(We(n,".priority"),r)),t}}function Dg(n,e){return Xk(e,n)}function zW(n,e,t,r,i){L(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Ul(n.visibleWrites,e,t)),n.lastWriteId=r}function WW(n,e,t,r){L(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=PI(n.visibleWrites,e,t),n.lastWriteId=r}function KW(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function QW(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);L(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&YW(a,r.path)?i=!1:zn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return ZW(n),!0;if(r.snap)n.visibleWrites=ok(n.visibleWrites,r.path);else{let a=r.children;St(a,u=>{n.visibleWrites=ok(n.visibleWrites,We(r.path,u))})}return!0}else return!1}function YW(n,e){if(n.snap)return zn(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&zn(We(n.path,t),e))return!0;return!1}function ZW(n){n.visibleWrites=Yk(n.allWrites,JW,Me()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function JW(n){return n.visible}function Yk(n,e,t){let r=cr.empty();for(let i=0;i<n.length;++i){let s=n[i];if(e(s)){let o=s.path,a;if(s.snap)zn(t,o)?(a=rn(t,o),r=Ul(r,a,s.snap)):zn(o,t)&&(a=rn(o,t),r=Ul(r,Me(),s.snap.getChild(a)));else if(s.children){if(zn(t,o))a=rn(t,o),r=PI(r,a,s.children);else if(zn(o,t))if(a=rn(o,t),ge(a))r=PI(r,Me(),s.children);else{let u=Ci(s.children,pe(a));if(u){let l=u.getChild(je(a));r=Ul(r,Me(),l)}}}else throw qo("WriteRecord should have .snap or .children")}}return r}function Zk(n,e,t,r,i){if(!r&&!i){let s=oo(n.visibleWrites,e);if(s!=null)return s;{let o=Yi(n.visibleWrites,e);if(OI(o))return t;if(t==null&&!kI(o,Me()))return null;{let a=t||ue.EMPTY_NODE;return Za(o,a)}}}else{let s=Yi(n.visibleWrites,e);if(!i&&OI(s))return t;if(!i&&t==null&&!kI(s,Me()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(zn(l.path,e)||zn(e,l.path))},a=Yk(n.allWrites,o,e),u=t||ue.EMPTY_NODE;return Za(a,u)}}}function XW(n,e,t){let r=ue.EMPTY_NODE,i=oo(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Be,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){let s=Yi(n.visibleWrites,e);return t.forEachChild(Be,(o,a)=>{let u=Za(Yi(s,new Ne(o)),a);r=r.updateImmediateChild(o,u)}),ak(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=Yi(n.visibleWrites,e);return ak(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function e9(n,e,t,r,i){L(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=We(e,t);if(kI(n.visibleWrites,s))return null;{let o=Yi(n.visibleWrites,s);return OI(o)?i.getChild(t):Za(o,i.getChild(t))}}function t9(n,e,t,r){let i=We(e,t),s=oo(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){let o=Yi(n.visibleWrites,i);return Za(o,r.getNode().getImmediateChild(t))}else return null}function n9(n,e){return oo(n.visibleWrites,e)}function r9(n,e,t,r,i,s,o){let a,u=Yi(n.visibleWrites,e),l=oo(u,Me());if(l!=null)a=l;else if(t!=null)a=Za(u,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let d=[],h=o.getCompare(),g=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),y=g.getNext();for(;y&&d.length<i;)h(y,r)!==0&&d.push(y),y=g.getNext();return d}else return[]}function i9(){return{visibleWrites:cr.empty(),allWrites:[],lastWriteId:-1}}function ag(n,e,t,r){return Zk(n.writeTree,n.treePath,e,t,r)}function vC(n,e){return XW(n.writeTree,n.treePath,e)}function uk(n,e,t,r){return e9(n.writeTree,n.treePath,e,t,r)}function ug(n,e){return n9(n.writeTree,We(n.treePath,e))}function s9(n,e,t,r,i,s){return r9(n.writeTree,n.treePath,e,t,r,i,s)}function wC(n,e,t){return t9(n.writeTree,n.treePath,e,t)}function Jk(n,e){return Xk(We(n.treePath,e),n.writeTree)}function Xk(n,e){return{treePath:n,writeTree:e}}var FI=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;L(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),L(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,zl(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,Gl(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,Qa(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,zl(r,e.snapshotNode,i.oldSnap));else throw qo("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var VI=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},eO=new VI,Yl=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new Nr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return wC(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:io(this.viewCache_),s=s9(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}};function o9(n){return{filter:n}}function a9(n,e){L(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),L(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function u9(n,e,t,r,i){let s=new FI,o,a;if(t.type===Rr.OVERWRITE){let l=t;l.source.fromUser?o=LI(n,e,l.path,l.snap,r,i,s):(L(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!ge(l.path),o=cg(n,e,l.path,l.snap,r,i,a,s))}else if(t.type===Rr.MERGE){let l=t;l.source.fromUser?o=l9(n,e,l.path,l.children,r,i,s):(L(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=jI(n,e,l.path,l.children,r,i,a,s))}else if(t.type===Rr.ACK_USER_WRITE){let l=t;l.revert?o=f9(n,e,l.path,r,i,s):o=d9(n,e,l.path,l.affectedTree,r,i,s)}else if(t.type===Rr.LISTEN_COMPLETE)o=h9(n,e,t.path,r,s);else throw qo("Unknown operation type: "+t.type);let u=s.getChanges();return c9(e,o,u),{viewCache:o,changes:u}}function c9(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=og(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(Wk(og(e)))}}function tO(n,e,t,r,i,s){let o=e.eventCache;if(ug(r,t)!=null)return e;{let a,u;if(ge(t))if(L(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=io(e),d=l instanceof ue?l:ue.EMPTY_NODE,h=vC(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{let l=ag(r,io(e));a=n.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=pe(t);if(l===".priority"){L(Xi(t)===1,"Can't have a priority with additional path components");let d=o.getNode();u=e.serverCache.getNode();let h=uk(r,t,d,u);h!=null?a=n.filter.updatePriority(d,h):a=o.getNode()}else{let d=je(t),h;if(o.isCompleteForChild(l)){u=e.serverCache.getNode();let g=uk(r,t,o.getNode(),u);g!=null?h=o.getNode().getImmediateChild(l).updateChild(d,g):h=o.getNode().getImmediateChild(l)}else h=wC(r,l,e.serverCache);h!=null?a=n.filter.updateChild(o.getNode(),l,h,d,i,s):a=o.getNode()}}return jl(e,a,o.isFullyInitialized()||ge(t),n.filter.filtersNodes())}}function cg(n,e,t,r,i,s,o,a){let u=e.serverCache,l,d=o?n.filter:n.filter.getIndexedFilter();if(ge(t))l=d.updateFullNode(u.getNode(),r,null);else if(d.filtersNodes()&&!u.isFiltered()){let y=u.getNode().updateChild(t,r);l=d.updateFullNode(u.getNode(),y,null)}else{let y=pe(t);if(!u.isCompleteForPath(t)&&Xi(t)>1)return e;let v=je(t),A=u.getNode().getImmediateChild(y).updateChild(v,r);y===".priority"?l=d.updatePriority(u.getNode(),A):l=d.updateChild(u.getNode(),y,A,v,eO,null)}let h=Kk(e,l,u.isFullyInitialized()||ge(t),d.filtersNodes()),g=new Yl(i,h,s);return tO(n,h,t,i,g,a)}function LI(n,e,t,r,i,s,o){let a=e.eventCache,u,l,d=new Yl(i,e,s);if(ge(t))l=n.filter.updateFullNode(e.eventCache.getNode(),r,o),u=jl(e,l,!0,n.filter.filtersNodes());else{let h=pe(t);if(h===".priority")l=n.filter.updatePriority(e.eventCache.getNode(),r),u=jl(e,l,a.isFullyInitialized(),a.isFiltered());else{let g=je(t),y=a.getNode().getImmediateChild(h),v;if(ge(g))v=r;else{let D=d.getCompleteChild(h);D!=null?dC(g)===".priority"&&D.getChild(Bk(g)).isEmpty()?v=D:v=D.updateChild(g,r):v=ue.EMPTY_NODE}if(y.equals(v))u=e;else{let D=n.filter.updateChild(a.getNode(),h,v,g,d,o);u=jl(e,D,a.isFullyInitialized(),n.filter.filtersNodes())}}}return u}function ck(n,e){return n.eventCache.isCompleteForChild(e)}function l9(n,e,t,r,i,s,o){let a=e;return r.foreach((u,l)=>{let d=We(t,u);ck(e,pe(d))&&(a=LI(n,a,d,l,i,s,o))}),r.foreach((u,l)=>{let d=We(t,u);ck(e,pe(d))||(a=LI(n,a,d,l,i,s,o))}),a}function lk(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function jI(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u=e,l;ge(t)?l=r:l=new sn(null).setTree(t,r);let d=e.serverCache.getNode();return l.children.inorderTraversal((h,g)=>{if(d.hasChild(h)){let y=e.serverCache.getNode().getImmediateChild(h),v=lk(n,y,g);u=cg(n,u,new Ne(h),v,i,s,o,a)}}),l.children.inorderTraversal((h,g)=>{let y=!e.serverCache.isCompleteForChild(h)&&g.value===null;if(!d.hasChild(h)&&!y){let v=e.serverCache.getNode().getImmediateChild(h),D=lk(n,v,g);u=cg(n,u,new Ne(h),D,i,s,o,a)}}),u}function d9(n,e,t,r,i,s,o){if(ug(i,t)!=null)return e;let a=e.serverCache.isFiltered(),u=e.serverCache;if(r.value!=null){if(ge(t)&&u.isFullyInitialized()||u.isCompleteForPath(t))return cg(n,e,t,u.getNode().getChild(t),i,s,a,o);if(ge(t)){let l=new sn(null);return u.getNode().forEachChild(xr,(d,h)=>{l=l.set(new Ne(d),h)}),jI(n,e,t,l,i,s,a,o)}else return e}else{let l=new sn(null);return r.foreach((d,h)=>{let g=We(t,d);u.isCompleteForPath(g)&&(l=l.set(d,u.getNode().getChild(g)))}),jI(n,e,t,l,i,s,a,o)}}function h9(n,e,t,r,i){let s=e.serverCache,o=Kk(e,s.getNode(),s.isFullyInitialized()||ge(t),s.isFiltered());return tO(n,o,t,r,eO,i)}function f9(n,e,t,r,i,s){let o;if(ug(r,t)!=null)return e;{let a=new Yl(r,e,i),u=e.eventCache.getNode(),l;if(ge(t)||pe(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=ag(r,io(e));else{let h=e.serverCache.getNode();L(h instanceof ue,"serverChildren would be complete if leaf node"),d=vC(r,h)}d=d,l=n.filter.updateFullNode(u,d,s)}else{let d=pe(t),h=wC(r,d,e.serverCache);h==null&&e.serverCache.isCompleteForChild(d)&&(h=u.getImmediateChild(d)),h!=null?l=n.filter.updateChild(u,d,h,je(t),a,s):e.eventCache.getNode().hasChild(d)?l=n.filter.updateChild(u,d,ue.EMPTY_NODE,je(t),a,s):l=u,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=ag(r,io(e)),o.isLeafNode()&&(l=n.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||ug(r,Me())!=null,jl(e,l,o,n.filter.filtersNodes())}}var UI=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new Wl(r.getIndex()),s=kW(r);this.processor_=o9(s);let o=t.serverCache,a=t.eventCache,u=i.updateFullNode(ue.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(ue.EMPTY_NODE,a.getNode(),null),d=new Nr(u,o.isFullyInitialized(),i.filtersNodes()),h=new Nr(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Cg(h,d),this.eventGenerator_=new NI(this.query_)}get query(){return this.query_}};function p9(n){return n.viewCache_.serverCache.getNode()}function g9(n){return og(n.viewCache_)}function m9(n,e){let t=io(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!ge(e)&&!t.getImmediateChild(pe(e)).isEmpty())?t.getChild(e):null}function dk(n){return n.eventRegistrations_.length===0}function y9(n,e){n.eventRegistrations_.push(e)}function hk(n,e,t){let r=[];if(t){L(e==null,"A cancel should cancel all event registrations.");let i=n.query._path;n.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){let o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function fk(n,e,t,r){e.type===Rr.MERGE&&e.source.queryId!==null&&(L(io(n.viewCache_),"We should always have a full cache before handling merges"),L(og(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,s=u9(n.processor_,i,e,t,r);return a9(n.processor_,s.viewCache),L(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,nO(n,s.changes,s.viewCache.eventCache.getNode(),null)}function _9(n,e){let t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Be,(s,o)=>{r.push(Qa(s,o))}),t.isFullyInitialized()&&r.push(Wk(t.getNode())),nO(n,r,t.getNode(),e)}function nO(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return $W(n.eventGenerator_,e,t,i)}var lg,dg=class{constructor(){this.views=new Map}};function v9(n){L(!lg,"__referenceConstructor has already been defined"),lg=n}function w9(){return L(lg,"Reference.ts has not been loaded"),lg}function E9(n){return n.views.size===0}function EC(n,e,t,r){let i=e.source.queryId;if(i!==null){let s=n.views.get(i);return L(s!=null,"SyncTree gave us an op for an invalid query."),fk(s,e,t,r)}else{let s=[];for(let o of n.views.values())s=s.concat(fk(o,e,t,r));return s}}function rO(n,e,t,r,i){let s=e._queryIdentifier,o=n.views.get(s);if(!o){let a=ag(t,i?r:null),u=!1;a?u=!0:r instanceof ue?(a=vC(t,r),u=!1):(a=ue.EMPTY_NODE,u=!1);let l=Cg(new Nr(a,u,!1),new Nr(r,i,!1));return new UI(e,l)}return o}function I9(n,e,t,r,i,s){let o=rO(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),y9(o,t),_9(o,t)}function C9(n,e,t,r){let i=e._queryIdentifier,s=[],o=[],a=es(n);if(i==="default")for(let[u,l]of n.views.entries())o=o.concat(hk(l,t,r)),dk(l)&&(n.views.delete(u),l.query._queryParams.loadsAllData()||s.push(l.query));else{let u=n.views.get(i);u&&(o=o.concat(hk(u,t,r)),dk(u)&&(n.views.delete(i),u.query._queryParams.loadsAllData()||s.push(u.query)))}return a&&!es(n)&&s.push(new(w9())(e._repo,e._path)),{removed:s,events:o}}function iO(n){let e=[];for(let t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Zi(n,e){let t=null;for(let r of n.views.values())t=t||m9(r,e);return t}function sO(n,e){if(e._queryParams.loadsAllData())return Tg(n);{let r=e._queryIdentifier;return n.views.get(r)}}function oO(n,e){return sO(n,e)!=null}function es(n){return Tg(n)!=null}function Tg(n){for(let e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var hg;function D9(n){L(!hg,"__referenceConstructor has already been defined"),hg=n}function T9(){return L(hg,"Reference.ts has not been loaded"),hg}var b9=1,fg=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new sn(null),this.pendingWriteTree_=i9(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function IC(n,e,t,r,i){return zW(n.pendingWriteTree_,e,t,r,i),i?nu(n,new Ya(mC(),e,t)):[]}function A9(n,e,t,r){WW(n.pendingWriteTree_,e,t,r);let i=sn.fromObject(t);return nu(n,new Ql(mC(),e,i))}function Qi(n,e,t=!1){let r=KW(n.pendingWriteTree_,e);if(QW(n.pendingWriteTree_,e)){let s=new sn(null);return r.snap!=null?s=s.set(Me(),!0):St(r.children,o=>{s=s.set(new Ne(o),!0)}),nu(n,new MI(r.path,s,t))}else return[]}function sd(n,e,t){return nu(n,new Ya(yC(),e,t))}function S9(n,e,t){let r=sn.fromObject(t);return nu(n,new Ql(yC(),e,r))}function R9(n,e){return nu(n,new sg(yC(),e))}function x9(n,e,t){let r=CC(n,t);if(r){let i=DC(r),s=i.path,o=i.queryId,a=rn(s,e),u=new sg(_C(o),a);return TC(n,s,u)}else return[]}function pg(n,e,t,r,i=!1){let s=e._path,o=n.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||oO(o,e))){let u=C9(o,e,t,r);E9(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));let l=u.removed;if(a=u.events,!i){let d=l.findIndex(g=>g._queryParams.loadsAllData())!==-1,h=n.syncPointTree_.findOnPath(s,(g,y)=>es(y));if(d&&!h){let g=n.syncPointTree_.subtree(s);if(!g.isEmpty()){let y=P9(g);for(let v=0;v<y.length;++v){let D=y[v],A=D.query,P=lO(n,D);n.listenProvider_.startListening(Bl(A),Zl(n,A),P.hashFn,P.onComplete)}}}!h&&l.length>0&&!r&&(d?n.listenProvider_.stopListening(Bl(e),null):l.forEach(g=>{let y=n.queryToTagMap.get(Ag(g));n.listenProvider_.stopListening(Bl(g),y)}))}k9(n,l)}return a}function aO(n,e,t,r){let i=CC(n,r);if(i!=null){let s=DC(i),o=s.path,a=s.queryId,u=rn(o,e),l=new Ya(_C(a),u,t);return TC(n,o,l)}else return[]}function M9(n,e,t,r){let i=CC(n,r);if(i){let s=DC(i),o=s.path,a=s.queryId,u=rn(o,e),l=sn.fromObject(t),d=new Ql(_C(a),u,l);return TC(n,o,d)}else return[]}function BI(n,e,t,r=!1){let i=e._path,s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(g,y)=>{let v=rn(g,i);s=s||Zi(y,v),o=o||es(y)});let a=n.syncPointTree_.get(i);a?(o=o||es(a),s=s||Zi(a,Me())):(a=new dg,n.syncPointTree_=n.syncPointTree_.set(i,a));let u;s!=null?u=!0:(u=!1,s=ue.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((y,v)=>{let D=Zi(v,Me());D&&(s=s.updateImmediateChild(y,D))}));let l=oO(a,e);if(!l&&!e._queryParams.loadsAllData()){let g=Ag(e);L(!n.queryToTagMap.has(g),"View does not exist, but we have a tag");let y=O9();n.queryToTagMap.set(g,y),n.tagToQueryMap.set(y,g)}let d=Dg(n.pendingWriteTree_,i),h=I9(a,e,t,d,s,u);if(!l&&!o&&!r){let g=sO(a,e);h=h.concat(F9(n,e,g))}return h}function bg(n,e,t){let i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let u=rn(o,e),l=Zi(a,u);if(l)return l});return Zk(i,e,s,t,!0)}function N9(n,e){let t=e._path,r=null;n.syncPointTree_.foreachOnPath(t,(l,d)=>{let h=rn(l,t);r=r||Zi(d,h)});let i=n.syncPointTree_.get(t);i?r=r||Zi(i,Me()):(i=new dg,n.syncPointTree_=n.syncPointTree_.set(t,i));let s=r!=null,o=s?new Nr(r,!0,!1):null,a=Dg(n.pendingWriteTree_,e._path),u=rO(i,e,a,s?o.getNode():ue.EMPTY_NODE,s);return g9(u)}function nu(n,e){return uO(e,n.syncPointTree_,null,Dg(n.pendingWriteTree_,Me()))}function uO(n,e,t,r){if(ge(n.path))return cO(n,e,t,r);{let i=e.get(Me());t==null&&i!=null&&(t=Zi(i,Me()));let s=[],o=pe(n.path),a=n.operationForChild(o),u=e.children.get(o);if(u&&a){let l=t?t.getImmediateChild(o):null,d=Jk(r,o);s=s.concat(uO(a,u,l,d))}return i&&(s=s.concat(EC(i,n,r,t))),s}}function cO(n,e,t,r){let i=e.get(Me());t==null&&i!=null&&(t=Zi(i,Me()));let s=[];return e.children.inorderTraversal((o,a)=>{let u=t?t.getImmediateChild(o):null,l=Jk(r,o),d=n.operationForChild(o);d&&(s=s.concat(cO(d,a,u,l)))}),i&&(s=s.concat(EC(i,n,r,t))),s}function lO(n,e){let t=e.query,r=Zl(n,t);return{hashFn:()=>(p9(e)||ue.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?x9(n,t._path,r):R9(n,t._path);{let s=zz(i,t);return pg(n,t,null,s)}}}}function Zl(n,e){let t=Ag(e);return n.queryToTagMap.get(t)}function Ag(n){return n._path.toString()+"$"+n._queryIdentifier}function CC(n,e){return n.tagToQueryMap.get(e)}function DC(n){let e=n.indexOf("$");return L(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Ne(n.substr(0,e))}}function TC(n,e,t){let r=n.syncPointTree_.get(e);L(r,"Missing sync point for query tag that we're tracking");let i=Dg(n.pendingWriteTree_,e);return EC(r,t,i,null)}function P9(n){return n.fold((e,t,r)=>{if(t&&es(t))return[Tg(t)];{let i=[];return t&&(i=iO(t)),St(r,(s,o)=>{i=i.concat(o)}),i}})}function Bl(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(T9())(n._repo,n._path):n}function k9(n,e){for(let t=0;t<e.length;++t){let r=e[t];if(!r._queryParams.loadsAllData()){let i=Ag(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function O9(){return b9++}function F9(n,e,t){let r=e._path,i=Zl(n,e),s=lO(n,t),o=n.listenProvider_.startListening(Bl(e),i,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(r);if(i)L(!es(a.value),"If we're adding a query, it shouldn't be shadowed");else{let u=a.fold((l,d,h)=>{if(!ge(l)&&d&&es(d))return[Tg(d).query];{let g=[];return d&&(g=g.concat(iO(d).map(y=>y.query))),St(h,(y,v)=>{g=g.concat(v)}),g}});for(let l=0;l<u.length;++l){let d=u[l];n.listenProvider_.stopListening(Bl(d),Zl(n,d))}}return o}var $I=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},qI=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=We(this.path_,e);return new n(this.syncTree_,t)}node(){return bg(this.syncTree_,this.path_)}},V9=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},pk=function(n,e,t){if(!n||typeof n!="object")return n;if(L(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return L9(n[".sv"],e,t);if(typeof n[".sv"]=="object")return j9(n[".sv"],e);L(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},L9=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:L(!1,"Unexpected server value: "+n)}},j9=function(n,e,t){n.hasOwnProperty("increment")||L(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&L(!1,"Unexpected increment value: "+r);let i=e.node();if(L(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},dO=function(n,e,t,r){return AC(e,new qI(t,n),r)},bC=function(n,e,t){return AC(n,new $I(e),t)};function AC(n,e,t){let r=n.getPriority().val(),i=pk(r,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=pk(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new Wa(a,Ye(i)):n}else{let o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Wa(i))),o.forEachChild(Be,(a,u)=>{let l=AC(u,e.getImmediateChild(a),t);l!==u&&(s=s.updateImmediateChild(a,l))}),s}}var Jl=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function Sg(n,e){let t=e instanceof Ne?e:new Ne(e),r=n,i=pe(t);for(;i!==null;){let s=Ci(r.node.children,i)||{children:{},childCount:0};r=new Jl(i,r,s),t=je(t),i=pe(t)}return r}function ao(n){return n.node.value}function SC(n,e){n.node.value=e,HI(n)}function hO(n){return n.node.childCount>0}function U9(n){return ao(n)===void 0&&!hO(n)}function Rg(n,e){St(n.node.children,(t,r)=>{e(new Jl(t,n,r))})}function fO(n,e,t,r){t&&!r&&e(n),Rg(n,i=>{fO(i,e,!0,r)}),t&&r&&e(n)}function B9(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function od(n){return new Ne(n.parent===null?n.name:od(n.parent)+"/"+n.name)}function HI(n){n.parent!==null&&$9(n.parent,n.name,n)}function $9(n,e,t){let r=U9(t),i=On(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,HI(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,HI(n))}var q9=/[\[\].#$\/\u0000-\u001F\u007F]/,H9=/[\[\].#$\u0000-\u001F\u007F]/,tI=10*1024*1024,xg=function(n){return typeof n=="string"&&n.length!==0&&!q9.test(n)},pO=function(n){return typeof n=="string"&&n.length!==0&&!H9.test(n)},G9=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),pO(n)},Xl=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!Eg(n)||n&&typeof n=="object"&&On(n,".sv")},Pr=function(n,e,t,r){r&&e===void 0||ad(ln(n,"value"),e,t)},ad=function(n,e,t){let r=t instanceof Ne?new pI(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+to(r));if(typeof e=="function")throw new Error(n+"contains a function "+to(r)+" with contents = "+e.toString());if(Eg(e))throw new Error(n+"contains "+e.toString()+" "+to(r));if(typeof e=="string"&&e.length>tI/3&&yc(e)>tI)throw new Error(n+"contains a string greater than "+tI+" utf8 bytes "+to(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(St(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!xg(o)))throw new Error(n+" contains an invalid key ("+o+") "+to(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);EW(r,o),ad(n,a,r),IW(r)}),i&&s)throw new Error(n+' contains ".value" child '+to(r)+" in addition to actual children.")}},z9=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];let s=ql(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!xg(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(wW);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&zn(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},gO=function(n,e,t,r){if(r&&e===void 0)return;let i=ln(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];St(e,(o,a)=>{let u=new Ne(o);if(ad(i,a,We(t,u)),dC(u)===".priority"&&!Xl(a))throw new Error(i+"contains an invalid value for '"+u.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(u)}),z9(i,s)},RC=function(n,e,t){if(!(t&&e===void 0)){if(Eg(e))throw new Error(ln(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Xl(e))throw new Error(ln(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},ud=function(n,e,t,r){if(!(r&&t===void 0)&&!xg(t))throw new Error(ln(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},ru=function(n,e,t,r){if(!(r&&t===void 0)&&!pO(t))throw new Error(ln(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},W9=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),ru(n,e,t,r)},Sn=function(n,e){if(pe(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},mO=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!xg(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!G9(t))throw new Error(ln(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var GI=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Mg(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();t!==null&&!hC(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function yO(n,e,t){Mg(n,t),_O(n,r=>hC(r,e))}function Rn(n,e,t){Mg(n,t),_O(n,r=>zn(r,e)||zn(e,r))}function _O(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let s=i.path;e(s)?(K9(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function K9(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();ro&&At("event: "+t.toString()),eu(r)}}}var vO="repo_interrupt",Q9=25,zI=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new GI,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=ig(),this.transactionQueueTree_=new Jl,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function Y9(n,e,t){if(n.stats_=lC(n.repoInfo_),n.forceRestClient_||Yz())n.server_=new TI(n.repoInfo_,(r,i,s,o)=>{gk(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>mk(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ht(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new fC(n.repoInfo_,e,(r,i,s,o)=>{gk(n,r,i,s,o)},r=>{mk(n,r)},r=>{Z9(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=Jz(n.repoInfo_,()=>new xI(n.stats_,n.server_)),n.infoData_=new bI,n.infoSyncTree_=new fg({startListening:(r,i,s,o)=>{let a=[],u=n.infoData_.getNode(r._path);return u.isEmpty()||(a=sd(n.infoSyncTree_,r._path,u),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),xC(n,"connected",!1),n.serverSyncTree_=new fg({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,u)=>{let l=o(a,u);Rn(n.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function wO(n){let t=n.infoData_.getNode(new Ne(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function cd(n){return V9({timestamp:wO(n)})}function gk(n,e,t,r,i){n.dataUpdateCount++;let s=new Ne(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){let u=mc(t,l=>Ye(l));o=M9(n.serverSyncTree_,s,u,i)}else{let u=Ye(t);o=aO(n.serverSyncTree_,s,u,i)}else if(r){let u=mc(t,l=>Ye(l));o=S9(n.serverSyncTree_,s,u)}else{let u=Ye(t);o=sd(n.serverSyncTree_,s,u)}let a=s;o.length>0&&(a=Ja(n,s)),Rn(n.eventQueue_,a,o)}function mk(n,e){xC(n,"connected",e),e===!1&&e3(n)}function Z9(n,e){St(e,(t,r)=>{xC(n,t,r)})}function xC(n,e,t){let r=new Ne("/.info/"+e),i=Ye(t);n.infoData_.updateSnapshot(r,i);let s=sd(n.infoSyncTree_,r,i);Rn(n.eventQueue_,r,s)}function Ng(n){return n.nextWriteId_++}function J9(n,e,t){let r=N9(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(i=>{let s=Ye(i).withIndex(e._queryParams.getIndex());BI(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=sd(n.serverSyncTree_,e._path,s);else{let a=Zl(n.serverSyncTree_,e);o=aO(n.serverSyncTree_,e._path,s,a)}return Rn(n.eventQueue_,e._path,o),pg(n.serverSyncTree_,e,t,null,!0),s},i=>(iu(n,"get for query "+ht(e)+" failed: "+i),Promise.reject(new Error(i))))}function MC(n,e,t,r,i){iu(n,"set",{path:e.toString(),value:t,priority:r});let s=cd(n),o=Ye(t,r),a=bg(n.serverSyncTree_,e),u=bC(o,a,s),l=Ng(n),d=IC(n.serverSyncTree_,e,u,l,!0);Mg(n.eventQueue_,d),n.server_.put(e.toString(),o.val(!0),(g,y)=>{let v=g==="ok";v||zt("set at "+e+" failed: "+g);let D=Qi(n.serverSyncTree_,l,!v);Rn(n.eventQueue_,e,D),ts(n,i,g,y)});let h=PC(n,e);Ja(n,h),Rn(n.eventQueue_,h,[])}function X9(n,e,t,r){iu(n,"update",{path:e.toString(),value:t});let i=!0,s=cd(n),o={};if(St(t,(a,u)=>{i=!1,o[a]=dO(We(e,a),Ye(u),n.serverSyncTree_,s)}),i)At("update() called with empty data.  Don't do anything."),ts(n,r,"ok",void 0);else{let a=Ng(n),u=A9(n.serverSyncTree_,e,o,a);Mg(n.eventQueue_,u),n.server_.merge(e.toString(),t,(l,d)=>{let h=l==="ok";h||zt("update at "+e+" failed: "+l);let g=Qi(n.serverSyncTree_,a,!h),y=g.length>0?Ja(n,e):e;Rn(n.eventQueue_,y,g),ts(n,r,l,d)}),St(t,l=>{let d=PC(n,We(e,l));Ja(n,d)}),Rn(n.eventQueue_,e,[])}}function e3(n){iu(n,"onDisconnectEvents");let e=cd(n),t=ig();SI(n.onDisconnect_,Me(),(i,s)=>{let o=dO(i,s,n.serverSyncTree_,e);tu(t,i,o)});let r=[];SI(t,Me(),(i,s)=>{r=r.concat(sd(n.serverSyncTree_,i,s));let o=PC(n,i);Ja(n,o)}),n.onDisconnect_=ig(),Rn(n.eventQueue_,Me(),r)}function t3(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&AI(n.onDisconnect_,e),ts(n,t,r,i)})}function yk(n,e,t,r){let i=Ye(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&tu(n.onDisconnect_,e,i),ts(n,r,s,o)})}function n3(n,e,t,r,i){let s=Ye(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&tu(n.onDisconnect_,e,s),ts(n,i,o,a)})}function r3(n,e,t,r){if(Rh(t)){At("onDisconnect().update() called with empty data.  Don't do anything."),ts(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{i==="ok"&&St(t,(o,a)=>{let u=Ye(a);tu(n.onDisconnect_,We(e,o),u)}),ts(n,r,i,s)})}function i3(n,e,t){let r;pe(e._path)===".info"?r=BI(n.infoSyncTree_,e,t):r=BI(n.serverSyncTree_,e,t),yO(n.eventQueue_,e._path,r)}function WI(n,e,t){let r;pe(e._path)===".info"?r=pg(n.infoSyncTree_,e,t):r=pg(n.serverSyncTree_,e,t),yO(n.eventQueue_,e._path,r)}function EO(n){n.persistentConnection_&&n.persistentConnection_.interrupt(vO)}function s3(n){n.persistentConnection_&&n.persistentConnection_.resume(vO)}function iu(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),At(t,...e)}function ts(n,e,t,r){e&&eu(()=>{if(t==="ok")e(null);else{let i=(t||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function o3(n,e,t,r,i,s){iu(n,"transaction on "+e);let o={path:e,update:t,onComplete:r,status:null,order:wk(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=NC(n,e,void 0);o.currentInputSnapshot=a;let u=o.update(a.val());if(u===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{ad("transaction failed: Data returned ",u,o.path),o.status=0;let l=Sg(n.transactionQueueTree_,e),d=ao(l)||[];d.push(o),SC(l,d);let h;typeof u=="object"&&u!==null&&On(u,".priority")?(h=Ci(u,".priority"),L(Xl(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(bg(n.serverSyncTree_,e)||ue.EMPTY_NODE).getPriority().val();let g=cd(n),y=Ye(u,h),v=bC(y,a,g);o.currentOutputSnapshotRaw=y,o.currentOutputSnapshotResolved=v,o.currentWriteId=Ng(n);let D=IC(n.serverSyncTree_,e,v,o.currentWriteId,o.applyLocally);Rn(n.eventQueue_,e,D),Pg(n,n.transactionQueueTree_)}}function NC(n,e,t){return bg(n.serverSyncTree_,e,t)||ue.EMPTY_NODE}function Pg(n,e=n.transactionQueueTree_){if(e||kg(n,e),ao(e)){let t=CO(n,e);L(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&a3(n,od(e),t)}else hO(e)&&Rg(e,t=>{Pg(n,t)})}function a3(n,e,t){let r=t.map(l=>l.currentWriteId),i=NC(n,e,r),s=i,o=i.hash();for(let l=0;l<t.length;l++){let d=t[l];L(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let h=rn(e,d.path);s=s.updateChild(h,d.currentOutputSnapshotRaw)}let a=s.val(!0),u=e;n.server_.put(u.toString(),a,l=>{iu(n,"transaction put response",{path:u.toString(),status:l});let d=[];if(l==="ok"){let h=[];for(let g=0;g<t.length;g++)t[g].status=2,d=d.concat(Qi(n.serverSyncTree_,t[g].currentWriteId)),t[g].onComplete&&h.push(()=>t[g].onComplete(null,!0,t[g].currentOutputSnapshotResolved)),t[g].unwatcher();kg(n,Sg(n.transactionQueueTree_,e)),Pg(n,n.transactionQueueTree_),Rn(n.eventQueue_,e,d);for(let g=0;g<h.length;g++)eu(h[g])}else{if(l==="datastale")for(let h=0;h<t.length;h++)t[h].status===3?t[h].status=4:t[h].status=0;else{zt("transaction at "+u.toString()+" failed: "+l);for(let h=0;h<t.length;h++)t[h].status=4,t[h].abortReason=l}Ja(n,e)}},o)}function Ja(n,e){let t=IO(n,e),r=od(t),i=CO(n,t);return u3(n,i,r),r}function u3(n,e,t){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let u=e[a],l=rn(t,u.path),d=!1,h;if(L(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===4)d=!0,h=u.abortReason,i=i.concat(Qi(n.serverSyncTree_,u.currentWriteId,!0));else if(u.status===0)if(u.retryCount>=Q9)d=!0,h="maxretry",i=i.concat(Qi(n.serverSyncTree_,u.currentWriteId,!0));else{let g=NC(n,u.path,o);u.currentInputSnapshot=g;let y=e[a].update(g.val());if(y!==void 0){ad("transaction failed: Data returned ",y,u.path);let v=Ye(y);typeof y=="object"&&y!=null&&On(y,".priority")||(v=v.updatePriority(g.getPriority()));let A=u.currentWriteId,P=cd(n),B=bC(v,g,P);u.currentOutputSnapshotRaw=v,u.currentOutputSnapshotResolved=B,u.currentWriteId=Ng(n),o.splice(o.indexOf(A),1),i=i.concat(IC(n.serverSyncTree_,u.path,B,u.currentWriteId,u.applyLocally)),i=i.concat(Qi(n.serverSyncTree_,A,!0))}else d=!0,h="nodata",i=i.concat(Qi(n.serverSyncTree_,u.currentWriteId,!0))}Rn(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(g){setTimeout(g,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}kg(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)eu(r[a]);Pg(n,n.transactionQueueTree_)}function IO(n,e){let t,r=n.transactionQueueTree_;for(t=pe(e);t!==null&&ao(r)===void 0;)r=Sg(r,t),e=je(e),t=pe(e);return r}function CO(n,e){let t=[];return DO(n,e,t),t.sort((r,i)=>r.order-i.order),t}function DO(n,e,t){let r=ao(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);Rg(e,i=>{DO(n,i,t)})}function kg(n,e){let t=ao(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,SC(e,t.length>0?t:void 0)}Rg(e,r=>{kg(n,r)})}function PC(n,e){let t=od(IO(n,e)),r=Sg(n.transactionQueueTree_,e);return B9(r,i=>{nI(n,i)}),nI(n,r),fO(r,i=>{nI(n,i)}),t}function nI(n,e){let t=ao(e);if(t){let r=[],i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(L(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(L(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(Qi(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?SC(e,void 0):t.length=s+1,Rn(n.eventQueue_,od(e),i);for(let o=0;o<r.length;o++)eu(r[o])}}function c3(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function l3(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):zt(`Invalid query segment '${t}' in query '${n}'`)}return e}var KI=function(n,e){let t=d3(n),r=t.namespace;t.domain==="firebase.com"&&Mr(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&Mr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||Bz();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new Yp(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new Ne(t.pathString)}},d3=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",u=443;if(typeof n=="string"){let l=n.indexOf("//");l>=0&&(a=n.substring(0,l-1),n=n.substring(l+2));let d=n.indexOf("/");d===-1&&(d=n.length);let h=n.indexOf("?");h===-1&&(h=n.length),e=n.substring(0,Math.min(d,h)),d<h&&(i=c3(n.substring(d,h)));let g=l3(n.substring(Math.min(n.length,h)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",u=parseInt(e.substring(l+1),10)):l=e.length;let y=e.slice(0,l);if(y.toLowerCase()==="localhost")t="localhost";else if(y.split(".").length<=2)t=y;else{let v=e.indexOf(".");r=e.substring(0,v).toLowerCase(),t=e.substring(v+1),s=r}"ns"in g&&(s=g.ns)}return{host:e,port:u,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var _k="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",h3=function(){let n=0,e=[];return function(t){let r=t===n;n=t;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=_k.charAt(t%64),t=Math.floor(t/64);L(t===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=_k.charAt(e[i]);return L(o.length===20,"nextPushId: Length should be 20."),o}}();var gg=class{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ht(this.snapshot.exportVal())}},mg=class{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var ed=class{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return L(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var yg=class{constructor(e,t){this._repo=e,this._path=t}cancel(){let e=new It;return t3(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Sn("OnDisconnect.remove",this._path);let e=new It;return yk(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Sn("OnDisconnect.set",this._path),Pr("OnDisconnect.set",e,this._path,!1);let t=new It;return yk(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Sn("OnDisconnect.setWithPriority",this._path),Pr("OnDisconnect.setWithPriority",e,this._path,!1),RC("OnDisconnect.setWithPriority",t,!1);let r=new It;return n3(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){Sn("OnDisconnect.update",this._path),gO("OnDisconnect.update",e,this._path,!1);let t=new It;return r3(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};var on=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return ge(this._path)?null:dC(this._path)}get ref(){return new xn(this._repo,this._path)}get _queryIdentifier(){let e=ik(this._queryParams),t=cC(e);return t==="{}"?"default":t}get _queryObject(){return ik(this._queryParams)}isEqual(e){if(e=_e(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=hC(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+vW(this._path)}};function Og(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function ns(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===xr){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Ji)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==oi)throw new Error(r);if(typeof t!="string")throw new Error(i)}}else if(n.getIndex()===Be){if(e!=null&&!Xl(e)||t!=null&&!Xl(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(L(n.getIndex()instanceof Hl||n.getIndex()===gC,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Fg(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var xn=class n extends on{constructor(e,t){super(e,t,new Kl,!1)}get parent(){let e=Bk(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Xa=class n{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new Ne(e),r=ai(this.ref,e);return new n(this._node.getChild(t),r,Be)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new n(i,ai(this.ref,r),Be)))}hasChild(e){let t=new Ne(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function Vg(n,e){return n=_e(n),n._checkNotDeleted("ref"),e!==void 0?ai(n._root,e):n._root}function Lg(n,e){n=_e(n),n._checkNotDeleted("refFromURL");let t=KI(e,n._repo.repoInfo_.nodeAdmin);mO("refFromURL",t);let r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&Mr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),Vg(n,t.path.toString())}function ai(n,e){return n=_e(n),pe(n._path)===null?W9("child","path",e,!1):ru("child","path",e,!1),new xn(n._repo,We(n._path,e))}function kC(n,e){n=_e(n),Sn("push",n._path),Pr("push",e,n._path,!0);let t=wO(n._repo),r=h3(t),i=ai(n,r),s=ai(n,r),o;return e!=null?o=ld(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function OC(n){return Sn("remove",n._path),ld(n,null)}function ld(n,e){n=_e(n),Sn("set",n._path),Pr("set",e,n._path,!1);let t=new It;return MC(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function FC(n,e){n=_e(n),Sn("setPriority",n._path),RC("setPriority",e,!1);let t=new It;return MC(n._repo,We(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function VC(n,e,t){if(Sn("setWithPriority",n._path),Pr("setWithPriority",e,n._path,!1),RC("setWithPriority",t,!1),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";let r=new It;return MC(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}function LC(n,e){gO("update",e,n._path,!1);let t=new It;return X9(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function jC(n){n=_e(n);let e=new ed(()=>{}),t=new td(e);return J9(n._repo,n,t).then(r=>new Xa(r,new xn(n._repo,n._path),n._queryParams.getIndex()))}var td=class n{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){let r=t._queryParams.getIndex();return new gg("value",this,new Xa(e.snapshotNode,new xn(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new mg(this,e,t):null}matches(e){return e instanceof n?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},_g=class n{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new mg(this,e,t):null}createEvent(e,t){L(e.childName!=null,"Child events should have a childName.");let r=ai(new xn(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new gg(e.type,this,new Xa(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof n?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function dd(n,e,t,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let u=t,l=(d,h)=>{WI(n._repo,n,a),u(d,h)};l.userCallback=t.userCallback,l.context=t.context,t=l}let o=new ed(t,s||void 0),a=e==="value"?new td(o):new _g(e,o);return i3(n._repo,n,a),()=>WI(n._repo,n,a)}function hd(n,e,t,r){return dd(n,"value",e,t,r)}function jg(n,e,t,r){return dd(n,"child_added",e,t,r)}function Ug(n,e,t,r){return dd(n,"child_changed",e,t,r)}function Bg(n,e,t,r){return dd(n,"child_moved",e,t,r)}function $g(n,e,t,r){return dd(n,"child_removed",e,t,r)}function qg(n,e,t){let r=null,i=t?new ed(t):null;e==="value"?r=new td(i):e&&(r=new _g(e,i)),WI(n._repo,n,r)}var Mn=class{},vg=class extends Mn{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){Pr("endAt",this._value,e._path,!0);let t=DI(e._queryParams,this._value,this._key);if(Fg(t),ns(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new on(e._repo,e._path,t,e._orderByCalled)}};function UC(n,e){return ud("endAt","key",e,!0),new vg(n,e)}var QI=class extends Mn{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){Pr("endBefore",this._value,e._path,!1);let t=LW(e._queryParams,this._value,this._key);if(Fg(t),ns(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new on(e._repo,e._path,t,e._orderByCalled)}};function BC(n,e){return ud("endBefore","key",e,!0),new QI(n,e)}var wg=class extends Mn{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){Pr("startAt",this._value,e._path,!0);let t=CI(e._queryParams,this._value,this._key);if(Fg(t),ns(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new on(e._repo,e._path,t,e._orderByCalled)}};function $C(n=null,e){return ud("startAt","key",e,!0),new wg(n,e)}var YI=class extends Mn{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){Pr("startAfter",this._value,e._path,!1);let t=VW(e._queryParams,this._value,this._key);if(Fg(t),ns(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new on(e._repo,e._path,t,e._orderByCalled)}};function qC(n,e){return ud("startAfter","key",e,!0),new YI(n,e)}var ZI=class extends Mn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new on(e._repo,e._path,OW(e._queryParams,this._limit),e._orderByCalled)}};function HC(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new ZI(n)}var JI=class extends Mn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new on(e._repo,e._path,FW(e._queryParams,this._limit),e._orderByCalled)}};function GC(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new JI(n)}var XI=class extends Mn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Og(e,"orderByChild");let t=new Ne(this._path);if(ge(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new Hl(t),i=Ig(e._queryParams,r);return ns(i),new on(e._repo,e._path,i,!0)}};function zC(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return ru("orderByChild","path",n,!1),new XI(n)}var eC=class extends Mn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Og(e,"orderByKey");let t=Ig(e._queryParams,xr);return ns(t),new on(e._repo,e._path,t,!0)}};function WC(){return new eC}var tC=class extends Mn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Og(e,"orderByPriority");let t=Ig(e._queryParams,Be);return ns(t),new on(e._repo,e._path,t,!0)}};function KC(){return new tC}var nC=class extends Mn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Og(e,"orderByValue");let t=Ig(e._queryParams,gC);return ns(t),new on(e._repo,e._path,t,!0)}};function QC(){return new nC}var rC=class extends Mn{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(Pr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new vg(this._value,this._key)._apply(new wg(this._value,this._key)._apply(e))}};function YC(n,e){return ud("equalTo","key",e,!0),new rC(n,e)}function Nn(n,...e){let t=_e(n);for(let r of e)t=r._apply(t);return t}v9(xn);D9(xn);var f3="FIREBASE_DATABASE_EMULATOR_HOST",iC={},p3=!1;function g3(n,e,t,r){n.repoInfo_=new Yp(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function ZC(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||Mr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),At("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=KI(s,i),a=o.repoInfo,u,l;typeof process<"u"&&process.env&&(l=process.env[f3]),l?(u=!0,s=`http://${l}?ns=${a.namespace}`,o=KI(s,i),a=o.repoInfo):u=!o.repoInfo.secure;let d=i&&u?new Ll(Ll.OWNER):new uI(n.name,n.options,e);mO("Invalid Firebase Database URL",o),ge(o.path)||Mr("Database URL must point to the root of a Firebase Database (not including a child path).");let h=y3(a,n,d,new aI(n.name,t));return new sC(h,n)}function m3(n,e){let t=iC[e];(!t||t[n.key]!==n)&&Mr(`Database ${e}(${n.repoInfo_}) has already been deleted.`),EO(n),delete t[n.key]}function y3(n,e,t,r){let i=iC[e.name];i||(i={},iC[e.name]=i);let s=i[n.toURLString()];return s&&Mr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new zI(n,p3,t,r),i[n.toURLString()]=s,s}var sC=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Y9(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new xn(this._repo,Me())),this._rootInternal}_delete(){return this._rootInternal!==null&&(m3(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Mr("Cannot call "+e+" on a deleted database.")}};function TO(){Uk.IS_TRANSPORT_INITIALIZED&&zt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function JC(){TO(),$l.forceDisallow()}function XC(){TO(),qa.forceDisallow(),$l.forceAllow()}function bO(n=Rs(),e){let t=_c(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){let r=Th("database");r&&Hg(t,...r)}return t}function Hg(n,e,t,r={}){n=_e(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Mr("Cannot call useEmulator() after instance has already been initialized.");let i=n._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Mr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Ll(Ll.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:bh(r.mockUserToken,n.app.options.projectId);s=new Ll(o)}g3(i,e,t,s)}function eD(n){n=_e(n),n._checkNotDeleted("goOffline"),EO(n._repo)}function tD(n){n=_e(n),n._checkNotDeleted("goOnline"),s3(n._repo)}function nD(n,e){Ik(n,e)}function _3(n){uC(Mh),Ss(new yn("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return ZC(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),it(BP,$P,n),it(BP,$P,"esm2017")}var v3={".sv":"timestamp"};function rD(){return v3}function iD(n){return{".sv":{increment:n}}}var oC=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function sD(n,e,t){var r;if(n=_e(n),Sn("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";let i=(r=t?.applyLocally)!==null&&r!==void 0?r:!0,s=new It,o=(u,l,d)=>{let h=null;u?s.reject(u):(h=new Xa(d,new xn(n._repo,n._path),Be),s.resolve(new oC(l,h)))},a=hd(n,()=>{});return o3(n._repo,n._path,e,o,a,i),s.promise}fC.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};fC.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};_3();var w3="@firebase/database-compat",E3="1.0.8";var I3=new Di("@firebase/database-compat"),AO=function(n){let e="FIREBASE WARNING: "+n;I3.warn(e)};var C3=function(n,e,t,r){if(!(r&&t===void 0)&&typeof t!="boolean")throw new Error(ln(n,e)+"must be a boolean.")},D3=function(n,e,t){if(!(t&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(ln(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var oD=class{constructor(e){this._delegate=e}cancel(e){ne("OnDisconnect.cancel",0,1,arguments.length),_t("OnDisconnect.cancel","onComplete",e,!0);let t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){ne("OnDisconnect.remove",0,1,arguments.length),_t("OnDisconnect.remove","onComplete",e,!0);let t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){ne("OnDisconnect.set",1,2,arguments.length),_t("OnDisconnect.set","onComplete",t,!0);let r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){ne("OnDisconnect.setWithPriority",2,3,arguments.length),_t("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,t){if(ne("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,AO("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}_t("OnDisconnect.update","onComplete",t,!0);let r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}};var aD=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return ne("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var uo=class n{constructor(e,t){this._database=e,this._delegate=t}val(){return ne("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return ne("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return ne("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return ne("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return ne("DataSnapshot.child",0,1,arguments.length),e=String(e),ru("DataSnapshot.child","path",e,!1),new n(this._database,this._delegate.child(e))}hasChild(e){return ne("DataSnapshot.hasChild",1,1,arguments.length),ru("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return ne("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return ne("DataSnapshot.forEach",1,1,arguments.length),_t("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new n(this._database,t)))}hasChildren(){return ne("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return ne("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return ne("DataSnapshot.ref",0,0,arguments.length),new ui(this._database,this._delegate.ref)}get ref(){return this.getRef()}},Gg=class n{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var s;ne("Query.on",2,4,arguments.length),_t("Query.on","callback",t,!1);let o=n.getCancelAndContextArgs_("Query.on",r,i),a=(l,d)=>{t.call(o.context,new uo(this.database,l),d)};a.userCallback=t,a.context=o.context;let u=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return hd(this._delegate,a,u),t;case"child_added":return jg(this._delegate,a,u),t;case"child_removed":return $g(this._delegate,a,u),t;case"child_changed":return Ug(this._delegate,a,u),t;case"child_moved":return Bg(this._delegate,a,u),t;default:throw new Error(ln("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if(ne("Query.off",0,3,arguments.length),D3("Query.off",e,!0),_t("Query.off","callback",t,!0),c_("Query.off","context",r,!0),t){let i=()=>{};i.userCallback=t,i.context=r,qg(this._delegate,e,i)}else qg(this._delegate,e)}get(){return jC(this._delegate).then(e=>new uo(this.database,e))}once(e,t,r,i){ne("Query.once",1,4,arguments.length),_t("Query.once","callback",t,!0);let s=n.getCancelAndContextArgs_("Query.once",r,i),o=new It,a=(l,d)=>{let h=new uo(this.database,l);t&&t.call(s.context,h,d),o.resolve(h)};a.userCallback=t,a.context=s.context;let u=l=>{s.cancel&&s.cancel.call(s.context,l),o.reject(l)};switch(e){case"value":hd(this._delegate,a,u,{onlyOnce:!0});break;case"child_added":jg(this._delegate,a,u,{onlyOnce:!0});break;case"child_removed":$g(this._delegate,a,u,{onlyOnce:!0});break;case"child_changed":Ug(this._delegate,a,u,{onlyOnce:!0});break;case"child_moved":Bg(this._delegate,a,u,{onlyOnce:!0});break;default:throw new Error(ln("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return ne("Query.limitToFirst",1,1,arguments.length),new n(this.database,Nn(this._delegate,HC(e)))}limitToLast(e){return ne("Query.limitToLast",1,1,arguments.length),new n(this.database,Nn(this._delegate,GC(e)))}orderByChild(e){return ne("Query.orderByChild",1,1,arguments.length),new n(this.database,Nn(this._delegate,zC(e)))}orderByKey(){return ne("Query.orderByKey",0,0,arguments.length),new n(this.database,Nn(this._delegate,WC()))}orderByPriority(){return ne("Query.orderByPriority",0,0,arguments.length),new n(this.database,Nn(this._delegate,KC()))}orderByValue(){return ne("Query.orderByValue",0,0,arguments.length),new n(this.database,Nn(this._delegate,QC()))}startAt(e=null,t){return ne("Query.startAt",0,2,arguments.length),new n(this.database,Nn(this._delegate,$C(e,t)))}startAfter(e=null,t){return ne("Query.startAfter",0,2,arguments.length),new n(this.database,Nn(this._delegate,qC(e,t)))}endAt(e=null,t){return ne("Query.endAt",0,2,arguments.length),new n(this.database,Nn(this._delegate,UC(e,t)))}endBefore(e=null,t){return ne("Query.endBefore",0,2,arguments.length),new n(this.database,Nn(this._delegate,BC(e,t)))}equalTo(e,t){return ne("Query.equalTo",1,2,arguments.length),new n(this.database,Nn(this._delegate,YC(e,t)))}toString(){return ne("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return ne("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(ne("Query.isEqual",1,1,arguments.length),!(e instanceof n)){let t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){let i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,_t(e,"cancel",i.cancel,!0),i.context=r,c_(e,"context",i.context,!0);else if(t)if(typeof t=="object"&&t!==null)i.context=t;else if(typeof t=="function")i.cancel=t;else throw new Error(ln(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new ui(this.database,new xn(this._delegate._repo,this._delegate._path))}},ui=class n extends Gg{constructor(e,t){super(e,new on(t._repo,t._path,new Kl,!1)),this.database=e,this._delegate=t}getKey(){return ne("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return ne("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new n(this.database,ai(this._delegate,e))}getParent(){ne("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new n(this.database,e):null}getRoot(){return ne("Reference.root",0,0,arguments.length),new n(this.database,this._delegate.root)}set(e,t){ne("Reference.set",1,2,arguments.length),_t("Reference.set","onComplete",t,!0);let r=ld(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if(ne("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,AO("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Sn("Reference.update",this._delegate._path),_t("Reference.update","onComplete",t,!0);let r=LC(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){ne("Reference.setWithPriority",2,3,arguments.length),_t("Reference.setWithPriority","onComplete",r,!0);let i=VC(this._delegate,e,t);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){ne("Reference.remove",0,1,arguments.length),_t("Reference.remove","onComplete",e,!0);let t=OC(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){ne("Reference.transaction",1,3,arguments.length),_t("Reference.transaction","transactionUpdate",e,!1),_t("Reference.transaction","onComplete",t,!0),C3("Reference.transaction","applyLocally",r,!0);let i=sD(this._delegate,e,{applyLocally:r}).then(s=>new aD(s.committed,new uo(this.database,s.snapshot)));return t&&i.then(s=>t(null,s.committed,s.snapshot),s=>t(s,!1,null)),i}setPriority(e,t){ne("Reference.setPriority",1,2,arguments.length),_t("Reference.setPriority","onComplete",t,!0);let r=FC(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){ne("Reference.push",0,2,arguments.length),_t("Reference.push","onComplete",t,!0);let r=kC(this._delegate,e),i=r.then(o=>new n(this.database,o));t&&i.then(()=>t(null),o=>t(o));let s=new n(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return Sn("Reference.onDisconnect",this._delegate._path),new oD(new yg(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var co=class{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:JC,forceLongPolling:XC}}useEmulator(e,t,r={}){Hg(this._delegate,e,t,r)}ref(e){if(ne("database.ref",0,1,arguments.length),e instanceof ui){let t=Lg(this._delegate,e.toString());return new ui(this,t)}else{let t=Vg(this._delegate,e);return new ui(this,t)}}refFromURL(e){ne("database.refFromURL",1,1,arguments.length);let r=Lg(this._delegate,e);return new ui(this,r)}goOffline(){return ne("database.goOffline",0,0,arguments.length),eD(this._delegate)}goOnline(){return ne("database.goOnline",0,0,arguments.length),tD(this._delegate)}};co.ServerValue={TIMESTAMP:rD(),increment:n=>iD(n)};function T3({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){uC(t);let a=new l_("database-standalone"),u=new xh("auth-internal",a);u.setComponent(new yn("auth-internal",()=>r,"PRIVATE"));let l;return i&&(l=new xh("app-check-internal",a),l.setComponent(new yn("app-check-internal",()=>i,"PRIVATE"))),{instance:new co(ZC(n,u,l,e,o),n),namespace:s}}var b3=Object.freeze({__proto__:null,initStandalone:T3});var A3=co.ServerValue;function S3(n){n.INTERNAL.registerComponent(new yn("database-compat",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new co(i,r)},"PUBLIC").setServiceProps({Reference:ui,Query:Gg,Database:co,DataSnapshot:uo,enableLogging:nD,INTERNAL:b3,ServerValue:A3}).setMultipleInstances(!0)),n.registerVersion(w3,E3)}S3(vt);function fd(n,e,t="on",r=ks){return new ce(i=>{let s=null;return s=n[t](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),t==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),t==="on"?{unsubscribe(){s!=null&&n.off(e,s)}}:{unsubscribe(){}}}).pipe(Q(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),Dc())}function R3(n){return typeof n=="string"}function x3(n){return typeof n.exportVal=="function"}function NO(n){return n==null}function PO(n){return typeof n.set=="function"}function SO(n,e){return PO(e)?e:n.ref(e)}function kO(n,e){if(R3(n))return e.stringCase();if(PO(n))return e.firebaseCase();if(x3(n))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof n}`)}function OO(n){return(NO(n)||n.length===0)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function FO(n,e,t){e=OO(e);let r=e.map(i=>fd(n,i,"on",t));return na(...r)}function M3(n,e,t){let r=FO(n,e).pipe(yr((i,s)=>[...i,s],[]));return P3(n,r,t)}function N3(n,e){return fd(n,"value","on",e).pipe(Q(t=>{let r;return t.payload.forEach(i=>(r=i.key,!1)),{data:t,lastKeyToLoad:r}}))}function P3(n,e,t){return N3(n,t).pipe(k_(e),Q(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(u=>u.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),N_(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),Q(i=>i.actions))}function RO(n,e){return function(r,i){return kO(r,{stringCase:()=>n.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function k3(n){return function(t){return t?kO(t,{stringCase:()=>n.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):n.remove()}}function O3(n,e,t){return fd(n,"value","once",t).pipe(He(r=>{let i=[Z(r)];return e.forEach(s=>i.push(fd(n,s,"on",t))),na(...i).pipe(yr(V3,[]))}),Ic())}function VO(n,e){let t=n.length;for(let r=0;r<t;r++)if(n[r].payload.key===e)return r;return-1}function F3(n,e){if(NO(e))return 0;{let t=VO(n,e);return t===-1?n.length:t+1}}function V3(n,e){let{payload:t,prevKey:r,key:i}=e,s=VO(n,i),o=F3(n,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(u=>{let l={payload:u,type:"value",prevKey:a,key:u.key};return a=u.key,n=[...n,l],!1})}return n;case"child_added":if(s>-1)(n[s-1]?.key||null)!==r&&(n=n.filter(u=>u.payload.key!==t.key),n.splice(o,0,e));else{if(r==null)return[e,...n];n=n.slice(),n.splice(o,0,e)}return n;case"child_removed":return n.filter(a=>a.payload.key!==t.key);case"child_changed":return n.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=n.splice(s,1)[0];return n=n.slice(),n.splice(o,0,a),n}return n;default:return n}}function xO(n,e,t){return e=OO(e),O3(n,e,t)}function L3(n,e){let t=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>n.ref);return{query:n,update:RO(r,"update"),set:RO(r,"set"),push:i=>r.push(i),remove:k3(r),snapshotChanges(i){return xO(n,i,t).pipe(nt)},stateChanges(i){return FO(n,i,t).pipe(nt)},auditTrail(i){return M3(n,i,t).pipe(nt)},valueChanges(i,s){return xO(n,i,t).pipe(Q(a=>a.map(u=>s&&s.idField?xe(G({},u.payload.val()),{[s.idField]:u.key}):u.payload.val())),nt)}}}function MO(n,e){return function(){return fd(n,"value","on",e)}}function j3(n,e){return{query:n,snapshotChanges(){return MO(n,e.schedulers.outsideAngular)().pipe(nt)},update(t){return n.ref.update(t)},set(t){return n.ref.set(t)},remove(){return n.ref.remove()},valueChanges(){return MO(n,e.schedulers.outsideAngular)().pipe(nt,Q(r=>r.payload.exists()?r.payload.val():null))}}}var U3=new H("angularfire2.realtimeDatabaseURL"),B3=new H("angularfire2.database.use-emulator"),uD=(()=>{class n{schedulers;database;constructor(t,r,i,s,o,a,u,l,d,h,g,y,v,D,A){this.schedulers=a;let P=u,B=eo(t,o,r);l&&Ml(B,o,d,g,y,v,h,D),this.database=Ba(`${B.name}.database.${i}`,"AngularFireDatabase",B.name,()=>{let F=o.runOutsideAngular(()=>B.database(i||void 0));return P&&F.useEmulator(...P),F},[P])}list(t,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>SO(this.database,t)),s=i;return r&&(s=r(i)),L3(s,this)}object(t){let r=this.schedulers.ngZone.runOutsideAngular(()=>SO(this.database,t));return j3(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||n)(V(Wi),V(Ki,8),V(U3,8),V(at),V(le),V(pn),V(B3,8),V(Nl,8),V(Tl,8),V(bl,8),V(Al,8),V(Sl,8),V(Rl,8),V(xl,8),V(nn,8))};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),LO=(()=>{class n{constructor(){vt.registerVersion("angularfire",bt.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Gt({type:n});static \u0275inj=Ht({providers:[uD]})}return n})();var zg=(()=>{class n{constructor(t){this.db=t,this.dbPath="/employees",this.employeesRef=t.list(this.dbPath)}getAllEmployees(){return this.employeesRef}getEmployee(t){return this.db.object(`${this.dbPath}/${t}`)}addEmployee(t){this.employeesRef.push(t)}updateEmployee(t,r){this.employeesRef.update(t,r)}deleteEmployee(t){return this.employeesRef.remove(t)}static{this.\u0275fac=function(r){return new(r||n)(V(uD))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function q3(n,e){if(n&1){let t=zM();Te(0,"div",4)(1,"div",5)(2,"h2",6),ke(3),we(),Te(4,"h5",7),ke(5),we(),Te(6,"p",8),ke(7),we(),Te(8,"p",8),ke(9),we(),Te(10,"div",9)(11,"button",10),sr("click",function(){let i=tw(t).$implicit,s=kw();return nw(s.editEmployee(i.key))}),ke(12," Edit "),we(),Te(13,"button",11),sr("click",function(){let i=tw(t).$implicit,s=kw();return nw(s.removeEmployee(i.key))}),ke(14," Remove "),we()()()()}if(n&2){let t=e.$implicit;$n(3),Da("Name: ",t.name,""),$n(2),Da("Position: ",t.position,""),$n(2),Da("Department: ",t.department,""),$n(2),Da("Salary: ",t.salary,"")}}var UO=(()=>{class n{constructor(t,r){this.employeeService=t,this.router=r,this.employees=[],this.totalEmployees=0}ngOnInit(){this.getAllEmployees()}getAllEmployees(){this.employeeService.getAllEmployees().snapshotChanges().subscribe({next:t=>{this.employees=[],t.forEach(r=>{let i=r.payload.toJSON();this.totalEmployees+=parseInt(i.salary),this.employees.push({key:r.key||"",name:i.name,position:i.position,department:i.department,salary:i.salary})})}})}editEmployee(t){this.router.navigate(["/add-edit-employee/"+t])}removeEmployee(t){window.confirm("Are You Sure ??")&&this.employeeService.deleteEmployee(t)}static{this.\u0275fac=function(r){return new(r||n)(De(zg),De(An))}}static{this.\u0275cmp=Un({type:n,selectors:[["app-employee-list"]],standalone:!0,features:[Hn],decls:9,vars:0,consts:[[1,"mb-4","d-flex","justify-content-between","align-items-center"],["type","button","routerLink","",1,"btn","btn-danger"],["type","button","routerLink","/add-edit-employee",1,"btn","btn-primary"],[1,"d-flex","flex-column","gap-3"],[1,"card"],[1,"card-body"],[1,"fw-bold","text-success"],[1,"card-title"],[1,"card-text"],[1,"d-flex","gap-2"],[1,"btn","btn-sm","btn-success",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"]],template:function(r,i){r&1&&(Te(0,"div",0)(1,"button",1),ke(2,"Go Back"),we(),Te(3,"button",2),ke(4," Add Employee "),we()(),Te(5,"div",3),qM(6,q3,15,4,"div",4,$M),we(),qn(8,"router-outlet")),r&2&&($n(6),HM(i.employees))},dependencies:[Qs,La,vl,Va]})}}return n})();var QO=(()=>{class n{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static{this.\u0275fac=function(r){return new(r||n)(De(zs),De(Vi))}}static{this.\u0275dir=Cn({type:n})}}return n})(),H3=(()=>{class n extends QO{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=Wc(n)))(i||n)}})()}static{this.\u0275dir=Cn({type:n,features:[ji]})}}return n})(),YO=new H("");var G3={provide:YO,useExisting:wa(()=>em),multi:!0};function z3(){let n=ni()?ni().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var W3=new H(""),em=(()=>{class n extends QO{constructor(t,r,i){super(t,r),this._compositionMode=i,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!z3())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static{this.\u0275fac=function(r){return new(r||n)(De(zs),De(Vi),De(W3,8))}}static{this.\u0275dir=Cn({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&sr("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[pp([G3]),ji]})}}return n})();function rs(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}function ZO(n){return n!=null&&typeof n.length=="number"}var JO=new H(""),XO=new H(""),K3=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,lo=class{static min(e){return Q3(e)}static max(e){return Y3(e)}static required(e){return Z3(e)}static requiredTrue(e){return J3(e)}static email(e){return X3(e)}static minLength(e){return e6(e)}static maxLength(e){return t6(e)}static pattern(e){return n6(e)}static nullValidator(e){return e1(e)}static compose(e){return o1(e)}static composeAsync(e){return u1(e)}};function Q3(n){return e=>{if(rs(e.value)||rs(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function Y3(n){return e=>{if(rs(e.value)||rs(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function Z3(n){return rs(n.value)?{required:!0}:null}function J3(n){return n.value===!0?null:{required:!0}}function X3(n){return rs(n.value)||K3.test(n.value)?null:{email:!0}}function e6(n){return e=>rs(e.value)||!ZO(e.value)?null:e.value.length<n?{minlength:{requiredLength:n,actualLength:e.value.length}}:null}function t6(n){return e=>ZO(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}function n6(n){if(!n)return e1;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(rs(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}function e1(n){return null}function t1(n){return n!=null}function n1(n){return Ws(n)?Ce(n):n}function r1(n){let e={};return n.forEach(t=>{e=t!=null?G(G({},e),t):e}),Object.keys(e).length===0?null:e}function i1(n,e){return e.map(t=>t(n))}function r6(n){return!n.validate}function s1(n){return n.map(e=>r6(e)?e:t=>e.validate(t))}function o1(n){if(!n)return null;let e=n.filter(t1);return e.length==0?null:function(t){return r1(i1(t,e))}}function a1(n){return n!=null?o1(s1(n)):null}function u1(n){if(!n)return null;let e=n.filter(t1);return e.length==0?null:function(t){let r=i1(t,e).map(n1);return S_(r).pipe(Q(r1))}}function c1(n){return n!=null?u1(s1(n)):null}function BO(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function l1(n){return n._rawValidators}function d1(n){return n._rawAsyncValidators}function cD(n){return n?Array.isArray(n)?n:[n]:[]}function Kg(n,e){return Array.isArray(n)?n.includes(e):n===e}function $O(n,e){let t=cD(e);return cD(n).forEach(i=>{Kg(t,i)||t.push(i)}),t}function qO(n,e){return cD(e).filter(t=>!Kg(n,t))}var Qg=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=a1(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=c1(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},ou=class extends Qg{get formDirective(){return null}get path(){return null}},md=class extends Qg{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Yg=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},i6={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Bie=xe(G({},i6),{"[class.ng-submitted]":"isSubmitted"}),h1=(()=>{class n extends Yg{constructor(t){super(t)}static{this.\u0275fac=function(r){return new(r||n)(De(md,2))}}static{this.\u0275dir=Cn({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&fp("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[ji]})}}return n})(),f1=(()=>{class n extends Yg{constructor(t){super(t)}static{this.\u0275fac=function(r){return new(r||n)(De(ou,10))}}static{this.\u0275dir=Cn({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&fp("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[ji]})}}return n})();var pd="VALID",Wg="INVALID",su="PENDING",gd="DISABLED";function hD(n){return(tm(n)?n.validators:n)||null}function s6(n){return Array.isArray(n)?a1(n):n||null}function fD(n,e){return(tm(e)?e.asyncValidators:n)||null}function o6(n){return Array.isArray(n)?c1(n):n||null}function tm(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function p1(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new ee(1e3,"");if(!r[t])throw new ee(1001,"")}function g1(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new ee(1002,"")})}var au=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===pd}get invalid(){return this.status===Wg}get pending(){return this.status==su}get disabled(){return this.status===gd}get enabled(){return this.status!==gd}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators($O(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators($O(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(qO(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(qO(e,this._rawAsyncValidators))}hasValidator(e){return Kg(this._rawValidators,e)}hasAsyncValidator(e){return Kg(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=su,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=gd,this.errors=null,this._forEachChild(r=>{r.disable(xe(G({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(xe(G({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=pd,this._forEachChild(r=>{r.enable(xe(G({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(xe(G({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===pd||this.status===su)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?gd:pd}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=su,this._hasOwnPendingAsyncValidator=!0;let t=n1(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new jt,this.statusChanges=new jt}_calculateStatus(){return this._allControlsDisabled()?gd:this.errors?Wg:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(su)?su:this._anyControlsHaveStatus(Wg)?Wg:pd}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){tm(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=s6(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=o6(this._rawAsyncValidators)}},Zg=class extends au{constructor(e,t,r){super(hD(t),fD(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){g1(this,!0,e),Object.keys(e).forEach(r=>{p1(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,s)=>{r=t(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var lD=class extends Zg{};var m1=new H("CallSetDisabledState",{providedIn:"root",factory:()=>pD}),pD="always";function a6(n,e){return[...e.path,n]}function HO(n,e,t=pD){gD(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),c6(n,e),d6(n,e),l6(n,e),u6(n,e)}function GO(n,e,t=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),Xg(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function Jg(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function u6(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function gD(n,e){let t=l1(n);e.validator!==null?n.setValidators(BO(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=d1(n);e.asyncValidator!==null?n.setAsyncValidators(BO(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();Jg(e._rawValidators,i),Jg(e._rawAsyncValidators,i)}function Xg(n,e){let t=!1;if(n!==null){if(e.validator!==null){let i=l1(n);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.validator);s.length!==i.length&&(t=!0,n.setValidators(s))}}if(e.asyncValidator!==null){let i=d1(n);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(t=!0,n.setAsyncValidators(s))}}}let r=()=>{};return Jg(e._rawValidators,r),Jg(e._rawAsyncValidators,r),t}function c6(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&y1(n,e)})}function l6(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&y1(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function y1(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function d6(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function h6(n,e){n==null,gD(n,e)}function f6(n,e){return Xg(n,e)}function p6(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function g6(n){return Object.getPrototypeOf(n.constructor)===H3}function m6(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function y6(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(s=>{s.constructor===em?t=s:g6(s)?r=s:i=s}),i||r||t||null}function _6(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function zO(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function WO(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var ci=class extends au{constructor(e=null,t,r){super(hD(t),fD(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),tm(t)&&(t.nonNullable||t.initialValueIsDefault)&&(WO(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){zO(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){zO(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){WO(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var v6=n=>n instanceof ci;var _1=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=Cn({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return n})();var v1=new H("");var w6={provide:ou,useExisting:wa(()=>mD)},mD=(()=>{class n extends ou{constructor(t,r,i){super(),this.callSetDisabledState=i,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new jt,this._setValidators(t),this._setAsyncValidators(r)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Xg(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){let r=this.form.get(t.path);return HO(r,t,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),r}getControl(t){return this.form.get(t.path)}removeControl(t){GO(t.control||null,t,!1),_6(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,r){this.form.get(t.path).setValue(r)}onSubmit(t){return this.submitted=!0,m6(this.form,this.directives),this.ngSubmit.emit(t),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{let r=t.control,i=this.form.get(t.path);r!==i&&(GO(r||null,t),v6(i)&&(HO(i,t,this.callSetDisabledState),t.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let r=this.form.get(t.path);h6(r,t),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let r=this.form.get(t.path);r&&f6(r,t)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){gD(this.form,this),this._oldForm&&Xg(this._oldForm,this)}_checkFormPresent(){this.form}static{this.\u0275fac=function(r){return new(r||n)(De(JO,10),De(XO,10),De(m1,8))}}static{this.\u0275dir=Cn({type:n,selectors:[["","formGroup",""]],hostBindings:function(r,i){r&1&&sr("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{form:[$t.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[pp([w6]),ji,Oi]})}}return n})();var E6={provide:md,useExisting:wa(()=>yD)},yD=(()=>{class n extends md{set isDisabled(t){}static{this._ngModelWarningSentOnce=!1}constructor(t,r,i,s,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.name=null,this.update=new jt,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=y6(this,s)}ngOnChanges(t){this._added||this._setUpControl(),p6(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return a6(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static{this.\u0275fac=function(r){return new(r||n)(De(ou,13),De(JO,10),De(XO,10),De(YO,10),De(v1,8))}}static{this.\u0275dir=Cn({type:n,selectors:[["","formControlName",""]],inputs:{name:[$t.None,"formControlName","name"],isDisabled:[$t.None,"disabled","isDisabled"],model:[$t.None,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[pp([E6]),ji,Oi]})}}return n})();var I6=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Gt({type:n})}static{this.\u0275inj=Ht({})}}return n})(),dD=class extends au{constructor(e,t,r){super(hD(t),fD(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){g1(this,!1,e),e.forEach((r,i)=>{p1(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,r)=>r._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function KO(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var w1=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,r=null){let i=this._reduceControls(t),s={};return KO(r)?s=r:r!==null&&(s.validators=r.validator,s.asyncValidators=r.asyncValidator),new Zg(i,s)}record(t,r=null){let i=this._reduceControls(t);return new lD(i,r)}control(t,r,i){let s={};return this.useNonNullable?(KO(r)?s=r:(s.validators=r,s.asyncValidators=i),new ci(t,xe(G({},s),{nonNullable:!0}))):new ci(t,r,i)}array(t,r,i){let s=t.map(o=>this._createControl(o));return new dD(s,r,i)}_reduceControls(t){let r={};return Object.keys(t).forEach(i=>{r[i]=this._createControl(t[i])}),r}_createControl(t){if(t instanceof ci)return t;if(t instanceof au)return t;if(Array.isArray(t)){let r=t[0],i=t.length>1?t[1]:null,s=t.length>2?t[2]:null;return this.control(r,i,s)}else return this.control(t)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var E1=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:v1,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:m1,useValue:t.callSetDisabledState??pD}]}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Gt({type:n})}static{this.\u0275inj=Ht({imports:[I6]})}}return n})();function D6(n,e){n&1&&(Te(0,"div",6),ke(1,"Name is required"),we())}function T6(n,e){n&1&&(Te(0,"div",6),ke(1,"position is required"),we())}function b6(n,e){n&1&&(Te(0,"div",6),ke(1,"department is required"),we())}function A6(n,e){n&1&&(Te(0,"div",6),ke(1,"salary is required"),we())}var _D=(()=>{class n{constructor(t,r,i,s){this.fb=t,this.employeeService=r,this.router=i,this.activatedRoute=s,this.employee=[],this.employeeId="",this.employeeForm=this.fb.group({name:new ci("",[lo.required]),position:new ci("",[lo.required]),department:new ci("",[lo.required]),salary:new ci("",[lo.required])})}ngOnInit(){this.activatedRoute.params.subscribe({next:t=>{this.employeeId=t.id,this.getEmployee(this.employeeId)}})}onSubmit(){this.employeeForm.valid?(this.employeeService.addEmployee(this.employeeForm.value),this.router.navigate(["/employee-list"])):this.employeeForm.markAllAsTouched()}getEmployee(t){this.employeeService.getEmployee(t).snapshotChanges().subscribe({next:r=>{let i=r.payload.toJSON();this.employeeForm.setValue(i)}})}static{this.\u0275fac=function(r){return new(r||n)(De(w1),De(zg),De(An),De(Ar))}}static{this.\u0275cmp=Un({type:n,selectors:[["app-add-edit-employee"]],standalone:!0,features:[Hn],decls:30,vars:5,consts:[[1,"row","mt-5"],[1,"col-lg-6"],[3,"submit","formGroup"],[1,"mb-3"],["for","name",1,"form-label"],["type","text","id","name","placeholder","name","formControlName","name",1,"form-control"],[1,"form-text","text-danger"],["for","position",1,"form-label"],["type","text","id","position","placeholder","position","formControlName","position",1,"form-control"],["for","department",1,"form-label"],["type","text","id","department","placeholder","Department","formControlName","department",1,"form-control"],["for","salary",1,"form-label"],["type","text","id","salary","placeholder","Salary","formControlName","salary",1,"form-control"],[1,"mb-4","d-flex","justify-content-between","align-items-center"],["type","submit",1,"btn","btn-primary"],["type","button","routerLink","/employee-list",1,"btn","btn-danger","ms-5"]],template:function(r,i){if(r&1&&(Te(0,"div",0)(1,"div",1)(2,"h4"),ke(3,"Employee Form"),we(),Te(4,"form",2),sr("submit",function(){return i.onSubmit()}),Te(5,"div",3)(6,"label",4),ke(7,"Name"),we(),qn(8,"input",5),ki(9,D6,2,0,"div",6),we(),Te(10,"div",3)(11,"label",7),ke(12,"Position"),we(),qn(13,"input",8),ki(14,T6,2,0,"div",6),we(),Te(15,"div",3)(16,"label",9),ke(17,"Department"),we(),qn(18,"input",10),ki(19,b6,2,0,"div",6),we(),Te(20,"div",3)(21,"label",11),ke(22,"salary"),we(),qn(23,"input",12),ki(24,A6,2,0,"div",6),we(),Te(25,"div",13)(26,"button",14),ke(27,"Save Changes"),we(),Te(28,"button",15),ke(29," Cancel "),we()()()()()),r&2){let s,o,a,u;$n(4),Pw("formGroup",i.employeeForm),$n(5),Zc(9,(s=i.employeeForm.get("name"))!=null&&s.hasError("required")&&((s=i.employeeForm.get("name"))!=null&&s.touched)?9:-1),$n(5),Zc(14,(o=i.employeeForm.get("position"))!=null&&o.hasError("required")&&((o=i.employeeForm.get("position"))!=null&&o.touched)?14:-1),$n(5),Zc(19,(a=i.employeeForm.get("department"))!=null&&a.hasError("required")&&((a=i.employeeForm.get("department"))!=null&&a.touched)?19:-1),$n(5),Zc(24,(u=i.employeeForm.get("salary"))!=null&&u.hasError("required")&&((u=i.employeeForm.get("salary"))!=null&&u.touched)?24:-1)}},dependencies:[Qs,La,Va,E1,_1,em,h1,f1,mD,yD]})}}return n})();var I1=[{path:"",component:IP},{path:"employee-list",component:UO,children:[{path:"employee-details",component:jE},{path:"employee-details/:id",component:jE}]},{path:"add-edit-employee",component:_D},{path:"add-edit-employee/:id",component:_D}];var C1="auth",yd=class{constructor(e){return e}},ho=class{constructor(){return Xs(C1)}};var vD=new H("angularfire2.auth-instances");function A5(n,e){let t=Ua(C1,n,e);return t&&new yd(t)}function S5(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new yd(r)}}var R5={provide:ho,deps:[[new tt,vD]]},x5={provide:yd,useFactory:A5,deps:[[new tt,vD],or]};function D1(n,...e){return it("angularfire",bt.full,"auth"),Xt([x5,R5,{provide:vD,useFactory:S5(n),multi:!0,deps:[le,Dt,pn,si,[new tt,nn],...e]}])}var T1=Gi(d_,!0);var b1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},A1={};var is,wD;(function(){var n;function e(I,_){function E(){}E.prototype=_.prototype,I.D=_.prototype,I.prototype=new E,I.prototype.constructor=I,I.C=function(C,T,S){for(var w=Array(arguments.length-2),Gr=2;Gr<arguments.length;Gr++)w[Gr-2]=arguments[Gr];return _.prototype[T].apply(C,w)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,_,E){E||(E=0);var C=Array(16);if(typeof _=="string")for(var T=0;16>T;++T)C[T]=_.charCodeAt(E++)|_.charCodeAt(E++)<<8|_.charCodeAt(E++)<<16|_.charCodeAt(E++)<<24;else for(T=0;16>T;++T)C[T]=_[E++]|_[E++]<<8|_[E++]<<16|_[E++]<<24;_=I.g[0],E=I.g[1],T=I.g[2];var S=I.g[3],w=_+(S^E&(T^S))+C[0]+3614090360&4294967295;_=E+(w<<7&4294967295|w>>>25),w=S+(T^_&(E^T))+C[1]+3905402710&4294967295,S=_+(w<<12&4294967295|w>>>20),w=T+(E^S&(_^E))+C[2]+606105819&4294967295,T=S+(w<<17&4294967295|w>>>15),w=E+(_^T&(S^_))+C[3]+3250441966&4294967295,E=T+(w<<22&4294967295|w>>>10),w=_+(S^E&(T^S))+C[4]+4118548399&4294967295,_=E+(w<<7&4294967295|w>>>25),w=S+(T^_&(E^T))+C[5]+1200080426&4294967295,S=_+(w<<12&4294967295|w>>>20),w=T+(E^S&(_^E))+C[6]+2821735955&4294967295,T=S+(w<<17&4294967295|w>>>15),w=E+(_^T&(S^_))+C[7]+4249261313&4294967295,E=T+(w<<22&4294967295|w>>>10),w=_+(S^E&(T^S))+C[8]+1770035416&4294967295,_=E+(w<<7&4294967295|w>>>25),w=S+(T^_&(E^T))+C[9]+2336552879&4294967295,S=_+(w<<12&4294967295|w>>>20),w=T+(E^S&(_^E))+C[10]+4294925233&4294967295,T=S+(w<<17&4294967295|w>>>15),w=E+(_^T&(S^_))+C[11]+2304563134&4294967295,E=T+(w<<22&4294967295|w>>>10),w=_+(S^E&(T^S))+C[12]+1804603682&4294967295,_=E+(w<<7&4294967295|w>>>25),w=S+(T^_&(E^T))+C[13]+4254626195&4294967295,S=_+(w<<12&4294967295|w>>>20),w=T+(E^S&(_^E))+C[14]+2792965006&4294967295,T=S+(w<<17&4294967295|w>>>15),w=E+(_^T&(S^_))+C[15]+1236535329&4294967295,E=T+(w<<22&4294967295|w>>>10),w=_+(T^S&(E^T))+C[1]+4129170786&4294967295,_=E+(w<<5&4294967295|w>>>27),w=S+(E^T&(_^E))+C[6]+3225465664&4294967295,S=_+(w<<9&4294967295|w>>>23),w=T+(_^E&(S^_))+C[11]+643717713&4294967295,T=S+(w<<14&4294967295|w>>>18),w=E+(S^_&(T^S))+C[0]+3921069994&4294967295,E=T+(w<<20&4294967295|w>>>12),w=_+(T^S&(E^T))+C[5]+3593408605&4294967295,_=E+(w<<5&4294967295|w>>>27),w=S+(E^T&(_^E))+C[10]+38016083&4294967295,S=_+(w<<9&4294967295|w>>>23),w=T+(_^E&(S^_))+C[15]+3634488961&4294967295,T=S+(w<<14&4294967295|w>>>18),w=E+(S^_&(T^S))+C[4]+3889429448&4294967295,E=T+(w<<20&4294967295|w>>>12),w=_+(T^S&(E^T))+C[9]+568446438&4294967295,_=E+(w<<5&4294967295|w>>>27),w=S+(E^T&(_^E))+C[14]+3275163606&4294967295,S=_+(w<<9&4294967295|w>>>23),w=T+(_^E&(S^_))+C[3]+4107603335&4294967295,T=S+(w<<14&4294967295|w>>>18),w=E+(S^_&(T^S))+C[8]+1163531501&4294967295,E=T+(w<<20&4294967295|w>>>12),w=_+(T^S&(E^T))+C[13]+2850285829&4294967295,_=E+(w<<5&4294967295|w>>>27),w=S+(E^T&(_^E))+C[2]+4243563512&4294967295,S=_+(w<<9&4294967295|w>>>23),w=T+(_^E&(S^_))+C[7]+1735328473&4294967295,T=S+(w<<14&4294967295|w>>>18),w=E+(S^_&(T^S))+C[12]+2368359562&4294967295,E=T+(w<<20&4294967295|w>>>12),w=_+(E^T^S)+C[5]+4294588738&4294967295,_=E+(w<<4&4294967295|w>>>28),w=S+(_^E^T)+C[8]+2272392833&4294967295,S=_+(w<<11&4294967295|w>>>21),w=T+(S^_^E)+C[11]+1839030562&4294967295,T=S+(w<<16&4294967295|w>>>16),w=E+(T^S^_)+C[14]+4259657740&4294967295,E=T+(w<<23&4294967295|w>>>9),w=_+(E^T^S)+C[1]+2763975236&4294967295,_=E+(w<<4&4294967295|w>>>28),w=S+(_^E^T)+C[4]+1272893353&4294967295,S=_+(w<<11&4294967295|w>>>21),w=T+(S^_^E)+C[7]+4139469664&4294967295,T=S+(w<<16&4294967295|w>>>16),w=E+(T^S^_)+C[10]+3200236656&4294967295,E=T+(w<<23&4294967295|w>>>9),w=_+(E^T^S)+C[13]+681279174&4294967295,_=E+(w<<4&4294967295|w>>>28),w=S+(_^E^T)+C[0]+3936430074&4294967295,S=_+(w<<11&4294967295|w>>>21),w=T+(S^_^E)+C[3]+3572445317&4294967295,T=S+(w<<16&4294967295|w>>>16),w=E+(T^S^_)+C[6]+76029189&4294967295,E=T+(w<<23&4294967295|w>>>9),w=_+(E^T^S)+C[9]+3654602809&4294967295,_=E+(w<<4&4294967295|w>>>28),w=S+(_^E^T)+C[12]+3873151461&4294967295,S=_+(w<<11&4294967295|w>>>21),w=T+(S^_^E)+C[15]+530742520&4294967295,T=S+(w<<16&4294967295|w>>>16),w=E+(T^S^_)+C[2]+3299628645&4294967295,E=T+(w<<23&4294967295|w>>>9),w=_+(T^(E|~S))+C[0]+4096336452&4294967295,_=E+(w<<6&4294967295|w>>>26),w=S+(E^(_|~T))+C[7]+1126891415&4294967295,S=_+(w<<10&4294967295|w>>>22),w=T+(_^(S|~E))+C[14]+2878612391&4294967295,T=S+(w<<15&4294967295|w>>>17),w=E+(S^(T|~_))+C[5]+4237533241&4294967295,E=T+(w<<21&4294967295|w>>>11),w=_+(T^(E|~S))+C[12]+1700485571&4294967295,_=E+(w<<6&4294967295|w>>>26),w=S+(E^(_|~T))+C[3]+2399980690&4294967295,S=_+(w<<10&4294967295|w>>>22),w=T+(_^(S|~E))+C[10]+4293915773&4294967295,T=S+(w<<15&4294967295|w>>>17),w=E+(S^(T|~_))+C[1]+2240044497&4294967295,E=T+(w<<21&4294967295|w>>>11),w=_+(T^(E|~S))+C[8]+1873313359&4294967295,_=E+(w<<6&4294967295|w>>>26),w=S+(E^(_|~T))+C[15]+4264355552&4294967295,S=_+(w<<10&4294967295|w>>>22),w=T+(_^(S|~E))+C[6]+2734768916&4294967295,T=S+(w<<15&4294967295|w>>>17),w=E+(S^(T|~_))+C[13]+1309151649&4294967295,E=T+(w<<21&4294967295|w>>>11),w=_+(T^(E|~S))+C[4]+4149444226&4294967295,_=E+(w<<6&4294967295|w>>>26),w=S+(E^(_|~T))+C[11]+3174756917&4294967295,S=_+(w<<10&4294967295|w>>>22),w=T+(_^(S|~E))+C[2]+718787259&4294967295,T=S+(w<<15&4294967295|w>>>17),w=E+(S^(T|~_))+C[9]+3951481745&4294967295,I.g[0]=I.g[0]+_&4294967295,I.g[1]=I.g[1]+(T+(w<<21&4294967295|w>>>11))&4294967295,I.g[2]=I.g[2]+T&4294967295,I.g[3]=I.g[3]+S&4294967295}r.prototype.u=function(I,_){_===void 0&&(_=I.length);for(var E=_-this.blockSize,C=this.B,T=this.h,S=0;S<_;){if(T==0)for(;S<=E;)i(this,I,S),S+=this.blockSize;if(typeof I=="string"){for(;S<_;)if(C[T++]=I.charCodeAt(S++),T==this.blockSize){i(this,C),T=0;break}}else for(;S<_;)if(C[T++]=I[S++],T==this.blockSize){i(this,C),T=0;break}}this.h=T,this.o+=_},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var _=1;_<I.length-8;++_)I[_]=0;var E=8*this.o;for(_=I.length-8;_<I.length;++_)I[_]=E&255,E/=256;for(this.u(I),I=Array(16),_=E=0;4>_;++_)for(var C=0;32>C;C+=8)I[E++]=this.g[_]>>>C&255;return I};function s(I,_){var E=a;return Object.prototype.hasOwnProperty.call(E,I)?E[I]:E[I]=_(I)}function o(I,_){this.h=_;for(var E=[],C=!0,T=I.length-1;0<=T;T--){var S=I[T]|0;C&&S==_||(E[T]=S,C=!1)}this.g=E}var a={};function u(I){return-128<=I&&128>I?s(I,function(_){return new o([_|0],0>_?-1:0)}):new o([I|0],0>I?-1:0)}function l(I){if(isNaN(I)||!isFinite(I))return h;if(0>I)return A(l(-I));for(var _=[],E=1,C=0;I>=E;C++)_[C]=I/E|0,E*=4294967296;return new o(_,0)}function d(I,_){if(I.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(I.charAt(0)=="-")return A(d(I.substring(1),_));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=l(Math.pow(_,8)),C=h,T=0;T<I.length;T+=8){var S=Math.min(8,I.length-T),w=parseInt(I.substring(T,T+S),_);8>S?(S=l(Math.pow(_,S)),C=C.j(S).add(l(w))):(C=C.j(E),C=C.add(l(w)))}return C}var h=u(0),g=u(1),y=u(16777216);n=o.prototype,n.m=function(){if(D(this))return-A(this).m();for(var I=0,_=1,E=0;E<this.g.length;E++){var C=this.i(E);I+=(0<=C?C:4294967296+C)*_,_*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(v(this))return"0";if(D(this))return"-"+A(this).toString(I);for(var _=l(Math.pow(I,6)),E=this,C="";;){var T=K(E,_).g;E=P(E,T.j(_));var S=((0<E.g.length?E.g[0]:E.h)>>>0).toString(I);if(E=T,v(E))return S+C;for(;6>S.length;)S="0"+S;C=S+C}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function v(I){if(I.h!=0)return!1;for(var _=0;_<I.g.length;_++)if(I.g[_]!=0)return!1;return!0}function D(I){return I.h==-1}n.l=function(I){return I=P(this,I),D(I)?-1:v(I)?0:1};function A(I){for(var _=I.g.length,E=[],C=0;C<_;C++)E[C]=~I.g[C];return new o(E,~I.h).add(g)}n.abs=function(){return D(this)?A(this):this},n.add=function(I){for(var _=Math.max(this.g.length,I.g.length),E=[],C=0,T=0;T<=_;T++){var S=C+(this.i(T)&65535)+(I.i(T)&65535),w=(S>>>16)+(this.i(T)>>>16)+(I.i(T)>>>16);C=w>>>16,S&=65535,w&=65535,E[T]=w<<16|S}return new o(E,E[E.length-1]&-2147483648?-1:0)};function P(I,_){return I.add(A(_))}n.j=function(I){if(v(this)||v(I))return h;if(D(this))return D(I)?A(this).j(A(I)):A(A(this).j(I));if(D(I))return A(this.j(A(I)));if(0>this.l(y)&&0>I.l(y))return l(this.m()*I.m());for(var _=this.g.length+I.g.length,E=[],C=0;C<2*_;C++)E[C]=0;for(C=0;C<this.g.length;C++)for(var T=0;T<I.g.length;T++){var S=this.i(C)>>>16,w=this.i(C)&65535,Gr=I.i(T)>>>16,Yu=I.i(T)&65535;E[2*C+2*T]+=w*Yu,B(E,2*C+2*T),E[2*C+2*T+1]+=S*Yu,B(E,2*C+2*T+1),E[2*C+2*T+1]+=w*Gr,B(E,2*C+2*T+1),E[2*C+2*T+2]+=S*Gr,B(E,2*C+2*T+2)}for(C=0;C<_;C++)E[C]=E[2*C+1]<<16|E[2*C];for(C=_;C<2*_;C++)E[C]=0;return new o(E,0)};function B(I,_){for(;(I[_]&65535)!=I[_];)I[_+1]+=I[_]>>>16,I[_]&=65535,_++}function F(I,_){this.g=I,this.h=_}function K(I,_){if(v(_))throw Error("division by zero");if(v(I))return new F(h,h);if(D(I))return _=K(A(I),_),new F(A(_.g),A(_.h));if(D(_))return _=K(I,A(_)),new F(A(_.g),_.h);if(30<I.g.length){if(D(I)||D(_))throw Error("slowDivide_ only works with positive integers.");for(var E=g,C=_;0>=C.l(I);)E=te(E),C=te(C);var T=X(E,1),S=X(C,1);for(C=X(C,2),E=X(E,2);!v(C);){var w=S.add(C);0>=w.l(I)&&(T=T.add(E),S=w),C=X(C,1),E=X(E,1)}return _=P(I,T.j(_)),new F(T,_)}for(T=h;0<=I.l(_);){for(E=Math.max(1,Math.floor(I.m()/_.m())),C=Math.ceil(Math.log(E)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),S=l(E),w=S.j(_);D(w)||0<w.l(I);)E-=C,S=l(E),w=S.j(_);v(S)&&(S=g),T=T.add(S),I=P(I,w)}return new F(T,I)}n.A=function(I){return K(this,I).h},n.and=function(I){for(var _=Math.max(this.g.length,I.g.length),E=[],C=0;C<_;C++)E[C]=this.i(C)&I.i(C);return new o(E,this.h&I.h)},n.or=function(I){for(var _=Math.max(this.g.length,I.g.length),E=[],C=0;C<_;C++)E[C]=this.i(C)|I.i(C);return new o(E,this.h|I.h)},n.xor=function(I){for(var _=Math.max(this.g.length,I.g.length),E=[],C=0;C<_;C++)E[C]=this.i(C)^I.i(C);return new o(E,this.h^I.h)};function te(I){for(var _=I.g.length+1,E=[],C=0;C<_;C++)E[C]=I.i(C)<<1|I.i(C-1)>>>31;return new o(E,I.h)}function X(I,_){var E=_>>5;_%=32;for(var C=I.g.length-E,T=[],S=0;S<C;S++)T[S]=0<_?I.i(S+E)>>>_|I.i(S+E+1)<<32-_:I.i(S+E);return new o(T,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,wD=A1.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=d,is=A1.Integer=o}).apply(typeof b1<"u"?b1:typeof self<"u"?self:typeof window<"u"?window:{});var nm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},li={};var ED,M5,uu,ID,_d,rm,CD,DD,TD;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,f,p){return c==Array.prototype||c==Object.prototype||(c[f]=p.value),c};function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof nm=="object"&&nm];for(var f=0;f<c.length;++f){var p=c[f];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function i(c,f){if(f)e:{var p=r;c=c.split(".");for(var m=0;m<c.length-1;m++){var b=c[m];if(!(b in p))break e;p=p[b]}c=c[c.length-1],m=p[c],f=f(m),f!=m&&f!=null&&e(p,c,{configurable:!0,writable:!0,value:f})}}function s(c,f){c instanceof String&&(c+="");var p=0,m=!1,b={next:function(){if(!m&&p<c.length){var M=p++;return{value:f(M,c[M]),done:!1}}return m=!0,{done:!0,value:void 0}}};return b[Symbol.iterator]=function(){return b},b}i("Array.prototype.values",function(c){return c||function(){return s(this,function(f,p){return p})}});var o=o||{},a=this||self;function u(c){var f=typeof c;return f=f!="object"?f:c?Array.isArray(c)?"array":f:"null",f=="array"||f=="object"&&typeof c.length=="number"}function l(c){var f=typeof c;return f=="object"&&c!=null||f=="function"}function d(c,f,p){return c.call.apply(c.bind,arguments)}function h(c,f,p){if(!c)throw Error();if(2<arguments.length){var m=Array.prototype.slice.call(arguments,2);return function(){var b=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(b,m),c.apply(f,b)}}return function(){return c.apply(f,arguments)}}function g(c,f,p){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,g.apply(null,arguments)}function y(c,f){var p=Array.prototype.slice.call(arguments,1);return function(){var m=p.slice();return m.push.apply(m,arguments),c.apply(this,m)}}function v(c,f){function p(){}p.prototype=f.prototype,c.aa=f.prototype,c.prototype=new p,c.prototype.constructor=c,c.Qb=function(m,b,M){for(var U=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)U[Fe-2]=arguments[Fe];return f.prototype[b].apply(m,U)}}function D(c){let f=c.length;if(0<f){let p=Array(f);for(let m=0;m<f;m++)p[m]=c[m];return p}return[]}function A(c,f){for(let p=1;p<arguments.length;p++){let m=arguments[p];if(u(m)){let b=c.length||0,M=m.length||0;c.length=b+M;for(let U=0;U<M;U++)c[b+U]=m[U]}else c.push(m)}}class P{constructor(f,p){this.i=f,this.j=p,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function B(c){return/^[\s\xa0]*$/.test(c)}function F(){var c=a.navigator;return c&&(c=c.userAgent)?c:""}function K(c){return K[" "](c),c}K[" "]=function(){};var te=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function X(c,f,p){for(let m in c)f.call(p,c[m],m,c)}function I(c,f){for(let p in c)f.call(void 0,c[p],p,c)}function _(c){let f={};for(let p in c)f[p]=c[p];return f}let E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(c,f){let p,m;for(let b=1;b<arguments.length;b++){m=arguments[b];for(p in m)c[p]=m[p];for(let M=0;M<E.length;M++)p=E[M],Object.prototype.hasOwnProperty.call(m,p)&&(c[p]=m[p])}}function T(c){var f=1;c=c.split(":");let p=[];for(;0<f&&c.length;)p.push(c.shift()),f--;return c.length&&p.push(c.join(":")),p}function S(c){a.setTimeout(()=>{throw c},0)}function w(){var c=ky;let f=null;return c.g&&(f=c.g,c.g=c.g.next,c.g||(c.h=null),f.next=null),f}class Gr{constructor(){this.h=this.g=null}add(f,p){let m=Yu.get();m.set(f,p),this.h?this.h.next=m:this.g=m,this.h=m}}var Yu=new P(()=>new LL,c=>c.reset());class LL{constructor(){this.next=this.g=this.h=null}set(f,p){this.h=f,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let Zu,Ju=!1,ky=new Gr,rA=()=>{let c=a.Promise.resolve(void 0);Zu=()=>{c.then(jL)}};var jL=()=>{for(var c;c=w();){try{c.h.call(c.g)}catch(p){S(p)}var f=Yu;f.j(c),100>f.h&&(f.h++,c.next=f.g,f.g=c)}Ju=!1};function vi(){this.s=this.s,this.C=this.C}vi.prototype.s=!1,vi.prototype.ma=function(){this.s||(this.s=!0,this.N())},vi.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ot(c,f){this.type=c,this.g=this.target=f,this.defaultPrevented=!1}Ot.prototype.h=function(){this.defaultPrevented=!0};var UL=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var c=!1,f=Object.defineProperty({},"passive",{get:function(){c=!0}});try{let p=()=>{};a.addEventListener("test",p,f),a.removeEventListener("test",p,f)}catch{}return c}();function Xu(c,f){if(Ot.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var p=this.type=c.type,m=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=f,f=c.relatedTarget){if(te){e:{try{K(f.nodeName);var b=!0;break e}catch{}b=!1}b||(f=null)}}else p=="mouseover"?f=c.fromElement:p=="mouseout"&&(f=c.toElement);this.relatedTarget=f,m?(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:BL[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&Xu.aa.h.call(this)}}v(Xu,Ot);var BL={2:"touch",3:"pen",4:"mouse"};Xu.prototype.h=function(){Xu.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var ec="closure_listenable_"+(1e6*Math.random()|0),$L=0;function qL(c,f,p,m,b){this.listener=c,this.proxy=null,this.src=f,this.type=p,this.capture=!!m,this.ha=b,this.key=++$L,this.da=this.fa=!1}function oh(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function ah(c){this.src=c,this.g={},this.h=0}ah.prototype.add=function(c,f,p,m,b){var M=c.toString();c=this.g[M],c||(c=this.g[M]=[],this.h++);var U=Fy(c,f,m,b);return-1<U?(f=c[U],p||(f.fa=!1)):(f=new qL(f,this.src,M,!!m,b),f.fa=p,c.push(f)),f};function Oy(c,f){var p=f.type;if(p in c.g){var m=c.g[p],b=Array.prototype.indexOf.call(m,f,void 0),M;(M=0<=b)&&Array.prototype.splice.call(m,b,1),M&&(oh(f),c.g[p].length==0&&(delete c.g[p],c.h--))}}function Fy(c,f,p,m){for(var b=0;b<c.length;++b){var M=c[b];if(!M.da&&M.listener==f&&M.capture==!!p&&M.ha==m)return b}return-1}var Vy="closure_lm_"+(1e6*Math.random()|0),Ly={};function iA(c,f,p,m,b){if(m&&m.once)return oA(c,f,p,m,b);if(Array.isArray(f)){for(var M=0;M<f.length;M++)iA(c,f[M],p,m,b);return null}return p=$y(p),c&&c[ec]?c.K(f,p,l(m)?!!m.capture:!!m,b):sA(c,f,p,!1,m,b)}function sA(c,f,p,m,b,M){if(!f)throw Error("Invalid event type");var U=l(b)?!!b.capture:!!b,Fe=Uy(c);if(Fe||(c[Vy]=Fe=new ah(c)),p=Fe.add(f,p,m,U,M),p.proxy)return p;if(m=HL(),p.proxy=m,m.src=c,m.listener=p,c.addEventListener)UL||(b=U),b===void 0&&(b=!1),c.addEventListener(f.toString(),m,b);else if(c.attachEvent)c.attachEvent(uA(f.toString()),m);else if(c.addListener&&c.removeListener)c.addListener(m);else throw Error("addEventListener and attachEvent are unavailable.");return p}function HL(){function c(p){return f.call(c.src,c.listener,p)}let f=GL;return c}function oA(c,f,p,m,b){if(Array.isArray(f)){for(var M=0;M<f.length;M++)oA(c,f[M],p,m,b);return null}return p=$y(p),c&&c[ec]?c.L(f,p,l(m)?!!m.capture:!!m,b):sA(c,f,p,!0,m,b)}function aA(c,f,p,m,b){if(Array.isArray(f))for(var M=0;M<f.length;M++)aA(c,f[M],p,m,b);else m=l(m)?!!m.capture:!!m,p=$y(p),c&&c[ec]?(c=c.i,f=String(f).toString(),f in c.g&&(M=c.g[f],p=Fy(M,p,m,b),-1<p&&(oh(M[p]),Array.prototype.splice.call(M,p,1),M.length==0&&(delete c.g[f],c.h--)))):c&&(c=Uy(c))&&(f=c.g[f.toString()],c=-1,f&&(c=Fy(f,p,m,b)),(p=-1<c?f[c]:null)&&jy(p))}function jy(c){if(typeof c!="number"&&c&&!c.da){var f=c.src;if(f&&f[ec])Oy(f.i,c);else{var p=c.type,m=c.proxy;f.removeEventListener?f.removeEventListener(p,m,c.capture):f.detachEvent?f.detachEvent(uA(p),m):f.addListener&&f.removeListener&&f.removeListener(m),(p=Uy(f))?(Oy(p,c),p.h==0&&(p.src=null,f[Vy]=null)):oh(c)}}}function uA(c){return c in Ly?Ly[c]:Ly[c]="on"+c}function GL(c,f){if(c.da)c=!0;else{f=new Xu(f,this);var p=c.listener,m=c.ha||c.src;c.fa&&jy(c),c=p.call(m,f)}return c}function Uy(c){return c=c[Vy],c instanceof ah?c:null}var By="__closure_events_fn_"+(1e9*Math.random()>>>0);function $y(c){return typeof c=="function"?c:(c[By]||(c[By]=function(f){return c.handleEvent(f)}),c[By])}function Ft(){vi.call(this),this.i=new ah(this),this.M=this,this.F=null}v(Ft,vi),Ft.prototype[ec]=!0,Ft.prototype.removeEventListener=function(c,f,p,m){aA(this,c,f,p,m)};function Qt(c,f){var p,m=c.F;if(m)for(p=[];m;m=m.F)p.push(m);if(c=c.M,m=f.type||f,typeof f=="string")f=new Ot(f,c);else if(f instanceof Ot)f.target=f.target||c;else{var b=f;f=new Ot(m,c),C(f,b)}if(b=!0,p)for(var M=p.length-1;0<=M;M--){var U=f.g=p[M];b=uh(U,m,!0,f)&&b}if(U=f.g=c,b=uh(U,m,!0,f)&&b,b=uh(U,m,!1,f)&&b,p)for(M=0;M<p.length;M++)U=f.g=p[M],b=uh(U,m,!1,f)&&b}Ft.prototype.N=function(){if(Ft.aa.N.call(this),this.i){var c=this.i,f;for(f in c.g){for(var p=c.g[f],m=0;m<p.length;m++)oh(p[m]);delete c.g[f],c.h--}}this.F=null},Ft.prototype.K=function(c,f,p,m){return this.i.add(String(c),f,!1,p,m)},Ft.prototype.L=function(c,f,p,m){return this.i.add(String(c),f,!0,p,m)};function uh(c,f,p,m){if(f=c.i.g[String(f)],!f)return!0;f=f.concat();for(var b=!0,M=0;M<f.length;++M){var U=f[M];if(U&&!U.da&&U.capture==p){var Fe=U.listener,Rt=U.ha||U.src;U.fa&&Oy(c.i,U),b=Fe.call(Rt,m)!==!1&&b}}return b&&!m.defaultPrevented}function cA(c,f,p){if(typeof c=="function")p&&(c=g(c,p));else if(c&&typeof c.handleEvent=="function")c=g(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(c,f||0)}function lA(c){c.g=cA(()=>{c.g=null,c.i&&(c.i=!1,lA(c))},c.l);let f=c.h;c.h=null,c.m.apply(null,f)}class zL extends vi{constructor(f,p){super(),this.m=f,this.l=p,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:lA(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function tc(c){vi.call(this),this.h=c,this.g={}}v(tc,vi);var dA=[];function hA(c){X(c.g,function(f,p){this.g.hasOwnProperty(p)&&jy(f)},c),c.g={}}tc.prototype.N=function(){tc.aa.N.call(this),hA(this)},tc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var qy=a.JSON.stringify,WL=a.JSON.parse,KL=class{stringify(c){return a.JSON.stringify(c,void 0)}parse(c){return a.JSON.parse(c,void 0)}};function Hy(){}Hy.prototype.h=null;function fA(c){return c.h||(c.h=c.i())}function pA(){}var nc={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Gy(){Ot.call(this,"d")}v(Gy,Ot);function zy(){Ot.call(this,"c")}v(zy,Ot);var Ds={},gA=null;function ch(){return gA=gA||new Ft}Ds.La="serverreachability";function mA(c){Ot.call(this,Ds.La,c)}v(mA,Ot);function rc(c){let f=ch();Qt(f,new mA(f))}Ds.STAT_EVENT="statevent";function yA(c,f){Ot.call(this,Ds.STAT_EVENT,c),this.stat=f}v(yA,Ot);function Yt(c){let f=ch();Qt(f,new yA(f,c))}Ds.Ma="timingevent";function _A(c,f){Ot.call(this,Ds.Ma,c),this.size=f}v(_A,Ot);function ic(c,f){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){c()},f)}function sc(){this.g=!0}sc.prototype.xa=function(){this.g=!1};function QL(c,f,p,m,b,M){c.info(function(){if(c.g)if(M)for(var U="",Fe=M.split("&"),Rt=0;Rt<Fe.length;Rt++){var Re=Fe[Rt].split("=");if(1<Re.length){var Vt=Re[0];Re=Re[1];var Lt=Vt.split("_");U=2<=Lt.length&&Lt[1]=="type"?U+(Vt+"="+Re+"&"):U+(Vt+"=redacted&")}}else U=null;else U=M;return"XMLHTTP REQ ("+m+") [attempt "+b+"]: "+f+`
`+p+`
`+U})}function YL(c,f,p,m,b,M,U){c.info(function(){return"XMLHTTP RESP ("+m+") [ attempt "+b+"]: "+f+`
`+p+`
`+M+" "+U})}function jo(c,f,p,m){c.info(function(){return"XMLHTTP TEXT ("+f+"): "+JL(c,p)+(m?" "+m:"")})}function ZL(c,f){c.info(function(){return"TIMEOUT: "+f})}sc.prototype.info=function(){};function JL(c,f){if(!c.g)return f;if(!f)return null;try{var p=JSON.parse(f);if(p){for(c=0;c<p.length;c++)if(Array.isArray(p[c])){var m=p[c];if(!(2>m.length)){var b=m[1];if(Array.isArray(b)&&!(1>b.length)){var M=b[0];if(M!="noop"&&M!="stop"&&M!="close")for(var U=1;U<b.length;U++)b[U]=""}}}}return qy(p)}catch{return f}}var lh={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},vA={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Wy;function dh(){}v(dh,Hy),dh.prototype.g=function(){return new XMLHttpRequest},dh.prototype.i=function(){return{}},Wy=new dh;function wi(c,f,p,m){this.j=c,this.i=f,this.l=p,this.R=m||1,this.U=new tc(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new wA}function wA(){this.i=null,this.g="",this.h=!1}var EA={},Ky={};function Qy(c,f,p){c.L=1,c.v=gh(zr(f)),c.m=p,c.P=!0,IA(c,null)}function IA(c,f){c.F=Date.now(),hh(c),c.A=zr(c.v);var p=c.A,m=c.R;Array.isArray(m)||(m=[String(m)]),FA(p.i,"t",m),c.C=0,p=c.j.J,c.h=new wA,c.g=eS(c.j,p?f:null,!c.m),0<c.O&&(c.M=new zL(g(c.Y,c,c.g),c.O)),f=c.U,p=c.g,m=c.ca;var b="readystatechange";Array.isArray(b)||(b&&(dA[0]=b.toString()),b=dA);for(var M=0;M<b.length;M++){var U=iA(p,b[M],m||f.handleEvent,!1,f.h||f);if(!U)break;f.g[U.key]=U}f=c.H?_(c.H):{},c.m?(c.u||(c.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,f)):(c.u="GET",c.g.ea(c.A,c.u,null,f)),rc(),QL(c.i,c.u,c.A,c.l,c.R,c.m)}wi.prototype.ca=function(c){c=c.target;let f=this.M;f&&Wr(c)==3?f.j():this.Y(c)},wi.prototype.Y=function(c){try{if(c==this.g)e:{let Lt=Wr(this.g);var f=this.g.Ba();let $o=this.g.Z();if(!(3>Lt)&&(Lt!=3||this.g&&(this.h.h||this.g.oa()||qA(this.g)))){this.J||Lt!=4||f==7||(f==8||0>=$o?rc(3):rc(2)),Yy(this);var p=this.g.Z();this.X=p;t:if(CA(this)){var m=qA(this.g);c="";var b=m.length,M=Wr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ts(this),oc(this);var U="";break t}this.h.i=new a.TextDecoder}for(f=0;f<b;f++)this.h.h=!0,c+=this.h.i.decode(m[f],{stream:!(M&&f==b-1)});m.length=0,this.h.g+=c,this.C=0,U=this.h.g}else U=this.g.oa();if(this.o=p==200,YL(this.i,this.u,this.A,this.l,this.R,Lt,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Fe,Rt=this.g;if((Fe=Rt.g?Rt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(Fe)){var Re=Fe;break t}}Re=null}if(p=Re)jo(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Zy(this,p);else{this.o=!1,this.s=3,Yt(12),Ts(this),oc(this);break e}}if(this.P){p=!0;let Zn;for(;!this.J&&this.C<U.length;)if(Zn=XL(this,U),Zn==Ky){Lt==4&&(this.s=4,Yt(14),p=!1),jo(this.i,this.l,null,"[Incomplete Response]");break}else if(Zn==EA){this.s=4,Yt(15),jo(this.i,this.l,U,"[Invalid Chunk]"),p=!1;break}else jo(this.i,this.l,Zn,null),Zy(this,Zn);if(CA(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Lt!=4||U.length!=0||this.h.h||(this.s=1,Yt(16),p=!1),this.o=this.o&&p,!p)jo(this.i,this.l,U,"[Invalid Chunked Response]"),Ts(this),oc(this);else if(0<U.length&&!this.W){this.W=!0;var Vt=this.j;Vt.g==this&&Vt.ba&&!Vt.M&&(Vt.j.info("Great, no buffering proxy detected. Bytes received: "+U.length),r_(Vt),Vt.M=!0,Yt(11))}}else jo(this.i,this.l,U,null),Zy(this,U);Lt==4&&Ts(this),this.o&&!this.J&&(Lt==4?YA(this.j,this):(this.o=!1,hh(this)))}else mj(this.g),p==400&&0<U.indexOf("Unknown SID")?(this.s=3,Yt(12)):(this.s=0,Yt(13)),Ts(this),oc(this)}}}catch{}finally{}};function CA(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function XL(c,f){var p=c.C,m=f.indexOf(`
`,p);return m==-1?Ky:(p=Number(f.substring(p,m)),isNaN(p)?EA:(m+=1,m+p>f.length?Ky:(f=f.slice(m,m+p),c.C=m+p,f)))}wi.prototype.cancel=function(){this.J=!0,Ts(this)};function hh(c){c.S=Date.now()+c.I,DA(c,c.I)}function DA(c,f){if(c.B!=null)throw Error("WatchDog timer not null");c.B=ic(g(c.ba,c),f)}function Yy(c){c.B&&(a.clearTimeout(c.B),c.B=null)}wi.prototype.ba=function(){this.B=null;let c=Date.now();0<=c-this.S?(ZL(this.i,this.A),this.L!=2&&(rc(),Yt(17)),Ts(this),this.s=2,oc(this)):DA(this,this.S-c)};function oc(c){c.j.G==0||c.J||YA(c.j,c)}function Ts(c){Yy(c);var f=c.M;f&&typeof f.ma=="function"&&f.ma(),c.M=null,hA(c.U),c.g&&(f=c.g,c.g=null,f.abort(),f.ma())}function Zy(c,f){try{var p=c.j;if(p.G!=0&&(p.g==c||Jy(p.h,c))){if(!c.K&&Jy(p.h,c)&&p.G==3){try{var m=p.Da.g.parse(f)}catch{m=null}if(Array.isArray(m)&&m.length==3){var b=m;if(b[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<c.F)wh(p),_h(p);else break e;n_(p),Yt(18)}}else p.za=b[1],0<p.za-p.T&&37500>b[2]&&p.F&&p.v==0&&!p.C&&(p.C=ic(g(p.Za,p),6e3));if(1>=AA(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else As(p,11)}else if((c.K||p.g==c)&&wh(p),!B(f))for(b=p.Da.g.parse(f),f=0;f<b.length;f++){let Re=b[f];if(p.T=Re[0],Re=Re[1],p.G==2)if(Re[0]=="c"){p.K=Re[1],p.ia=Re[2];let Vt=Re[3];Vt!=null&&(p.la=Vt,p.j.info("VER="+p.la));let Lt=Re[4];Lt!=null&&(p.Aa=Lt,p.j.info("SVER="+p.Aa));let $o=Re[5];$o!=null&&typeof $o=="number"&&0<$o&&(m=1.5*$o,p.L=m,p.j.info("backChannelRequestTimeoutMs_="+m)),m=p;let Zn=c.g;if(Zn){let Ih=Zn.g?Zn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ih){var M=m.h;M.g||Ih.indexOf("spdy")==-1&&Ih.indexOf("quic")==-1&&Ih.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(Xy(M,M.h),M.h=null))}if(m.D){let i_=Zn.g?Zn.g.getResponseHeader("X-HTTP-Session-Id"):null;i_&&(m.ya=i_,qe(m.I,m.D,i_))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-c.F,p.j.info("Handshake RTT: "+p.R+"ms")),m=p;var U=c;if(m.qa=XA(m,m.J?m.ia:null,m.W),U.K){SA(m.h,U);var Fe=U,Rt=m.L;Rt&&(Fe.I=Rt),Fe.B&&(Yy(Fe),hh(Fe)),m.g=U}else KA(m);0<p.i.length&&vh(p)}else Re[0]!="stop"&&Re[0]!="close"||As(p,7);else p.G==3&&(Re[0]=="stop"||Re[0]=="close"?Re[0]=="stop"?As(p,7):t_(p):Re[0]!="noop"&&p.l&&p.l.ta(Re),p.v=0)}}rc(4)}catch{}}var ej=class{constructor(c,f){this.g=c,this.map=f}};function TA(c){this.l=c||10,a.PerformanceNavigationTiming?(c=a.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function bA(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function AA(c){return c.h?1:c.g?c.g.size:0}function Jy(c,f){return c.h?c.h==f:c.g?c.g.has(f):!1}function Xy(c,f){c.g?c.g.add(f):c.h=f}function SA(c,f){c.h&&c.h==f?c.h=null:c.g&&c.g.has(f)&&c.g.delete(f)}TA.prototype.cancel=function(){if(this.i=RA(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let c of this.g.values())c.cancel();this.g.clear()}};function RA(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let f=c.i;for(let p of c.g.values())f=f.concat(p.D);return f}return D(c.i)}function tj(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(u(c)){for(var f=[],p=c.length,m=0;m<p;m++)f.push(c[m]);return f}f=[],p=0;for(m in c)f[p++]=c[m];return f}function nj(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(u(c)||typeof c=="string"){var f=[];c=c.length;for(var p=0;p<c;p++)f.push(p);return f}f=[],p=0;for(let m in c)f[p++]=m;return f}}}function xA(c,f){if(c.forEach&&typeof c.forEach=="function")c.forEach(f,void 0);else if(u(c)||typeof c=="string")Array.prototype.forEach.call(c,f,void 0);else for(var p=nj(c),m=tj(c),b=m.length,M=0;M<b;M++)f.call(void 0,m[M],p&&p[M],c)}var MA=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function rj(c,f){if(c){c=c.split("&");for(var p=0;p<c.length;p++){var m=c[p].indexOf("="),b=null;if(0<=m){var M=c[p].substring(0,m);b=c[p].substring(m+1)}else M=c[p];f(M,b?decodeURIComponent(b.replace(/\+/g," ")):"")}}}function bs(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof bs){this.h=c.h,fh(this,c.j),this.o=c.o,this.g=c.g,ph(this,c.s),this.l=c.l;var f=c.i,p=new cc;p.i=f.i,f.g&&(p.g=new Map(f.g),p.h=f.h),NA(this,p),this.m=c.m}else c&&(f=String(c).match(MA))?(this.h=!1,fh(this,f[1]||"",!0),this.o=ac(f[2]||""),this.g=ac(f[3]||"",!0),ph(this,f[4]),this.l=ac(f[5]||"",!0),NA(this,f[6]||"",!0),this.m=ac(f[7]||"")):(this.h=!1,this.i=new cc(null,this.h))}bs.prototype.toString=function(){var c=[],f=this.j;f&&c.push(uc(f,PA,!0),":");var p=this.g;return(p||f=="file")&&(c.push("//"),(f=this.o)&&c.push(uc(f,PA,!0),"@"),c.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&c.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&c.push("/"),c.push(uc(p,p.charAt(0)=="/"?oj:sj,!0))),(p=this.i.toString())&&c.push("?",p),(p=this.m)&&c.push("#",uc(p,uj)),c.join("")};function zr(c){return new bs(c)}function fh(c,f,p){c.j=p?ac(f,!0):f,c.j&&(c.j=c.j.replace(/:$/,""))}function ph(c,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);c.s=f}else c.s=null}function NA(c,f,p){f instanceof cc?(c.i=f,cj(c.i,c.h)):(p||(f=uc(f,aj)),c.i=new cc(f,c.h))}function qe(c,f,p){c.i.set(f,p)}function gh(c){return qe(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function ac(c,f){return c?f?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function uc(c,f,p){return typeof c=="string"?(c=encodeURI(c).replace(f,ij),p&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function ij(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var PA=/[#\/\?@]/g,sj=/[#\?:]/g,oj=/[#\?]/g,aj=/[#\?@]/g,uj=/#/g;function cc(c,f){this.h=this.g=null,this.i=c||null,this.j=!!f}function Ei(c){c.g||(c.g=new Map,c.h=0,c.i&&rj(c.i,function(f,p){c.add(decodeURIComponent(f.replace(/\+/g," ")),p)}))}n=cc.prototype,n.add=function(c,f){Ei(this),this.i=null,c=Uo(this,c);var p=this.g.get(c);return p||this.g.set(c,p=[]),p.push(f),this.h+=1,this};function kA(c,f){Ei(c),f=Uo(c,f),c.g.has(f)&&(c.i=null,c.h-=c.g.get(f).length,c.g.delete(f))}function OA(c,f){return Ei(c),f=Uo(c,f),c.g.has(f)}n.forEach=function(c,f){Ei(this),this.g.forEach(function(p,m){p.forEach(function(b){c.call(f,b,m,this)},this)},this)},n.na=function(){Ei(this);let c=Array.from(this.g.values()),f=Array.from(this.g.keys()),p=[];for(let m=0;m<f.length;m++){let b=c[m];for(let M=0;M<b.length;M++)p.push(f[m])}return p},n.V=function(c){Ei(this);let f=[];if(typeof c=="string")OA(this,c)&&(f=f.concat(this.g.get(Uo(this,c))));else{c=Array.from(this.g.values());for(let p=0;p<c.length;p++)f=f.concat(c[p])}return f},n.set=function(c,f){return Ei(this),this.i=null,c=Uo(this,c),OA(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[f]),this.h+=1,this},n.get=function(c,f){return c?(c=this.V(c),0<c.length?String(c[0]):f):f};function FA(c,f,p){kA(c,f),0<p.length&&(c.i=null,c.g.set(Uo(c,f),D(p)),c.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let c=[],f=Array.from(this.g.keys());for(var p=0;p<f.length;p++){var m=f[p];let M=encodeURIComponent(String(m)),U=this.V(m);for(m=0;m<U.length;m++){var b=M;U[m]!==""&&(b+="="+encodeURIComponent(String(U[m]))),c.push(b)}}return this.i=c.join("&")};function Uo(c,f){return f=String(f),c.j&&(f=f.toLowerCase()),f}function cj(c,f){f&&!c.j&&(Ei(c),c.i=null,c.g.forEach(function(p,m){var b=m.toLowerCase();m!=b&&(kA(this,m),FA(this,b,p))},c)),c.j=f}function lj(c,f){let p=new sc;if(a.Image){let m=new Image;m.onload=y(Ii,p,"TestLoadImage: loaded",!0,f,m),m.onerror=y(Ii,p,"TestLoadImage: error",!1,f,m),m.onabort=y(Ii,p,"TestLoadImage: abort",!1,f,m),m.ontimeout=y(Ii,p,"TestLoadImage: timeout",!1,f,m),a.setTimeout(function(){m.ontimeout&&m.ontimeout()},1e4),m.src=c}else f(!1)}function dj(c,f){let p=new sc,m=new AbortController,b=setTimeout(()=>{m.abort(),Ii(p,"TestPingServer: timeout",!1,f)},1e4);fetch(c,{signal:m.signal}).then(M=>{clearTimeout(b),M.ok?Ii(p,"TestPingServer: ok",!0,f):Ii(p,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(b),Ii(p,"TestPingServer: error",!1,f)})}function Ii(c,f,p,m,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),m(p)}catch{}}function hj(){this.g=new KL}function fj(c,f,p){let m=p||"";try{xA(c,function(b,M){let U=b;l(b)&&(U=qy(b)),f.push(m+M+"="+encodeURIComponent(U))})}catch(b){throw f.push(m+"type="+encodeURIComponent("_badmap")),b}}function lc(c){this.l=c.Ub||null,this.j=c.eb||!1}v(lc,Hy),lc.prototype.g=function(){return new mh(this.l,this.j)},lc.prototype.i=function(c){return function(){return c}}({});function mh(c,f){Ft.call(this),this.D=c,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(mh,Ft),n=mh.prototype,n.open=function(c,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=f,this.readyState=1,hc(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(f.body=c),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,dc(this)),this.readyState=0},n.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,hc(this)),this.g&&(this.readyState=3,hc(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;VA(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function VA(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}n.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var f=c.value?c.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!c.done}))&&(this.response=this.responseText+=f)}c.done?dc(this):hc(this),this.readyState==3&&VA(this)}},n.Ra=function(c){this.g&&(this.response=this.responseText=c,dc(this))},n.Qa=function(c){this.g&&(this.response=c,dc(this))},n.ga=function(){this.g&&dc(this)};function dc(c){c.readyState=4,c.l=null,c.j=null,c.v=null,hc(c)}n.setRequestHeader=function(c,f){this.u.append(c,f)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let c=[],f=this.h.entries();for(var p=f.next();!p.done;)p=p.value,c.push(p[0]+": "+p[1]),p=f.next();return c.join(`\r
`)};function hc(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(mh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function LA(c){let f="";return X(c,function(p,m){f+=m,f+=":",f+=p,f+=`\r
`}),f}function e_(c,f,p){e:{for(m in p){var m=!1;break e}m=!0}m||(p=LA(p),typeof c=="string"?p!=null&&encodeURIComponent(String(p)):qe(c,f,p))}function Xe(c){Ft.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(Xe,Ft);var pj=/^https?$/i,gj=["POST","PUT"];n=Xe.prototype,n.Ha=function(c){this.J=c},n.ea=function(c,f,p,m){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);f=f?f.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Wy.g(),this.v=this.o?fA(this.o):fA(Wy),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(f,String(c),!0),this.B=!1}catch(M){jA(this,M);return}if(c=p||"",p=new Map(this.headers),m)if(Object.getPrototypeOf(m)===Object.prototype)for(var b in m)p.set(b,m[b]);else if(typeof m.keys=="function"&&typeof m.get=="function")for(let M of m.keys())p.set(M,m.get(M));else throw Error("Unknown input type for opt_headers: "+String(m));m=Array.from(p.keys()).find(M=>M.toLowerCase()=="content-type"),b=a.FormData&&c instanceof a.FormData,!(0<=Array.prototype.indexOf.call(gj,f,void 0))||m||b||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[M,U]of p)this.g.setRequestHeader(M,U);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{$A(this),this.u=!0,this.g.send(c),this.u=!1}catch(M){jA(this,M)}};function jA(c,f){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=f,c.m=5,UA(c),yh(c)}function UA(c){c.A||(c.A=!0,Qt(c,"complete"),Qt(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,Qt(this,"complete"),Qt(this,"abort"),yh(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),yh(this,!0)),Xe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?BA(this):this.bb())},n.bb=function(){BA(this)};function BA(c){if(c.h&&typeof o<"u"&&(!c.v[1]||Wr(c)!=4||c.Z()!=2)){if(c.u&&Wr(c)==4)cA(c.Ea,0,c);else if(Qt(c,"readystatechange"),Wr(c)==4){c.h=!1;try{let U=c.Z();e:switch(U){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var p;if(!(p=f)){var m;if(m=U===0){var b=String(c.D).match(MA)[1]||null;!b&&a.self&&a.self.location&&(b=a.self.location.protocol.slice(0,-1)),m=!pj.test(b?b.toLowerCase():"")}p=m}if(p)Qt(c,"complete"),Qt(c,"success");else{c.m=6;try{var M=2<Wr(c)?c.g.statusText:""}catch{M=""}c.l=M+" ["+c.Z()+"]",UA(c)}}finally{yh(c)}}}}function yh(c,f){if(c.g){$A(c);let p=c.g,m=c.v[0]?()=>{}:null;c.g=null,c.v=null,f||Qt(c,"ready");try{p.onreadystatechange=m}catch{}}}function $A(c){c.I&&(a.clearTimeout(c.I),c.I=null)}n.isActive=function(){return!!this.g};function Wr(c){return c.g?c.g.readyState:0}n.Z=function(){try{return 2<Wr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(c){if(this.g){var f=this.g.responseText;return c&&f.indexOf(c)==0&&(f=f.substring(c.length)),WL(f)}};function qA(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function mj(c){let f={};c=(c.g&&2<=Wr(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let m=0;m<c.length;m++){if(B(c[m]))continue;var p=T(c[m]);let b=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();let M=f[b]||[];f[b]=M,M.push(p)}I(f,function(m){return m.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function fc(c,f,p){return p&&p.internalChannelParams&&p.internalChannelParams[c]||f}function HA(c){this.Aa=0,this.i=[],this.j=new sc,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=fc("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=fc("baseRetryDelayMs",5e3,c),this.cb=fc("retryDelaySeedMs",1e4,c),this.Wa=fc("forwardChannelMaxRetries",2,c),this.wa=fc("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new TA(c&&c.concurrentRequestLimit),this.Da=new hj,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=HA.prototype,n.la=8,n.G=1,n.connect=function(c,f,p,m){Yt(0),this.W=c,this.H=f||{},p&&m!==void 0&&(this.H.OSID=p,this.H.OAID=m),this.F=this.X,this.I=XA(this,null,this.W),vh(this)};function t_(c){if(GA(c),c.G==3){var f=c.U++,p=zr(c.I);if(qe(p,"SID",c.K),qe(p,"RID",f),qe(p,"TYPE","terminate"),pc(c,p),f=new wi(c,c.j,f),f.L=2,f.v=gh(zr(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=f.v,p=!0),p||(f.g=eS(f.j,null),f.g.ea(f.v)),f.F=Date.now(),hh(f)}JA(c)}function _h(c){c.g&&(r_(c),c.g.cancel(),c.g=null)}function GA(c){_h(c),c.u&&(a.clearTimeout(c.u),c.u=null),wh(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&a.clearTimeout(c.s),c.s=null)}function vh(c){if(!bA(c.h)&&!c.s){c.s=!0;var f=c.Ga;Zu||rA(),Ju||(Zu(),Ju=!0),ky.add(f,c),c.B=0}}function yj(c,f){return AA(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=f.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=ic(g(c.Ga,c,f),ZA(c,c.B)),c.B++,!0)}n.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;let b=new wi(this,this.j,c),M=this.o;if(this.S&&(M?(M=_(M),C(M,this.S)):M=this.S),this.m!==null||this.O||(b.H=M,M=null),this.P)e:{for(var f=0,p=0;p<this.i.length;p++){t:{var m=this.i[p];if("__data__"in m.map&&(m=m.map.__data__,typeof m=="string")){m=m.length;break t}m=void 0}if(m===void 0)break;if(f+=m,4096<f){f=p;break e}if(f===4096||p===this.i.length-1){f=p+1;break e}}f=1e3}else f=1e3;f=WA(this,b,f),p=zr(this.I),qe(p,"RID",c),qe(p,"CVER",22),this.D&&qe(p,"X-HTTP-Session-Id",this.D),pc(this,p),M&&(this.O?f="headers="+encodeURIComponent(String(LA(M)))+"&"+f:this.m&&e_(p,this.m,M)),Xy(this.h,b),this.Ua&&qe(p,"TYPE","init"),this.P?(qe(p,"$req",f),qe(p,"SID","null"),b.T=!0,Qy(b,p,null)):Qy(b,p,f),this.G=2}}else this.G==3&&(c?zA(this,c):this.i.length==0||bA(this.h)||zA(this))};function zA(c,f){var p;f?p=f.l:p=c.U++;let m=zr(c.I);qe(m,"SID",c.K),qe(m,"RID",p),qe(m,"AID",c.T),pc(c,m),c.m&&c.o&&e_(m,c.m,c.o),p=new wi(c,c.j,p,c.B+1),c.m===null&&(p.H=c.o),f&&(c.i=f.D.concat(c.i)),f=WA(c,p,1e3),p.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),Xy(c.h,p),Qy(p,m,f)}function pc(c,f){c.H&&X(c.H,function(p,m){qe(f,m,p)}),c.l&&xA({},function(p,m){qe(f,m,p)})}function WA(c,f,p){p=Math.min(c.i.length,p);var m=c.l?g(c.l.Na,c.l,c):null;e:{var b=c.i;let M=-1;for(;;){let U=["count="+p];M==-1?0<p?(M=b[0].g,U.push("ofs="+M)):M=0:U.push("ofs="+M);let Fe=!0;for(let Rt=0;Rt<p;Rt++){let Re=b[Rt].g,Vt=b[Rt].map;if(Re-=M,0>Re)M=Math.max(0,b[Rt].g-100),Fe=!1;else try{fj(Vt,U,"req"+Re+"_")}catch{m&&m(Vt)}}if(Fe){m=U.join("&");break e}}}return c=c.i.splice(0,p),f.D=c,m}function KA(c){if(!c.g&&!c.u){c.Y=1;var f=c.Fa;Zu||rA(),Ju||(Zu(),Ju=!0),ky.add(f,c),c.v=0}}function n_(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=ic(g(c.Fa,c),ZA(c,c.v)),c.v++,!0)}n.Fa=function(){if(this.u=null,QA(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=ic(g(this.ab,this),c)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Yt(10),_h(this),QA(this))};function r_(c){c.A!=null&&(a.clearTimeout(c.A),c.A=null)}function QA(c){c.g=new wi(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var f=zr(c.qa);qe(f,"RID","rpc"),qe(f,"SID",c.K),qe(f,"AID",c.T),qe(f,"CI",c.F?"0":"1"),!c.F&&c.ja&&qe(f,"TO",c.ja),qe(f,"TYPE","xmlhttp"),pc(c,f),c.m&&c.o&&e_(f,c.m,c.o),c.L&&(c.g.I=c.L);var p=c.g;c=c.ia,p.L=1,p.v=gh(zr(f)),p.m=null,p.P=!0,IA(p,c)}n.Za=function(){this.C!=null&&(this.C=null,_h(this),n_(this),Yt(19))};function wh(c){c.C!=null&&(a.clearTimeout(c.C),c.C=null)}function YA(c,f){var p=null;if(c.g==f){wh(c),r_(c),c.g=null;var m=2}else if(Jy(c.h,f))p=f.D,SA(c.h,f),m=1;else return;if(c.G!=0){if(f.o)if(m==1){p=f.m?f.m.length:0,f=Date.now()-f.F;var b=c.B;m=ch(),Qt(m,new _A(m,p)),vh(c)}else KA(c);else if(b=f.s,b==3||b==0&&0<f.X||!(m==1&&yj(c,f)||m==2&&n_(c)))switch(p&&0<p.length&&(f=c.h,f.i=f.i.concat(p)),b){case 1:As(c,5);break;case 4:As(c,10);break;case 3:As(c,6);break;default:As(c,2)}}}function ZA(c,f){let p=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(p*=2),p*f}function As(c,f){if(c.j.info("Error code "+f),f==2){var p=g(c.fb,c),m=c.Xa;let b=!m;m=new bs(m||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||fh(m,"https"),gh(m),b?lj(m.toString(),p):dj(m.toString(),p)}else Yt(2);c.G=0,c.l&&c.l.sa(f),JA(c),GA(c)}n.fb=function(c){c?(this.j.info("Successfully pinged google.com"),Yt(2)):(this.j.info("Failed to ping google.com"),Yt(1))};function JA(c){if(c.G=0,c.ka=[],c.l){let f=RA(c.h);(f.length!=0||c.i.length!=0)&&(A(c.ka,f),A(c.ka,c.i),c.h.i.length=0,D(c.i),c.i.length=0),c.l.ra()}}function XA(c,f,p){var m=p instanceof bs?zr(p):new bs(p);if(m.g!="")f&&(m.g=f+"."+m.g),ph(m,m.s);else{var b=a.location;m=b.protocol,f=f?f+"."+b.hostname:b.hostname,b=+b.port;var M=new bs(null);m&&fh(M,m),f&&(M.g=f),b&&ph(M,b),p&&(M.l=p),m=M}return p=c.D,f=c.ya,p&&f&&qe(m,p,f),qe(m,"VER",c.la),pc(c,m),m}function eS(c,f,p){if(f&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=c.Ca&&!c.pa?new Xe(new lc({eb:p})):new Xe(c.pa),f.Ha(c.J),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function tS(){}n=tS.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Eh(){}Eh.prototype.g=function(c,f){return new mn(c,f)};function mn(c,f){Ft.call(this),this.g=new HA(f),this.l=c,this.h=f&&f.messageUrlParams||null,c=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(c?c["X-WebChannel-Content-Type"]=f.messageContentType:c={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(c?c["X-WebChannel-Client-Profile"]=f.va:c={"X-WebChannel-Client-Profile":f.va}),this.g.S=c,(c=f&&f.Sb)&&!B(c)&&(this.g.m=c),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!B(f)&&(this.g.D=f,c=this.h,c!==null&&f in c&&(c=this.h,f in c&&delete c[f])),this.j=new Bo(this)}v(mn,Ft),mn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},mn.prototype.close=function(){t_(this.g)},mn.prototype.o=function(c){var f=this.g;if(typeof c=="string"){var p={};p.__data__=c,c=p}else this.u&&(p={},p.__data__=qy(c),c=p);f.i.push(new ej(f.Ya++,c)),f.G==3&&vh(f)},mn.prototype.N=function(){this.g.l=null,delete this.j,t_(this.g),delete this.g,mn.aa.N.call(this)};function nS(c){Gy.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var f=c.__sm__;if(f){e:{for(let p in f){c=p;break e}c=void 0}(this.i=c)&&(c=this.i,f=f!==null&&c in f?f[c]:void 0),this.data=f}else this.data=c}v(nS,Gy);function rS(){zy.call(this),this.status=1}v(rS,zy);function Bo(c){this.g=c}v(Bo,tS),Bo.prototype.ua=function(){Qt(this.g,"a")},Bo.prototype.ta=function(c){Qt(this.g,new nS(c))},Bo.prototype.sa=function(c){Qt(this.g,new rS)},Bo.prototype.ra=function(){Qt(this.g,"b")},Eh.prototype.createWebChannel=Eh.prototype.g,mn.prototype.send=mn.prototype.o,mn.prototype.open=mn.prototype.m,mn.prototype.close=mn.prototype.close,TD=li.createWebChannelTransport=function(){return new Eh},DD=li.getStatEventTarget=function(){return ch()},CD=li.Event=Ds,rm=li.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},lh.NO_ERROR=0,lh.TIMEOUT=8,lh.HTTP_ERROR=6,_d=li.ErrorCode=lh,vA.COMPLETE="complete",ID=li.EventType=vA,pA.EventType=nc,nc.OPEN="a",nc.CLOSE="b",nc.ERROR="c",nc.MESSAGE="d",Ft.prototype.listen=Ft.prototype.K,uu=li.WebChannel=pA,M5=li.FetchXmlHttpFactory=lc,Xe.prototype.listenOnce=Xe.prototype.L,Xe.prototype.getLastError=Xe.prototype.Ka,Xe.prototype.getLastErrorCode=Xe.prototype.Ba,Xe.prototype.getStatus=Xe.prototype.Z,Xe.prototype.getResponseJson=Xe.prototype.Oa,Xe.prototype.getResponseText=Xe.prototype.oa,Xe.prototype.send=Xe.prototype.ea,Xe.prototype.setWithCredentials=Xe.prototype.Ha,ED=li.XhrIo=Xe}).apply(typeof nm<"u"?nm:typeof self<"u"?self:typeof window<"u"?window:{});var S1="@firebase/firestore";var mt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};mt.UNAUTHENTICATED=new mt(null),mt.GOOGLE_CREDENTIALS=new mt("google-credentials-uid"),mt.FIRST_PARTY=new mt("first-party-uid"),mt.MOCK_USER=new mt("mock-user");var ju="10.14.0";var ds=new Di("@firebase/firestore");function fu(){return ds.logLevel}function xb(n){ds.setLogLevel(n)}function O(n,...e){if(ds.logLevel<=Fn.DEBUG){let t=e.map(Mb);ds.debug(`Firestore (${ju}): ${n}`,...t)}}function ut(n,...e){if(ds.logLevel<=Fn.ERROR){let t=e.map(Mb);ds.error(`Firestore (${ju}): ${n}`,...t)}}function lr(n,...e){if(ds.logLevel<=Fn.WARN){let t=e.map(Mb);ds.warn(`Firestore (${ju}): ${n}`,...t)}}function Mb(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function z(n="Unexpected state"){let e=`FIRESTORE (${ju}) INTERNAL ASSERTION FAILED: `+n;throw ut(e),new Error(e)}function W(n,e){n||z()}function MF(n,e){n||z()}function $(n,e){return n}var N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},k=class extends dS{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var wt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var fm=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},MD=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(mt.UNAUTHENTICATED))}shutdown(){}},ND=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},PD=class{constructor(e){this.t=e,this.currentUser=mt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){W(this.o===void 0);let r=this.i,i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve(),s=new wt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new wt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let u=s;e.enqueueRetryable(()=>x(this,null,function*(){yield u.promise,yield i(this.currentUser)}))},a=u=>{O("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?a(u):(O("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new wt)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(O("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(W(typeof r.accessToken=="string"),new fm(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return W(e===null||typeof e=="string"),new mt(e)}},kD=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=mt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},OD=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new kD(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(mt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},FD=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},VD=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){W(this.o===void 0);let r=s=>{s.error!=null&&O("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,O("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{O("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):O("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(W(typeof t.token=="string"),this.R=t.token,new FD(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function N5(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var pm=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=N5(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function ae(n,e){return n<e?-1:n>e?1:0}function Iu(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function NF(n){return n+"\0"}var Ze=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new k(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new k(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new k(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new k(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ae(this.nanoseconds,e.nanoseconds):ae(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var J=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Ze(0,0))}static max(){return new n(new Ze(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var gm=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&z(),r===void 0?r=e.length-t:r>e.length-t&&z(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},Ae=class n extends gm{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new k(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},P5=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ct=class n extends gm{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return P5.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new k(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new k(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new k(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new k(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var q=class n{constructor(e){this.path=e}static fromPath(e){return new n(Ae.fromString(e))}static fromName(e){return new n(Ae.fromString(e).popFirst(5))}static empty(){return new n(Ae.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ae.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ae.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Ae(e.slice()))}};var Cu=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function LD(n){return n.fields.find(e=>e.kind===2)}function po(n){return n.fields.filter(e=>e.kind!==2)}Cu.UNKNOWN_ID=-1;var vu=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var xd=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,Qn.min())}};function PF(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=J.fromTimestamp(r===1e9?new Ze(t+1,0):new Ze(t,r));return new Qn(i,q.empty(),e)}function kF(n){return new Qn(n.readTime,n.key,-1)}var Qn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(J.min(),q.empty(),-1)}static max(){return new n(J.max(),q.empty(),-1)}};function Nb(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=q.comparator(n.documentKey,e.documentKey),t!==0?t:ae(n.largestBatchId,e.largestBatchId))}var OF="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",mm=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Es(n){return x(this,null,function*(){if(n.code!==N.FAILED_PRECONDITION||n.message!==OF)throw n;O("LocalStore","Unexpectedly lost primary lease")})}var R=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&z(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},u=>r(u))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let u=0;u<s;u++){let l=u;t(e[l]).next(d=>{o[l]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};var ym=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new wt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new wo(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=Pb(r.target.error);this.V.reject(new wo(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(s){throw new wo(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(O("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new UD(t)}},hs=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(gc())===12.2&&ut("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return O("SimpleDb","Removing database:",e),go(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Ah())return!1;if(n.v())return!0;let e=gc(),t=n.S(e),r=0<t&&t<10,i=FF(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return x(this,null,function*(){return this.db||(O("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new wo(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new k(N.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new k(N.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new wo(e,o))},i.onupgradeneeded=s=>{O("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{O("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return x(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let a=ym.open(this.db,e,s?"readonly":"readwrite",r),u=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),R.reject(l))).toPromise();return u.catch(()=>{}),yield a.m,u}catch(a){let u=a,l=u.name!=="FirebaseError"&&o<3;if(O("SimpleDb","Transaction failed with error:",u.message,"Retrying:",l),this.close(),!l)return Promise.reject(u)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function FF(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var jD=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return go(this.B.delete())}},wo=class extends k{constructor(e,t){super(N.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Is(n){return n.name==="IndexedDbTransactionError"}var UD=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(O("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(O("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),go(r)}add(e){return O("SimpleDb","ADD",this.store.name,e,e),go(this.store.add(e))}get(e){return go(this.store.get(e)).next(t=>(t===void 0&&(t=null),O("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return O("SimpleDb","DELETE",this.store.name,e),go(this.store.delete(e))}count(){return O("SimpleDb","COUNT",this.store.name),go(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new R((o,a)=>{s.onerror=u=>{a(u.target.error)},s.onsuccess=u=>{o(u.target.result)}})}{let s=this.cursor(r),o=[];return this.W(s,(a,u)=>{o.push(u)}).next(()=>o)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new R((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,t){O("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new R((r,i)=>{t.onerror=s=>{let o=Pb(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){let r=[];return new R((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let u=new jD(a),l=t(a.primaryKey,a.value,u);if(l instanceof R){let d=l.catch(h=>(u.done(),R.reject(h)));r.push(d)}u.isDone?i():u.K===null?a.continue():a.continue(u.K)}}).next(()=>R.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function go(n){return new R((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=Pb(r.target.error);t(i)}})}var R1=!1;function Pb(n){let e=hs.S(gc());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new k("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return R1||(R1=!0,setTimeout(()=>{throw r},0)),r}}return n}var BD=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){O("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>x(this,null,function*(){this.task=null;try{O("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){Is(t)?O("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield Es(t)}yield this.X(6e4)}))}},$D=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return x(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,s=!0;return R.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return O("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(O("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((i,s)=>{let o=kF(s);Nb(o,r)>0&&(r=o)}),new Qn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Pn=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Zd(n){return n==null}function Md(n){return n===0&&1/n==-1/0}function VF(n){return typeof n=="number"&&Number.isInteger(n)&&!Md(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function an(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=x1(e)),e=k5(n.get(t),e);return x1(e)}function k5(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function x1(n){return n+""}function kr(n){let e=n.length;if(W(e>=2),e===2)return W(n.charAt(0)===""&&n.charAt(1)===""),Ae.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf("",s);switch((o<0||o>t)&&z(),n.charAt(o+1)){case"":let a=n.substring(s,o),u;i.length===0?u=a:(i+=a,u=i,i=""),r.push(u);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:z()}s=o+2}return new Ae(r)}var M1=["userId","batchId"];function um(n,e){return[n,an(e)]}function LF(n,e,t){return[n,an(e),t]}var O5={},F5=["prefixPath","collectionGroup","readTime","documentId"],V5=["prefixPath","collectionGroup","documentId"],L5=["collectionGroup","readTime","prefixPath","documentId"],j5=["canonicalId","targetId"],U5=["targetId","path"],B5=["path","targetId"],$5=["collectionId","parent"],q5=["indexId","uid"],H5=["uid","sequenceNumber"],G5=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],z5=["indexId","uid","orderedDocumentKey"],W5=["userId","collectionPath","documentId"],K5=["userId","collectionPath","largestBatchId"],Q5=["userId","collectionGroup","largestBatchId"],jF=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Y5=[...jF,"documentOverlays"],UF=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],BF=UF,kb=[...BF,"indexConfiguration","indexState","indexEntries"],Z5=kb,J5=[...kb,"globals"];var Nd=class extends mm{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function Et(n,e){let t=$(n);return hs.F(t._e,e)}function N1(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function No(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function $F(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ze=class n{constructor(e,t){this.comparator=e,this.root=t||Fr.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Fr.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Fr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new _u(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new _u(this.root,e,this.comparator,!1)}getReverseIterator(){return new _u(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new _u(this.root,e,this.comparator,!0)}},_u=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Fr=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw z();let e=this.left.check();if(e!==this.right.check())throw z();return e+(this.isRed()?0:1)}};Fr.EMPTY=null,Fr.RED=!0,Fr.BLACK=!1;Fr.EMPTY=new class{constructor(){this.size=0}get key(){throw z()}get value(){throw z()}get color(){throw z()}get left(){throw z()}get right(){throw z()}copy(e,t,r,i,s){return this}insert(e,t,r){return new Fr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ue=class n{constructor(e){this.comparator=e,this.data=new ze(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new _m(this.data.getIterator())}getIteratorFrom(e){return new _m(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},_m=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function cu(n){return n.hasNext()?n.getNext():void 0}var kn=class n{constructor(e){this.fields=e,e.sort(ct.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ue(ct.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Iu(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var vm=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function qF(){return typeof atob<"u"}var dt=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new vm("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ae(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};dt.EMPTY_BYTE_STRING=new dt("");var X5=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fi(n){if(W(!!n),typeof n=="string"){let e=0,t=X5.exec(n);if(W(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ke(n.seconds),nanos:Ke(n.nanos)}}function Ke(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function fs(n){return typeof n=="string"?dt.fromBase64String(n):dt.fromUint8Array(n)}function ly(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Ob(n){let e=n.mapValue.fields.__previous_value__;return ly(e)?Ob(e):e}function Pd(n){let e=fi(n.mapValue.fields.__local_write_time__.timestampValue);return new Ze(e.seconds,e.nanos)}var qD=class{constructor(e,t,r,i,s,o,a,u,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=l}},ps=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var cs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},cm={nullValue:"NULL_VALUE"};function Eo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?ly(n)?4:HF(n)?9007199254740991:dy(n)?10:11:z()}function jr(n,e){if(n===e)return!0;let t=Eo(n);if(t!==Eo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Pd(n).isEqual(Pd(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=fi(i.timestampValue),a=fi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return fs(i.bytesValue).isEqual(fs(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return Ke(i.geoPointValue.latitude)===Ke(s.geoPointValue.latitude)&&Ke(i.geoPointValue.longitude)===Ke(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Ke(i.integerValue)===Ke(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Ke(i.doubleValue),a=Ke(s.doubleValue);return o===a?Md(o)===Md(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Iu(n.arrayValue.values||[],e.arrayValue.values||[],jr);case 10:case 11:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(N1(o)!==N1(a))return!1;for(let u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!jr(o[u],a[u])))return!1;return!0}(n,e);default:return z()}}function kd(n,e){return(n.values||[]).find(t=>jr(t,e))!==void 0}function gs(n,e){if(n===e)return 0;let t=Eo(n),r=Eo(e);if(t!==r)return ae(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ae(n.booleanValue,e.booleanValue);case 2:return function(s,o){let a=Ke(s.integerValue||s.doubleValue),u=Ke(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(n,e);case 3:return P1(n.timestampValue,e.timestampValue);case 4:return P1(Pd(n),Pd(e));case 5:return ae(n.stringValue,e.stringValue);case 6:return function(s,o){let a=fs(s),u=fs(o);return a.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),u=o.split("/");for(let l=0;l<a.length&&l<u.length;l++){let d=ae(a[l],u[l]);if(d!==0)return d}return ae(a.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let a=ae(Ke(s.latitude),Ke(o.latitude));return a!==0?a:ae(Ke(s.longitude),Ke(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return k1(n.arrayValue,e.arrayValue);case 10:return function(s,o){var a,u,l,d;let h=s.fields||{},g=o.fields||{},y=(a=h.value)===null||a===void 0?void 0:a.arrayValue,v=(u=g.value)===null||u===void 0?void 0:u.arrayValue,D=ae(((l=y?.values)===null||l===void 0?void 0:l.length)||0,((d=v?.values)===null||d===void 0?void 0:d.length)||0);return D!==0?D:k1(y,v)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===cs.mapValue&&o===cs.mapValue)return 0;if(s===cs.mapValue)return 1;if(o===cs.mapValue)return-1;let a=s.fields||{},u=Object.keys(a),l=o.fields||{},d=Object.keys(l);u.sort(),d.sort();for(let h=0;h<u.length&&h<d.length;++h){let g=ae(u[h],d[h]);if(g!==0)return g;let y=gs(a[u[h]],l[d[h]]);if(y!==0)return y}return ae(u.length,d.length)}(n.mapValue,e.mapValue);default:throw z()}}function P1(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ae(n,e);let t=fi(n),r=fi(e),i=ae(t.seconds,r.seconds);return i!==0?i:ae(t.nanos,r.nanos)}function k1(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=gs(t[i],r[i]);if(s)return s}return ae(t.length,r.length)}function Du(n){return HD(n)}function HD(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=fi(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return fs(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return q.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=HD(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${HD(t.fields[o])}`;return i+"}"}(n.mapValue):z()}function Io(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function GD(n){return!!n&&"integerValue"in n}function Od(n){return!!n&&"arrayValue"in n}function O1(n){return!!n&&"nullValue"in n}function F1(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function lm(n){return!!n&&"mapValue"in n}function dy(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Td(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return No(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Td(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Td(n.arrayValue.values[t]);return e}return Object.assign({},n)}function HF(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var GF={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function e8(n){return"nullValue"in n?cm:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Io(ps.empty(),q.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?dy(n)?GF:{mapValue:{}}:z()}function t8(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Io(ps.empty(),q.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?GF:"mapValue"in n?dy(n)?{mapValue:{}}:cs:z()}function V1(n,e){let t=gs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function L1(n,e){let t=gs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var Kt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!lm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Td(t)}setAll(e){let t=ct.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=Td(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());lm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return jr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];lm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){No(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(Td(this.value))}};function zF(n){let e=[];return No(n.fields,(t,r)=>{let i=new ct([t]);if(lm(r)){let s=zF(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new kn(e)}var yt=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,J.min(),J.min(),J.min(),Kt.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,J.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,J.min(),J.min(),Kt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,J.min(),J.min(),Kt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(J.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Kt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Kt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=J.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Ur=class{constructor(e,t){this.position=e,this.inclusive=t}};function j1(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=q.comparator(q.fromName(o.referenceValue),t.key):r=gs(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function U1(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!jr(n.position[t],e.position[t]))return!1;return!0}var Co=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function n8(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var wm=class{},Ee=class n extends wm{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new KD(e,t,r):t==="array-contains"?new ZD(e,r):t==="in"?new Em(e,r):t==="not-in"?new JD(e,r):t==="array-contains-any"?new XD(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new QD(e,r):new YD(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(gs(t,this.value)):t!==null&&Eo(this.value)===Eo(t)&&this.matchesComparison(gs(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return z()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Oe=class n extends wm{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return Tu(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function Tu(n){return n.op==="and"}function zD(n){return n.op==="or"}function Fb(n){return WF(n)&&Tu(n)}function WF(n){for(let e of n.filters)if(e instanceof Oe)return!1;return!0}function WD(n){if(n instanceof Ee)return n.field.canonicalString()+n.op.toString()+Du(n.value);if(Fb(n))return n.filters.map(e=>WD(e)).join(",");{let e=n.filters.map(t=>WD(t)).join(",");return`${n.op}(${e})`}}function KF(n,e){return n instanceof Ee?function(r,i){return i instanceof Ee&&r.op===i.op&&r.field.isEqual(i.field)&&jr(r.value,i.value)}(n,e):n instanceof Oe?function(r,i){return i instanceof Oe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&KF(o,i.filters[a]),!0):!1}(n,e):void z()}function QF(n,e){let t=n.filters.concat(e);return Oe.create(t,n.op)}function YF(n){return n instanceof Ee?function(t){return`${t.field.canonicalString()} ${t.op} ${Du(t.value)}`}(n):n instanceof Oe?function(t){return t.op.toString()+" {"+t.getFilters().map(YF).join(" ,")+"}"}(n):"Filter"}var KD=class extends Ee{constructor(e,t,r){super(e,t,r),this.key=q.fromName(r.referenceValue)}matches(e){let t=q.comparator(e.key,this.key);return this.matchesComparison(t)}},QD=class extends Ee{constructor(e,t){super(e,"in",t),this.keys=ZF("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},YD=class extends Ee{constructor(e,t){super(e,"not-in",t),this.keys=ZF("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function ZF(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>q.fromName(r.referenceValue))}var ZD=class extends Ee{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Od(t)&&kd(t.arrayValue,this.value)}},Em=class extends Ee{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&kd(this.value.arrayValue,t)}},JD=class extends Ee{constructor(e,t){super(e,"not-in",t)}matches(e){if(kd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!kd(this.value.arrayValue,t)}},XD=class extends Ee{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Od(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>kd(this.value.arrayValue,r))}};var eT=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function tT(n,e=null,t=[],r=[],i=null,s=null,o=null){return new eT(n,e,t,r,i,s,o)}function Do(n){let e=$(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>WD(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Zd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Du(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Du(r)).join(",")),e.ue=t}return e.ue}function Jd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!n8(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!KF(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!U1(n.startAt,e.startAt)&&U1(n.endAt,e.endAt)}function Im(n){return q.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Cm(n,e){return n.filters.filter(t=>t instanceof Ee&&t.field.isEqual(e))}function B1(n,e,t){let r=cm,i=!0;for(let s of Cm(n,e)){let o=cm,a=!0;switch(s.op){case"<":case"<=":o=e8(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=cm}V1({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];V1({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function $1(n,e,t){let r=cs,i=!0;for(let s of Cm(n,e)){let o=cs,a=!0;switch(s.op){case">=":case">":o=t8(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=cs}L1({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];L1({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}var dr=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function JF(n,e,t,r,i,s,o,a){return new dr(n,e,t,r,i,s,o,a)}function Uu(n){return new dr(n)}function q1(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Vb(n){return n.collectionGroup!==null}function wu(n){let e=$(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ue(ct.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Co(s,r))}),t.has(ct.keyField().canonicalString())||e.ce.push(new Co(ct.keyField(),r))}return e.ce}function un(n){let e=$(n);return e.le||(e.le=r8(e,wu(n))),e.le}function r8(n,e){if(n.limitType==="F")return tT(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Co(i.field,s)});let t=n.endAt?new Ur(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Ur(n.startAt.position,n.startAt.inclusive):null;return tT(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function nT(n,e){let t=n.filters.concat([e]);return new dr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Dm(n,e,t){return new dr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Xd(n,e){return Jd(un(n),un(e))&&n.limitType===e.limitType}function XF(n){return`${Do(un(n))}|lt:${n.limitType}`}function pu(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>YF(i)).join(", ")}]`),Zd(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Du(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Du(i)).join(",")),`Target(${r})`}(un(n))}; limitType=${n.limitType})`}function eh(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):q.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of wu(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,u){let l=j1(o,a,u);return o.inclusive?l<=0:l<0}(r.startAt,wu(r),i)||r.endAt&&!function(o,a,u){let l=j1(o,a,u);return o.inclusive?l>=0:l>0}(r.endAt,wu(r),i))}(n,e)}function eV(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function tV(n){return(e,t)=>{let r=!1;for(let i of wu(n)){let s=i8(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function i8(n,e,t){let r=n.field.isKeyField()?q.comparator(e.key,t.key):function(s,o,a){let u=o.data.field(s),l=a.data.field(s);return u!==null&&l!==null?gs(u,l):z()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return z()}}var Br=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){No(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return $F(this.inner)}size(){return this.innerSize}};var s8=new ze(q.comparator);function gn(){return s8}var nV=new ze(q.comparator);function Cd(...n){let e=nV;for(let t of n)e=e.insert(t.key,t);return e}function rV(n){let e=nV;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Or(){return bd()}function iV(){return bd()}function bd(){return new Br(n=>n.toString(),(n,e)=>n.isEqual(e))}var o8=new ze(q.comparator),a8=new Ue(q.comparator);function de(...n){let e=a8;for(let t of n)e=e.add(t);return e}var u8=new Ue(ae);function Lb(){return u8}function jb(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Md(e)?"-0":e}}function sV(n){return{integerValue:""+n}}function oV(n,e){return VF(e)?sV(e):jb(n,e)}var bu=class{constructor(){this._=void 0}};function c8(n,e,t){return n instanceof ms?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&ly(s)&&(s=Ob(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof pi?uV(n,e):n instanceof gi?cV(n,e):function(i,s){let o=aV(i,s),a=H1(o)+H1(i.Pe);return GD(o)&&GD(i.Pe)?sV(a):jb(i.serializer,a)}(n,e)}function l8(n,e,t){return n instanceof pi?uV(n,e):n instanceof gi?cV(n,e):t}function aV(n,e){return n instanceof ys?function(r){return GD(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var ms=class extends bu{},pi=class extends bu{constructor(e){super(),this.elements=e}};function uV(n,e){let t=lV(e);for(let r of n.elements)t.some(i=>jr(i,r))||t.push(r);return{arrayValue:{values:t}}}var gi=class extends bu{constructor(e){super(),this.elements=e}};function cV(n,e){let t=lV(e);for(let r of n.elements)t=t.filter(i=>!jr(i,r));return{arrayValue:{values:t}}}var ys=class extends bu{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function H1(n){return Ke(n.integerValue||n.doubleValue)}function lV(n){return Od(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var To=class{constructor(e,t){this.field=e,this.transform=t}};function d8(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof pi&&i instanceof pi||r instanceof gi&&i instanceof gi?Iu(r.elements,i.elements,jr):r instanceof ys&&i instanceof ys?jr(r.Pe,i.Pe):r instanceof ms&&i instanceof ms}(n.transform,e.transform)}var rT=class{constructor(e,t){this.version=e,this.transformResults=t}},rt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function dm(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Au=class{};function dV(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new vs(n.key,rt.none()):new _s(n.key,n.data,rt.none());{let t=n.data,r=Kt.empty(),i=new Ue(ct.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new hr(n.key,r,new kn(i.toArray()),rt.none())}}function h8(n,e,t){n instanceof _s?function(i,s,o){let a=i.value.clone(),u=z1(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof hr?function(i,s,o){if(!dm(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=z1(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(hV(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Ad(n,e,t,r){return n instanceof _s?function(s,o,a,u){if(!dm(s.precondition,o))return a;let l=s.value.clone(),d=W1(s.fieldTransforms,u,o);return l.setAll(d),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof hr?function(s,o,a,u){if(!dm(s.precondition,o))return a;let l=W1(s.fieldTransforms,u,o),d=o.data;return d.setAll(hV(s)),d.setAll(l),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(n,e,t,r):function(s,o,a){return dm(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function f8(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=aV(r.transform,i||null);s!=null&&(t===null&&(t=Kt.empty()),t.set(r.field,s))}return t||null}function G1(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Iu(r,i,(s,o)=>d8(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var _s=class extends Au{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},hr=class extends Au{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function hV(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function z1(n,e,t){let r=new Map;W(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,l8(o,a,t[i]))}return r}function W1(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,c8(s,o,e))}return r}var vs=class extends Au{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Fd=class extends Au{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Vd=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&h8(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Ad(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Ad(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=iV();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let u=dV(o,a);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(J.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),de())}isEqual(e){return this.batchId===e.batchId&&Iu(this.mutations,e.mutations,(t,r)=>G1(t,r))&&Iu(this.baseMutations,e.baseMutations,(t,r)=>G1(t,r))}},iT=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){W(e.mutations.length===r.length);let i=function(){return o8}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var Ld=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var sT=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var pt,be;function fV(n){switch(n){default:return z();case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0}}function pV(n){if(n===void 0)return ut("GRPC error has no .code"),N.UNKNOWN;switch(n){case pt.OK:return N.OK;case pt.CANCELLED:return N.CANCELLED;case pt.UNKNOWN:return N.UNKNOWN;case pt.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case pt.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case pt.INTERNAL:return N.INTERNAL;case pt.UNAVAILABLE:return N.UNAVAILABLE;case pt.UNAUTHENTICATED:return N.UNAUTHENTICATED;case pt.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case pt.NOT_FOUND:return N.NOT_FOUND;case pt.ALREADY_EXISTS:return N.ALREADY_EXISTS;case pt.PERMISSION_DENIED:return N.PERMISSION_DENIED;case pt.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case pt.ABORTED:return N.ABORTED;case pt.OUT_OF_RANGE:return N.OUT_OF_RANGE;case pt.UNIMPLEMENTED:return N.UNIMPLEMENTED;case pt.DATA_LOSS:return N.DATA_LOSS;default:return z()}}(be=pt||(pt={}))[be.OK=0]="OK",be[be.CANCELLED=1]="CANCELLED",be[be.UNKNOWN=2]="UNKNOWN",be[be.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",be[be.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",be[be.NOT_FOUND=5]="NOT_FOUND",be[be.ALREADY_EXISTS=6]="ALREADY_EXISTS",be[be.PERMISSION_DENIED=7]="PERMISSION_DENIED",be[be.UNAUTHENTICATED=16]="UNAUTHENTICATED",be[be.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",be[be.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",be[be.ABORTED=10]="ABORTED",be[be.OUT_OF_RANGE=11]="OUT_OF_RANGE",be[be.UNIMPLEMENTED=12]="UNIMPLEMENTED",be[be.INTERNAL=13]="INTERNAL",be[be.UNAVAILABLE=14]="UNAVAILABLE",be[be.DATA_LOSS=15]="DATA_LOSS";var K1=null;function gV(){return new TextEncoder}var p8=new is([4294967295,4294967295],0);function Q1(n){let e=gV().encode(n),t=new wD;return t.update(e),new Uint8Array(t.digest())}function Y1(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new is([t,r],0),new is([i,s],0)]}var oT=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new vo(`Invalid padding: ${t}`);if(r<0)throw new vo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new vo(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new vo(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=is.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(is.fromNumber(r)));return i.compare(p8)===1&&(i=new is([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=Q1(e),[r,i]=Y1(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let t=Q1(e),[r,i]=Y1(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},vo=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var jd=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Ud.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(J.min(),i,new ze(ae),gn(),de())}},Ud=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,de(),de(),de())}};var Eu=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Tm=class{constructor(e,t){this.targetId=e,this.me=t}},bm=class{constructor(e,t,r=dt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Am=class{constructor(){this.fe=0,this.ge=J1(),this.pe=dt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=de(),t=de(),r=de();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:z()}}),new Ud(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=J1()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,W(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},aT=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=gn(),this.qe=Z1(),this.Qe=new ze(ae)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:z()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(Im(s))if(r===0){let o=new q(s.path);this.Ue(t,o,yt.newNoDocument(o,J.min()))}else W(r===1);else{let o=this.Ye(t);if(o!==r){let a=this.Ze(e),u=a?this.Xe(a,e,o):1;if(u!==0){this.je(t);let l=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}K1?.et(function(d,h,g,y,v){var D,A,P,B,F,K;let te={localCacheCount:d,existenceFilterCount:h.count,databaseId:g.database,projectId:g.projectId},X=h.unchangedNames;return X&&(te.bloomFilter={applied:v===0,hashCount:(D=X?.hashCount)!==null&&D!==void 0?D:0,bitmapLength:(B=(P=(A=X?.bits)===null||A===void 0?void 0:A.bitmap)===null||P===void 0?void 0:P.length)!==null&&B!==void 0?B:0,padding:(K=(F=X?.bits)===null||F===void 0?void 0:F.padding)!==null&&K!==void 0?K:0,mightContain:I=>{var _;return(_=y?.mightContain(I))!==null&&_!==void 0&&_}}),te}(o,e.me,this.Le.tt(),a,u))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=fs(r).toUint8Array()}catch(u){if(u instanceof vm)return lr("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new oT(o,i,s)}catch(u){return lr(u instanceof vo?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&Im(a.target)){let u=new q(a.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,yt.newNoDocument(u,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let r=de();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{let l=this.Je(u);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new jd(e,t,this.Qe,this.ke,r);return this.ke=gn(),this.qe=Z1(),this.Qe=new ze(ae),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Am,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ue(ae),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||O("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Am),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function Z1(){return new ze(q.comparator)}function J1(){return new ze(q.comparator)}var g8={asc:"ASCENDING",desc:"DESCENDING"},m8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},y8={and:"AND",or:"OR"},uT=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function cT(n,e){return n.useProto3Json||Zd(e)?e:{value:e}}function Su(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function mV(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function _8(n,e){return Su(n,e.toTimestamp())}function lt(n){return W(!!n),J.fromTimestamp(function(t){let r=fi(t);return new Ze(r.seconds,r.nanos)}(n))}function Ub(n,e){return lT(n,e).canonicalString()}function lT(n,e){let t=function(i){return new Ae(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function yV(n){let e=Ae.fromString(n);return W(AV(e)),e}function Bd(n,e){return Ub(n.databaseId,e.path)}function Vr(n,e){let t=yV(e);if(t.get(1)!==n.databaseId.projectId)throw new k(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new k(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new q(wV(t))}function _V(n,e){return Ub(n.databaseId,e)}function vV(n){let e=yV(n);return e.length===4?Ae.emptyPath():wV(e)}function dT(n){return new Ae(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function wV(n){return W(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function X1(n,e,t){return{name:Bd(n,e),fields:t.value.mapValue.fields}}function EV(n,e,t){let r=Vr(n,e.name),i=lt(e.updateTime),s=e.createTime?lt(e.createTime):J.min(),o=new Kt({mapValue:{fields:e.fields}}),a=yt.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function v8(n,e){return"found"in e?function(r,i){W(!!i.found),i.found.name,i.found.updateTime;let s=Vr(r,i.found.name),o=lt(i.found.updateTime),a=i.found.createTime?lt(i.found.createTime):J.min(),u=new Kt({mapValue:{fields:i.found.fields}});return yt.newFoundDocument(s,o,a,u)}(n,e):"missing"in e?function(r,i){W(!!i.missing),W(!!i.readTime);let s=Vr(r,i.missing),o=lt(i.readTime);return yt.newNoDocument(s,o)}(n,e):z()}function w8(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:z()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,d){return l.useProto3Json?(W(d===void 0||typeof d=="string"),dt.fromBase64String(d||"")):(W(d===void 0||d instanceof Buffer||d instanceof Uint8Array),dt.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){let d=l.code===void 0?N.UNKNOWN:pV(l.code);return new k(d,l.message||"")}(o);t=new bm(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Vr(n,r.document.name),s=lt(r.document.updateTime),o=r.document.createTime?lt(r.document.createTime):J.min(),a=new Kt({mapValue:{fields:r.document.fields}}),u=yt.newFoundDocument(i,s,o,a),l=r.targetIds||[],d=r.removedTargetIds||[];t=new Eu(l,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Vr(n,r.document),s=r.readTime?lt(r.readTime):J.min(),o=yt.newNoDocument(i,s),a=r.removedTargetIds||[];t=new Eu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Vr(n,r.document),s=r.removedTargetIds||[];t=new Eu([],s,i,null)}else{if(!("filter"in e))return z();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new sT(i,s),a=r.targetId;t=new Tm(a,o)}}return t}function $d(n,e){let t;if(e instanceof _s)t={update:X1(n,e.key,e.value)};else if(e instanceof vs)t={delete:Bd(n,e.key)};else if(e instanceof hr)t={update:X1(n,e.key,e.data),updateMask:b8(e.fieldMask)};else{if(!(e instanceof Fd))return z();t={verify:Bd(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof ms)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof pi)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof gi)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ys)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw z()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:_8(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:z()}(n,e.precondition)),t}function hT(n,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?rt.updateTime(lt(s.updateTime)):s.exists!==void 0?rt.exists(s.exists):rt.none()}(e.currentDocument):rt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;if("setToServerValue"in a)W(a.setToServerValue==="REQUEST_TIME"),u=new ms;else if("appendMissingElements"in a){let d=a.appendMissingElements.values||[];u=new pi(d)}else if("removeAllFromArray"in a){let d=a.removeAllFromArray.values||[];u=new gi(d)}else"increment"in a?u=new ys(o,a.increment):z();let l=ct.fromServerFormat(a.fieldPath);return new To(l,u)}(n,i)):[];if(e.update){e.update.name;let i=Vr(n,e.update.name),s=new Kt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(u){let l=u.fieldPaths||[];return new kn(l.map(d=>ct.fromServerFormat(d)))}(e.updateMask);return new hr(i,s,o,t,r)}return new _s(i,s,t,r)}if(e.delete){let i=Vr(n,e.delete);return new vs(i,t)}if(e.verify){let i=Vr(n,e.verify);return new Fd(i,t)}return z()}function E8(n,e){return n&&n.length>0?(W(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?lt(i.updateTime):lt(s);return o.isEqual(J.min())&&(o=lt(s)),new rT(o,i.transformResults||[])}(t,e))):[]}function IV(n,e){return{documents:[_V(n,e.path)]}}function CV(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=_V(n,i);let s=function(l){if(l.length!==0)return bV(Oe.create(l,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(d=>function(g){return{field:gu(g.field),direction:C8(g.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=cT(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function DV(n){let e=vV(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){W(r===1);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(h){let g=TV(h);return g instanceof Oe&&Fb(g)?g.getFilters():[g]}(t.where));let o=[];t.orderBy&&(o=function(h){return h.map(g=>function(v){return new Co(mu(v.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(g))}(t.orderBy));let a=null;t.limit&&(a=function(h){let g;return g=typeof h=="object"?h.value:h,Zd(g)?null:g}(t.limit));let u=null;t.startAt&&(u=function(h){let g=!!h.before,y=h.values||[];return new Ur(y,g)}(t.startAt));let l=null;return t.endAt&&(l=function(h){let g=!h.before,y=h.values||[];return new Ur(y,g)}(t.endAt)),JF(e,i,o,s,a,"F",u,l)}function I8(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return z()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function TV(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=mu(t.unaryFilter.field);return Ee.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=mu(t.unaryFilter.field);return Ee.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=mu(t.unaryFilter.field);return Ee.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=mu(t.unaryFilter.field);return Ee.create(o,"!=",{nullValue:"NULL_VALUE"});default:return z()}}(n):n.fieldFilter!==void 0?function(t){return Ee.create(mu(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return z()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Oe.create(t.compositeFilter.filters.map(r=>TV(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return z()}}(t.compositeFilter.op))}(n):z()}function C8(n){return g8[n]}function D8(n){return m8[n]}function T8(n){return y8[n]}function gu(n){return{fieldPath:n.canonicalString()}}function mu(n){return ct.fromServerFormat(n.fieldPath)}function bV(n){return n instanceof Ee?function(t){if(t.op==="=="){if(F1(t.value))return{unaryFilter:{field:gu(t.field),op:"IS_NAN"}};if(O1(t.value))return{unaryFilter:{field:gu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(F1(t.value))return{unaryFilter:{field:gu(t.field),op:"IS_NOT_NAN"}};if(O1(t.value))return{unaryFilter:{field:gu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:gu(t.field),op:D8(t.op),value:t.value}}}(n):n instanceof Oe?function(t){let r=t.getFilters().map(i=>bV(i));return r.length===1?r[0]:{compositeFilter:{op:T8(t.op),filters:r}}}(n):z()}function b8(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function AV(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Ru=class n{constructor(e,t,r,i,s=J.min(),o=J.min(),a=dt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Sm=class{constructor(e){this.ct=e}};function A8(n,e){let t;if(e.document)t=EV(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=q.fromSegments(e.noDocument.path),i=Ao(e.noDocument.readTime);t=yt.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return z();{let r=q.fromSegments(e.unknownDocument.path),i=Ao(e.unknownDocument.version);t=yt.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let s=new Ze(i[0],i[1]);return J.fromTimestamp(s)}(e.readTime)),t}function eF(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Rm(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Bd(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Su(s,o.version.toTimestamp()),createTime:Su(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:bo(e.version)};else{if(!e.isUnknownDocument())return z();r.unknownDocument={path:t.path.toArray(),version:bo(e.version)}}return r}function Rm(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function bo(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ao(n){let e=new Ze(n.seconds,n.nanoseconds);return J.fromTimestamp(e)}function mo(n,e){let t=(e.baseMutations||[]).map(s=>hT(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>hT(n.ct,s)),i=Ze.fromMillis(e.localWriteTimeMs);return new Vd(e.batchId,i,t,r)}function Dd(n){let e=Ao(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Ao(n.lastLimboFreeSnapshotVersion):J.min(),r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return W(s.documents.length===1),un(Uu(vV(s.documents[0])))}(n.query):function(s){return un(DV(s))}(n.query),new Ru(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,dt.fromBase64String(n.resumeToken))}function SV(n,e){let t=bo(e.snapshotVersion),r=bo(e.lastLimboFreeSnapshotVersion),i;i=Im(e.target)?IV(n.ct,e.target):CV(n.ct,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Do(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Bb(n){let e=DV({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Dm(e,e.limit,"L"):e}function bD(n,e){return new Ld(e.largestBatchId,hT(n.ct,e.overlayMutation))}function tF(n,e){let t=e.path.lastSegment();return[n,an(e.path.popLast()),t]}function nF(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:bo(r.readTime),documentKey:an(r.documentKey.path),largestBatchId:r.largestBatchId}}var fT=class{getBundleMetadata(e,t){return rF(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Ao(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return rF(e).put(function(i){return{bundleId:i.id,createTime:bo(lt(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return iF(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:Bb(s.bundledQuery),readTime:Ao(s.readTime)}}(r)})}saveNamedQuery(e,t){return iF(e).put(function(i){return{name:i.name,readTime:bo(lt(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function rF(n){return Et(n,"bundles")}function iF(n){return Et(n,"namedQueries")}var xm=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return vd(e).get(tF(this.userId,t)).next(r=>r?bD(this.serializer,r):null)}getOverlays(e,t){let r=Or();return R.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((s,o)=>{let a=new Ld(t,o);i.push(this.ht(e,a))}),R.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(o=>i.add(an(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(vd(e).j("collectionPathOverlayIndex",a))}),R.waitFor(s)}getOverlaysForCollection(e,t,r){let i=Or(),s=an(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return vd(e).U("collectionPathOverlayIndex",o).next(a=>{for(let u of a){let l=bD(this.serializer,u);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let s=Or(),o,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return vd(e).J({index:"collectionGroupOverlayIndex",range:a},(u,l,d)=>{let h=bD(this.serializer,l);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>s)}ht(e,t){return vd(e).put(function(i,s,o){let[a,u,l]=tF(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:$d(i.ct,o.mutation)}}(this.serializer,this.userId,t))}};function vd(n){return Et(n,"documentOverlays")}var pT=class{Pt(e){return Et(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{let r=t?.value;return r?dt.fromUint8Array(r):dt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}};var di=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Ke(e.integerValue));else if("doubleValue"in e){let r=Ke(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Md(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=fi(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(fs(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?HF(e)?this.dt(t,Number.MAX_SAFE_INTEGER):dy(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):z()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let s=e.fields||{};this.dt(t,53);let o="value",a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(Ke(a)),this.Vt(o,t),this.Tt(s[o],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),q.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};di.vt=new di;function S8(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function sF(n){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=S8(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}var gT=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{let i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{let i=t.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){let t=this.qt(e),r=sF(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){let t=this.qt(e),r=sF(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){let t=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ft(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){let t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},mT=class{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}},yT=class{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}},yo=class{constructor(){this.jt=new gT,this.Ht=new mT(this.jt),this.Jt=new yT(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}};var _o=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Zt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function ss(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=oF(n.arrayValue,e.arrayValue),t!==0?t:(t=oF(n.directionalValue,e.directionalValue),t!==0?t:q.comparator(n.documentKey,e.documentKey)))}function oF(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var Mm=class{constructor(e){this.Xt=new Ue((t,r)=>ct.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(let t of e.filters){let r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(W(e.collectionGroup===this.collectionId),this.nn)return!1;let t=LD(e);if(t!==void 0&&!this.sn(t))return!1;let r=po(e),i=new Set,s=0,o=0;for(;s<r.length&&this.sn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt.size>0){let a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let u=r[s];if(!this.on(a,u)||!this._n(this.en[o++],u))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new Ue(ct.comparator),t=[];for(let r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new vu(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new vu(r.field,0))}for(let r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new vu(r.field,r.dir==="asc"?0:1)));return new Cu(Cu.UNKNOWN_ID,this.collectionId,t,xd.empty())}sn(e){for(let t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function RV(n){var e,t;if(W(n instanceof Ee||n instanceof Oe),n instanceof Ee){if(n instanceof Em){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>Ee.create(n.field,"==",s)))||[];return Oe.create(i,"or")}return n}let r=n.filters.map(i=>RV(i));return Oe.create(r,n.op)}function R8(n){if(n.getFilters().length===0)return[];let e=wT(RV(n));return W(xV(e)),_T(e)||vT(e)?[e]:e.getFilters()}function _T(n){return n instanceof Ee}function vT(n){return n instanceof Oe&&Fb(n)}function xV(n){return _T(n)||vT(n)||function(t){if(t instanceof Oe&&zD(t)){for(let r of t.getFilters())if(!_T(r)&&!vT(r))return!1;return!0}return!1}(n)}function wT(n){if(W(n instanceof Ee||n instanceof Oe),n instanceof Ee)return n;if(n.filters.length===1)return wT(n.filters[0]);let e=n.filters.map(r=>wT(r)),t=Oe.create(e,n.op);return t=Nm(t),xV(t)?t:(W(t instanceof Oe),W(Tu(t)),W(t.filters.length>1),t.filters.reduce((r,i)=>$b(r,i)))}function $b(n,e){let t;return W(n instanceof Ee||n instanceof Oe),W(e instanceof Ee||e instanceof Oe),t=n instanceof Ee?e instanceof Ee?function(i,s){return Oe.create([i,s],"and")}(n,e):aF(n,e):e instanceof Ee?aF(e,n):function(i,s){if(W(i.filters.length>0&&s.filters.length>0),Tu(i)&&Tu(s))return QF(i,s.getFilters());let o=zD(i)?i:s,a=zD(i)?s:i,u=o.filters.map(l=>$b(l,a));return Oe.create(u,"or")}(n,e),Nm(t)}function aF(n,e){if(Tu(e))return QF(e,n.getFilters());{let t=e.filters.map(r=>$b(n,r));return Oe.create(t,"or")}}function Nm(n){if(W(n instanceof Ee||n instanceof Oe),n instanceof Ee)return n;let e=n.getFilters();if(e.length===1)return Nm(e[0]);if(WF(n))return n;let t=e.map(i=>Nm(i)),r=[];return t.forEach(i=>{i instanceof Ee?r.push(i):i instanceof Oe&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Oe.create(r,n.op)}var ET=class{constructor(){this.un=new qd}addToCollectionParentIndex(e,t){return this.un.add(t),R.resolve()}getCollectionParents(e,t){return R.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return R.resolve()}deleteFieldIndex(e,t){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,t){return R.resolve()}getDocumentsMatchingTarget(e,t){return R.resolve(null)}getIndexType(e,t){return R.resolve(0)}getFieldIndexes(e,t){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,t){return R.resolve(Qn.min())}getMinOffsetFromCollectionGroup(e,t){return R.resolve(Qn.min())}updateCollectionGroup(e,t,r){return R.resolve()}updateIndexEntries(e,t){return R.resolve()}},qd=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ue(Ae.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ue(Ae.comparator)).toArray()}};var im=new Uint8Array(0),IT=class{constructor(e,t){this.databaseId=t,this.cn=new qd,this.ln=new Br(r=>Do(r),(r,i)=>Jd(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});let s={collectionId:r,parent:an(i)};return uF(e).put(s)}return R.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[NF(t),""],!1,!0);return uF(e).U(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;r.push(kr(o.parent))}return r})}addFieldIndex(e,t){let r=wd(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(t);delete i.indexId;let s=r.add(i);if(t.indexState){let o=du(e);return s.next(a=>{o.put(nF(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let r=wd(e),i=du(e),s=lu(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=wd(e),r=lu(e),i=du(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return R.forEach(this.hn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new Mm(r).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let r=lu(e),i=!0,s=new Map;return R.forEach(this.hn(t),o=>this.Pn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=de(),a=[];return R.forEach(s,(u,l)=>{O("IndexedDbIndexManager",`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map(K=>`${K.fieldPath}:${K.kind}`).join(",")}`}(u)} to execute ${Do(t)}`);let d=function(F,K){let te=LD(K);if(te===void 0)return null;for(let X of Cm(F,te.fieldPath))switch(X.op){case"array-contains-any":return X.value.arrayValue.values||[];case"array-contains":return[X.value]}return null}(l,u),h=function(F,K){let te=new Map;for(let X of po(K))for(let I of Cm(F,X.fieldPath))switch(I.op){case"==":case"in":te.set(X.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return te.set(X.fieldPath.canonicalString(),I.value),Array.from(te.values())}return null}(l,u),g=function(F,K){let te=[],X=!0;for(let I of po(K)){let _=I.kind===0?B1(F,I.fieldPath,F.startAt):$1(F,I.fieldPath,F.startAt);te.push(_.value),X&&(X=_.inclusive)}return new Ur(te,X)}(l,u),y=function(F,K){let te=[],X=!0;for(let I of po(K)){let _=I.kind===0?$1(F,I.fieldPath,F.endAt):B1(F,I.fieldPath,F.endAt);te.push(_.value),X&&(X=_.inclusive)}return new Ur(te,X)}(l,u),v=this.In(u,l,g),D=this.In(u,l,y),A=this.Tn(u,l,h),P=this.En(u.indexId,d,v,g.inclusive,D,y.inclusive,A);return R.forEach(P,B=>r.G(B,t.limit).next(F=>{F.forEach(K=>{let te=q.fromSegments(K.documentKey);o.has(te)||(o=o.add(te),a.push(te))})}))}).next(()=>a)}return R.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=R8(Oe.create(e.filters,"and")).map(r=>tT(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,i,s,o,a){let u=(t!=null?t.length:1)*Math.max(r.length,s.length),l=u/(t!=null?t.length:1),d=[];for(let h=0;h<u;++h){let g=t?this.dn(t[h/l]):im,y=this.An(e,g,r[h%l],i),v=this.Rn(e,g,s[h%l],o),D=a.map(A=>this.An(e,g,A,!0));d.push(...this.createRange(y,v,D))}return d}An(e,t,r,i){let s=new _o(e,q.empty(),t,r);return i?s:s.Zt()}Rn(e,t,r,i){let s=new _o(e,q.empty(),t,r);return i?s.Zt():s}Pn(e,t){let r=new Mm(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2,i=this.hn(t);return R.forEach(i,s=>this.Pn(e,s).next(o=>{o?r!==0&&o.fields.length<function(u){let l=new Ue(ct.comparator),d=!1;for(let h of u.filters)for(let g of h.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?d=!0:l=l.add(g.field));for(let h of u.orderBy)h.field.isKeyField()||(l=l.add(h.field));return l.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}Vn(e,t){let r=new yo;for(let i of po(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=r.Yt(i.kind);di.vt.It(s,o)}return r.zt()}dn(e){let t=new yo;return di.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){let r=new yo;return di.vt.It(Io(this.databaseId,t),r.Yt(function(s){let o=po(s);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let i=[];i.push(new yo);let s=0;for(let o of po(e)){let a=r[s++];for(let u of i)if(this.fn(t,o.fieldPath)&&Od(a))i=this.gn(i,o,a);else{let l=u.Yt(o.kind);di.vt.It(a,l)}}return this.pn(i)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let u=new yo;u.seed(a.zt()),di.vt.It(o,u.Yt(t.kind)),s.push(u)}return s}fn(e,t){return!!e.filters.find(r=>r instanceof Ee&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=wd(e),i=du(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(s=>{let o=[];return R.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(d,h){let g=h?new xd(h.sequenceNumber,new Qn(Ao(h.readTime),new q(kr(h.documentKey)),h.largestBatchId)):xd.empty(),y=d.fields.map(([v,D])=>new vu(ct.fromServerFormat(v),D));return new Cu(d.indexId,d.collectionGroup,y,g)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ae(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=wd(e),s=du(e);return this.yn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>R.forEach(a,u=>s.put(nF(u.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){let r=new Map;return R.forEach(t,(i,s)=>{let o=r.get(i.collectionGroup);return(o?R.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),R.forEach(a,u=>this.wn(e,i,u).next(l=>{let d=this.Sn(s,u);return l.isEqual(d)?R.resolve():this.bn(e,s,u,l,d)}))))})}Dn(e,t,r,i){return lu(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,i){return lu(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){let i=lu(e),s=new Ue(ss);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,a)=>{s=s.add(new _o(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}Sn(e,t){let r=new Ue(ss),i=this.Vn(t,e);if(i==null)return r;let s=LD(t);if(s!=null){let o=e.data.field(s.fieldPath);if(Od(o))for(let a of o.arrayValue.values||[])r=r.add(new _o(t.indexId,e.key,this.dn(a),i))}else r=r.add(new _o(t.indexId,e.key,im,i));return r}bn(e,t,r,i,s){O("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let o=[];return function(u,l,d,h,g){let y=u.getIterator(),v=l.getIterator(),D=cu(y),A=cu(v);for(;D||A;){let P=!1,B=!1;if(D&&A){let F=d(D,A);F<0?B=!0:F>0&&(P=!0)}else D!=null?B=!0:P=!0;P?(h(A),A=cu(v)):B?(g(D),D=cu(y)):(D=cu(y),A=cu(v))}}(i,s,ss,a=>{o.push(this.Dn(e,t,r,a))},a=>{o.push(this.vn(e,t,r,a))}),R.waitFor(o)}yn(e){let t=1;return du(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>ss(o,a)).filter((o,a,u)=>!a||ss(o,u[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=ss(o,e),u=ss(o,t);if(a===0)i[0]=e.Zt();else if(a>0&&u<0)i.push(o),i.push(o.Zt());else if(u>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.Cn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,im,[]],u=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,im,[]];s.push(IDBKeyRange.bound(a,u))}return s}Cn(e,t){return ss(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(cF)}getMinOffset(e,t){return R.mapArray(this.hn(t),r=>this.Pn(e,r).next(i=>i||z())).next(cF)}};function uF(n){return Et(n,"collectionParents")}function lu(n){return Et(n,"indexEntries")}function wd(n){return Et(n,"indexConfiguration")}function du(n){return Et(n,"indexState")}function cF(n){W(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;Nb(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Qn(e.readTime,e.documentKey,t)}var lF={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Kn=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function MV(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId),a=0,u=r.J({range:o},(d,h,g)=>(a++,g.delete()));s.push(u.next(()=>{W(a===1)}));let l=[];for(let d of t.mutations){let h=LF(e,d.key.path,t.batchId);s.push(i.delete(h)),l.push(d.key)}return R.waitFor(s).next(()=>l)}function Pm(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw z();e=n.noDocument}return JSON.stringify(e).length}Kn.DEFAULT_COLLECTION_PERCENTILE=10,Kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Kn.DEFAULT=new Kn(41943040,Kn.DEFAULT_COLLECTION_PERCENTILE,Kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Kn.DISABLED=new Kn(-1,0,0);var km=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,t,r,i){W(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new n(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return os(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let s=yu(e),o=os(e);return o.add({}).next(a=>{W(typeof a=="number");let u=new Vd(a,t,r,i),l=function(y,v,D){let A=D.baseMutations.map(B=>$d(y.ct,B)),P=D.mutations.map(B=>$d(y.ct,B));return{userId:v,batchId:D.batchId,localWriteTimeMs:D.localWriteTime.toMillis(),baseMutations:A,mutations:P}}(this.serializer,this.userId,u),d=[],h=new Ue((g,y)=>ae(g.canonicalString(),y.canonicalString()));for(let g of i){let y=LF(this.userId,g.key.path,a);h=h.add(g.key.path.popLast()),d.push(o.put(l)),d.push(s.put(y,O5))}return h.forEach(g=>{d.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Fn[a]=u.keys()}),R.waitFor(d).next(()=>u)})}lookupMutationBatch(e,t){return os(e).get(t).next(r=>r?(W(r.userId===this.userId),mo(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?R.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Fn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return os(e).J({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&(W(a.batchId>=r),s=mo(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return os(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return os(e).U("userMutationsIndex",t).next(r=>r.map(i=>mo(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=um(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return yu(e).J({range:i},(o,a,u)=>{let[l,d,h]=o,g=kr(d);if(l===this.userId&&t.path.isEqual(g))return os(e).get(h).next(y=>{if(!y)throw z();W(y.userId===this.userId),s.push(mo(this.serializer,y))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ue(ae),i=[];return t.forEach(s=>{let o=um(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=yu(e).J({range:a},(l,d,h)=>{let[g,y,v]=l,D=kr(y);g===this.userId&&s.path.isEqual(D)?r=r.add(v):h.done()});i.push(u)}),R.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=um(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new Ue(ae);return yu(e).J({range:o},(u,l,d)=>{let[h,g,y]=u,v=kr(g);h===this.userId&&r.isPrefixOf(v)?v.length===i&&(a=a.add(y)):d.done()}).next(()=>this.xn(e,a))}xn(e,t){let r=[],i=[];return t.forEach(s=>{i.push(os(e).get(s).next(o=>{if(o===null)throw z();W(o.userId===this.userId),r.push(mo(this.serializer,o))}))}),R.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return MV(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),R.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return R.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return yu(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){let u=kr(s[1]);i.push(u)}else a.done()}).next(()=>{W(i.length===0)})})}containsKey(e,t){return NV(e,this.userId,t)}Nn(e){return PV(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function NV(n,e,t){let r=um(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return yu(n).J({range:s,H:!0},(a,u,l)=>{let[d,h,g]=a;d===e&&h===i&&(o=!0),l.done()}).next(()=>o)}function os(n){return Et(n,"mutations")}function yu(n){return Et(n,"documentMutations")}function PV(n){return Et(n,"mutationQueues")}var xu=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var CT=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{let r=new xu(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>J.fromTimestamp(new Ze(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>hu(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(W(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let i=0,s=[];return hu(e).J((o,a)=>{let u=Dd(a);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>R.waitFor(s)).next(()=>i)}forEachTarget(e,t){return hu(e).J((r,i)=>{let s=Dd(i);t(s)})}qn(e){return dF(e).get("targetGlobalKey").next(t=>(W(t!==null),t))}Qn(e,t){return dF(e).put("targetGlobalKey",t)}Kn(e,t){return hu(e).put(SV(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=Do(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return hu(e).J({range:i,index:"queryTargetsIndex"},(o,a,u)=>{let l=Dd(a);Jd(t,l.target)&&(s=l,u.done())}).next(()=>s)}addMatchingKeys(e,t,r){let i=[],s=as(e);return t.forEach(o=>{let a=an(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),R.waitFor(i)}removeMatchingKeys(e,t,r){let i=as(e);return R.forEach(t,s=>{let o=an(s.path);return R.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){let r=as(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=as(e),s=de();return i.J({range:r,H:!0},(o,a,u)=>{let l=kr(o[1]),d=new q(l);s=s.add(d)}).next(()=>s)}containsKey(e,t){let r=an(t.path),i=IDBKeyRange.bound([r],[NF(r)],!1,!0),s=0;return as(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],u,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}ot(e,t){return hu(e).get(t).next(r=>r?Dd(r):null)}};function hu(n){return Et(n,"targets")}function dF(n){return Et(n,"targetGlobal")}function as(n){return Et(n,"targetDocuments")}function hF([n,e],[t,r]){let i=ae(n,t);return i===0?ae(e,r):i}var DT=class{constructor(e){this.Un=e,this.buffer=new Ue(hF),this.Wn=0}Gn(){return++this.Wn}zn(e){let t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();hF(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},TT=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){O("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>x(this,null,function*(){this.jn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Is(t)?O("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield Es(t)}yield this.Hn(3e5)}))}},bT=class{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return R.resolve(Pn.oe);let r=new DT(t);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(O("LruGarbageCollector","Garbage collection skipped; disabled"),R.resolve(lF)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(O("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),lF):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,i,s,o,a,u,l,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(O("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,t))).next(h=>(s=h,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(l=Date.now(),fu()<=Fn.DEBUG&&O("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(u-a)+`ms
	Removed ${h} documents in `+(l-u)+`ms
Total Duration: ${l-d}ms`),R.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}};function x8(n,e){return new bT(n,e)}var AT=class{constructor(e,t){this.db=e,this.garbageCollector=x8(this,t)}Yn(e){let t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,i)=>t(i))}addReference(e,t,r){return sm(e,r)}removeReference(e,t,r){return sm(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return sm(e,t)}nr(e,t){return function(i,s){let o=!1;return PV(i).Y(a=>NV(i,a,s).next(u=>(u&&(o=!0),R.resolve(!u)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.tr(e,(o,a)=>{if(a<=t){let u=this.nr(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,J.min()),as(e).delete(function(h){return[0,an(h.path)]}(o))))});i.push(u)}}).next(()=>R.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return sm(e,t)}tr(e,t){let r=as(e),i,s=Pn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:l})=>{o===0?(s!==Pn.oe&&t(new q(kr(i)),s),s=l,i=u):s=Pn.oe}).next(()=>{s!==Pn.oe&&t(new q(kr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function sm(n,e){return as(n).put(function(r,i){return{targetId:0,path:an(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var Om=class{constructor(){this.changes=new Br(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,yt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?R.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var ST=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return fo(e).put(r)}removeEntry(e,t,r){return fo(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Rm(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=yt.newInvalidDocument(t);return fo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ed(t))},(i,s)=>{r=this.ir(t,s)}).next(()=>r)}sr(e,t){let r={size:0,document:yt.newInvalidDocument(t)};return fo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ed(t))},(i,s)=>{r={document:this.ir(t,s),size:Pm(s)}}).next(()=>r)}getEntries(e,t){let r=gn();return this._r(e,t,(i,s)=>{let o=this.ir(i,s);r=r.insert(i,o)}).next(()=>r)}ar(e,t){let r=gn(),i=new ze(q.comparator);return this._r(e,t,(s,o)=>{let a=this.ir(s,o);r=r.insert(s,a),i=i.insert(s,Pm(o))}).next(()=>({documents:r,ur:i}))}_r(e,t,r){if(t.isEmpty())return R.resolve();let i=new Ue(gF);t.forEach(u=>i=i.add(u));let s=IDBKeyRange.bound(Ed(i.first()),Ed(i.last())),o=i.getIterator(),a=o.getNext();return fo(e).J({index:"documentKeyIndex",range:s},(u,l,d)=>{let h=q.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&gF(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?d.$(Ed(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){let o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Rm(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return fo(e).U(IDBKeyRange.bound(a,u,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let d=gn();for(let h of l){let g=this.ir(q.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);g.isFoundDocument()&&(eh(t,g)||i.has(g.key))&&(d=d.insert(g.key,g))}return d})}getAllFromCollectionGroup(e,t,r,i){let s=gn(),o=pF(t,r),a=pF(t,Qn.max());return fo(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,l,d)=>{let h=this.ir(q.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(h.key,h),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new RT(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return fF(e).get("remoteDocumentGlobalKey").next(t=>(W(!!t),t))}rr(e,t){return fF(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){let r=A8(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(J.min())))return r}return yt.newInvalidDocument(e)}};function kV(n){return new ST(n)}var RT=class extends Om{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Br(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new Ue((s,o)=>ae(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.lr.get(s);if(t.push(this.cr.removeEntry(e,s,a.readTime)),o.isValidDocument()){let u=eF(this.cr.serializer,o);i=i.add(s.path.popLast());let l=Pm(u);r+=l-a.size,t.push(this.cr.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){let u=eF(this.cr.serializer,o.convertToNoDocument(J.min()));t.push(this.cr.addEntry(e,s,u))}}),i.forEach(s=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.cr.updateMetadata(e,r)),R.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:i})=>(i.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function fF(n){return Et(n,"remoteDocumentGlobal")}function fo(n){return Et(n,"remoteDocumentsV14")}function Ed(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function pF(n,e){let t=e.documentKey.path.toArray();return[n,Rm(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function gF(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=ae(t[s],r[s]),i)return i;return i=ae(t.length,r.length),i||(i=ae(t[t.length-2],r[r.length-2]),i||ae(t[t.length-1],r[r.length-1]))}var xT=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Fm=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Ad(r.mutation,i,kn.empty(),Ze.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,de()).next(()=>r))}getLocalViewOfDocuments(e,t,r=de()){let i=Or();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Cd();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=Or();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,de()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=gn(),o=bd(),a=function(){return bd()}();return t.forEach((u,l)=>{let d=r.get(l.key);i.has(l.key)&&(d===void 0||d.mutation instanceof hr)?s=s.insert(l.key,l):d!==void 0?(o.set(l.key,d.mutation.getFieldMask()),Ad(d.mutation,l,d.mutation.getFieldMask(),Ze.now())):o.set(l.key,kn.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((l,d)=>o.set(l,d)),t.forEach((l,d)=>{var h;return a.set(l,new xT(d,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){let r=bd(),i=new ze((o,a)=>o-a),s=de();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(u=>{let l=t.get(u);if(l===null)return;let d=r.get(u)||kn.empty();d=a.applyToLocalView(l,d),r.set(u,d);let h=(i.get(a.batchId)||de()).add(u);i=i.insert(a.batchId,h)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let u=a.getNext(),l=u.key,d=u.value,h=iV();d.forEach(g=>{if(!s.has(g)){let y=dV(t.get(g),r.get(g));y!==null&&h.set(g,y),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return R.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return q.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Vb(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):R.resolve(Or()),a=-1,u=s;return o.next(l=>R.forEach(l,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(d)?R.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{u=u.insert(d,g)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,u,l,de())).next(d=>({batchId:a,changes:rV(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new q(t)).next(r=>{let i=Cd();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=Cd();return this.indexManager.getCollectionParents(e,s).next(a=>R.forEach(a,u=>{let l=function(h,g){return new dr(g,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(d=>{d.forEach((h,g)=>{o=o.insert(h,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((u,l)=>{let d=l.getKey();o.get(d)===null&&(o=o.insert(d,yt.newInvalidDocument(d)))});let a=Cd();return o.forEach((u,l)=>{let d=s.get(u);d!==void 0&&Ad(d.mutation,l,kn.empty(),Ze.now()),eh(t,l)&&(a=a.insert(u,l))}),a})}};var MT=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return R.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:lt(i.createTime)}}(t)),R.resolve()}getNamedQuery(e,t){return R.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:Bb(i.bundledQuery),readTime:lt(i.readTime)}}(t)),R.resolve()}};var NT=class{constructor(){this.overlays=new ze(q.comparator),this.Ir=new Map}getOverlay(e,t){return R.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Or();return R.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),R.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),R.resolve()}getOverlaysForCollection(e,t,r){let i=Or(),s=t.length+1,o=new q(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let u=a.getNext().value,l=u.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return R.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new ze((l,d)=>l-d),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let d=s.get(l.largestBatchId);d===null&&(d=Or(),s=s.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}let a=Or(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((l,d)=>a.set(l,d)),!(a.size()>=i)););return R.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Ld(t,r));let s=this.Ir.get(t);s===void 0&&(s=de(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}};var PT=class{constructor(){this.sessionToken=dt.EMPTY_BYTE_STRING}getSessionToken(e){return R.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,R.resolve()}};var Hd=class{constructor(){this.Tr=new Ue(gt.Er),this.dr=new Ue(gt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new gt(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new gt(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new q(new Ae([])),r=new gt(t,e),i=new gt(t,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new q(new Ae([])),r=new gt(t,e),i=new gt(t,e+1),s=de();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new gt(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},gt=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return q.comparator(e.key,t.key)||ae(e.wr,t.wr)}static Ar(e,t){return ae(e.wr,t.wr)||q.comparator(e.key,t.key)}};var kT=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Ue(gt.Er)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Vd(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.br=this.br.add(new gt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return R.resolve(o)}lookupMutationBatch(e,t){return R.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),s=i<0?0:i;return R.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new gt(t,0),i=new gt(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{let a=this.Dr(o.wr);s.push(a)}),R.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ue(ae);return t.forEach(i=>{let s=new gt(i,0),o=new gt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{r=r.add(a.wr)})}),R.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;q.isDocumentKey(s)||(s=s.child(""));let o=new gt(new q(s),0),a=new Ue(ae);return this.br.forEachWhile(u=>{let l=u.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(u.wr)),!0)},o),R.resolve(this.Cr(a))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){W(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return R.forEach(t.mutations,i=>{let s=new gt(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new gt(t,0),i=this.br.firstAfterOrEqual(r);return R.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var OT=class{constructor(e){this.Mr=e,this.docs=function(){return new ze(q.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return R.resolve(r?r.document.mutableCopy():yt.newInvalidDocument(t))}getEntries(e,t){let r=gn();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():yt.newInvalidDocument(i))}),R.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=gn(),o=t.path,a=new q(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){let{key:l,value:{document:d}}=u.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||Nb(kF(d),r)<=0||(i.has(d.key)||eh(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return R.resolve(s)}getAllFromCollectionGroup(e,t,r,i){z()}Or(e,t){return R.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new FT(this)}getSize(e){return R.resolve(this.size)}},FT=class extends Om{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),R.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var VT=class{constructor(e){this.persistence=e,this.Nr=new Br(t=>Do(t),Jd),this.lastRemoteSnapshotVersion=J.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Hd,this.targetCount=0,this.kr=xu.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),R.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new xu(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,R.resolve()}updateTargetData(e,t){return this.Kn(t),R.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),R.waitFor(s).next(()=>i)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return R.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),R.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),R.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),R.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return R.resolve(r)}containsKey(e,t){return R.resolve(this.Br.containsKey(t))}};var Vm=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Pn(0),this.Kr=!1,this.Kr=!0,this.$r=new PT,this.referenceDelegate=e(this),this.Ur=new VT(this),this.indexManager=new ET,this.remoteDocumentCache=function(i){return new OT(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new Sm(t),this.Gr=new MT(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new NT,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new kT(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){O("MemoryPersistence","Starting transaction:",e);let i=new LT(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return R.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},LT=class extends mm{constructor(e){super(),this.currentSequenceNumber=e}},Lm=class n{constructor(e){this.persistence=e,this.Jr=new Hd,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw z()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),R.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),R.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),R.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.Xr,r=>{let i=q.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,J.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return R.or([()=>R.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var jT=class{constructor(e){this.serializer=e}O(e,t,r,i){let s=new ym("createOrUpgrade",t);r<1&&i>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",M1,{unique:!0}),u.createObjectStore("documentMutations")}(e),mF(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=R.resolve();return r<3&&i>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),mF(e)),o=o.next(()=>function(u){let l=u.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:J.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(u,l){return l.store("mutations").U().next(d=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",M1,{unique:!0});let h=l.store("mutations"),g=d.map(y=>h.put(y));return R.waitFor(g)})}(e,s))),o=o.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.ni(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),r<7&&i>=7&&(o=o.next(()=>this.ii(s))),r<8&&i>=8&&(o=o.next(()=>this.si(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.oi(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(u){let l=u.createObjectStore("documentOverlays",{keyPath:W5});l.createIndex("collectionPathOverlayIndex",K5,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",Q5,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){let l=u.createObjectStore("remoteDocumentsV14",{keyPath:F5});l.createIndex("documentKeyIndex",V5),l.createIndex("collectionGroupIndex",L5)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ai(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:q5}).createIndex("sequenceNumberIndex",H5,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:G5}).createIndex("documentKeyIndex",z5,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(u){u.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=Pm(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>R.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>R.forEach(a,u=>{W(u.userId===s.userId);let l=mo(this.serializer,u);return MV(e,s.userId,l).next(()=>{})}))}))}ii(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.J((o,a)=>{let u=new Ae(o),l=function(h){return[0,an(h)]}(u);s.push(t.get(l).next(d=>d?R.resolve():(h=>t.put({targetId:0,path:an(h),sequenceNumber:i.highestListenSequenceNumber}))(u)))}).next(()=>R.waitFor(s))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:$5});let r=t.store("collectionParents"),i=new qd,s=o=>{if(i.add(o)){let a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:an(u)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{let u=new Ae(o);return s(u.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,u],l)=>{let d=kr(a);return s(d.popLast())}))}oi(e){let t=e.store("targets");return t.J((r,i)=>{let s=Dd(i),o=SV(this.serializer,s);return t.put(o)})}_i(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((s,o)=>{let a=t.store("remoteDocumentsV14"),u=function(h){return h.document?new q(Ae.fromString(h.document.name).popFirst(5)):h.noDocument?q.fromSegments(h.noDocument.path):h.unknownDocument?q.fromSegments(h.unknownDocument.path):z()}(o).path.toArray(),l={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(l))}).next(()=>R.waitFor(i))}ai(e,t){let r=t.store("mutations"),i=kV(this.serializer),s=new Vm(Lm.Zr,this.serializer.ct);return r.U().next(o=>{let a=new Map;return o.forEach(u=>{var l;let d=(l=a.get(u.userId))!==null&&l!==void 0?l:de();mo(this.serializer,u).keys().forEach(h=>d=d.add(h)),a.set(u.userId,d)}),R.forEach(a,(u,l)=>{let d=new mt(l),h=xm.lt(this.serializer,d),g=s.getIndexManager(d),y=km.lt(d,this.serializer,g,s.referenceDelegate);return new Fm(i,y,h,g).recalculateAndSaveOverlaysForDocumentKeys(new Nd(t,Pn.oe),u).next()})})}};function mF(n){n.createObjectStore("targetDocuments",{keyPath:U5}).createIndex("documentTargetsIndex",B5,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",j5,{unique:!0}),n.createObjectStore("targetGlobal")}var AD="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",UT=class n{constructor(e,t,r,i,s,o,a,u,l,d,h=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=s,this.window=o,this.document=a,this.ci=l,this.li=d,this.hi=h,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=g=>Promise.resolve(),!n.D())throw new k(N.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new AT(this,i),this.Ai=t+"main",this.serializer=new Sm(u),this.Ri=new hs(this.Ai,this.hi,new jT(this.serializer)),this.$r=new pT,this.Ur=new CT(this.referenceDelegate,this.serializer),this.remoteDocumentCache=kV(this.serializer),this.Gr=new fT,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&ut("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new k(N.FAILED_PRECONDITION,AD);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Pn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=t=>x(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(t=>x(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(()=>x(this,null,function*(){this.started&&(yield this.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>om(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(Is(e))return O("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return O("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Id(e).get("owner").next(t=>R.resolve(this.vi(t)))}Ci(e){return om(e).delete(this.clientId)}Fi(){return x(this,null,function*(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=Et(t,"clientMetadata");return r.U().next(i=>{let s=this.xi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return R.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(let t of e)this.Vi.removeItem(this.Oi(t.clientId))}})}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?R.resolve(!0):Id(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new k(N.FAILED_PRECONDITION,AD);return!1}}return!(!this.networkEnabled||!this.inForeground)||om(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&O("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return x(this,null,function*(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),yield this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new Nd(e,Pn.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()})}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>om(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return km.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new IT(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return xm.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){O("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=function(u){return u===17?J5:u===16?Z5:u===15?kb:u===14?BF:u===13?UF:u===12?Y5:u===11?jF:void z()}(this.hi),o;return this.Ri.runTransaction(e,i,s,a=>(o=new Nd(a,this.Qr?this.Qr.next():Pn.oe),t==="readwrite-primary"?this.wi(o).next(u=>!!u||this.Si(o)).next(u=>{if(!u)throw ut(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new k(N.FAILED_PRECONDITION,OF);return r(o)}).next(u=>this.Di(o).next(()=>u)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return Id(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new k(N.FAILED_PRECONDITION,AD)})}Di(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Id(e).put("owner",t)}static D(){return hs.D()}bi(e){let t=Id(e);return t.get("owner").next(r=>this.vi(r)?(O("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):R.resolve())}Mi(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(ut(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();let t=/(?:Version|Mobile)\/1[456]/;a_()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{let r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return O("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ut("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){ut("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Id(n){return Et(n,"owner")}function om(n){return Et(n,"clientMetadata")}function qb(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var BT=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=de(),i=de();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var $T=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var jm=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return a_()?8:FF(gc())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new $T;return this.Xi(e,t,o).next(a=>{if(s.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(fu()<=Fn.DEBUG&&O("QueryEngine","SDK will not create cache indexes for query:",pu(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),R.resolve()):(fu()<=Fn.DEBUG&&O("QueryEngine","Query:",pu(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(fu()<=Fn.DEBUG&&O("QueryEngine","The SDK decides to create cache indexes for query:",pu(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,un(t))):R.resolve())}Yi(e,t){if(q1(t))return R.resolve(null);let r=un(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Dm(t,null,"F"),r=un(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=de(...s);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{let l=this.ts(t,a);return this.ns(t,l,o,u.readTime)?this.Yi(e,Dm(t,null,"F")):this.rs(e,l,t,u)}))})))}Zi(e,t,r,i){return q1(t)||i.isEqual(J.min())?R.resolve(null):this.Ji.getDocuments(e,r).next(s=>{let o=this.ts(t,s);return this.ns(t,o,r,i)?R.resolve(null):(fu()<=Fn.DEBUG&&O("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),pu(t)),this.rs(e,o,t,PF(i,-1)).next(a=>a))})}ts(e,t){let r=new Ue(tV(e));return t.forEach((i,s)=>{eh(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return fu()<=Fn.DEBUG&&O("QueryEngine","Using full collection scan to execute query:",pu(t)),this.Ji.getDocumentsMatchingQuery(e,t,Qn.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var qT=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new ze(ae),this._s=new Br(s=>Do(s),Jd),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Fm(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function OV(n,e,t,r){return new qT(n,e,t,r)}function FV(n,e){return x(this,null,function*(){let t=$(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],u=de();for(let l of i){o.push(l.batchId);for(let d of l.mutations)u=u.add(d.key)}for(let l of s){a.push(l.batchId);for(let d of l.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(r,u).next(l=>({hs:l,removedBatchIds:o,addedBatchIds:a}))})})})}function M8(n,e){let t=$(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,u,l,d){let h=l.batch,g=h.keys(),y=R.resolve();return g.forEach(v=>{y=y.next(()=>d.getEntry(u,v)).next(D=>{let A=l.docVersions.get(v);W(A!==null),D.version.compareTo(A)<0&&(h.applyToRemoteDocument(D,l),D.isValidDocument()&&(D.setReadTime(l.commitVersion),d.addEntry(D)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(u,h))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=de();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(u=u.add(a.batch.mutations[l].key));return u}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function VV(n){let e=$(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function N8(n,e){let t=$(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let a=[];e.targetChanges.forEach((d,h)=>{let g=i.get(h);if(!g)return;a.push(t.Ur.removeMatchingKeys(s,d.removedDocuments,h).next(()=>t.Ur.addMatchingKeys(s,d.addedDocuments,h)));let y=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?y=y.withResumeToken(dt.EMPTY_BYTE_STRING,J.min()).withLastLimboFreeSnapshotVersion(J.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,r)),i=i.insert(h,y),function(D,A,P){return D.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=3e8?!0:P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0}(g,y,d)&&a.push(t.Ur.updateTargetData(s,y))});let u=gn(),l=de();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(LV(s,o,e.documentUpdates).next(d=>{u=d.Ps,l=d.Is})),!r.isEqual(J.min())){let d=t.Ur.getLastRemoteSnapshotVersion(s).next(h=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return R.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,u,l)).next(()=>u)}).then(s=>(t.os=i,s))}function LV(n,e,t){let r=de(),i=de();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=gn();return t.forEach((a,u)=>{let l=s.get(a);u.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(J.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||u.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):O("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",u.version)}),{Ps:o,Is:i}})}function P8(n,e){let t=$(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Mu(n,e){let t=$(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,R.resolve(i)):t.Ur.allocateTargetId(r).next(o=>(i=new Ru(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function Nu(n,e,t){return x(this,null,function*(){let r=$(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Is(o))throw o;O("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function Um(n,e,t){let r=$(n),i=J.min(),s=de();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,l,d){let h=$(u),g=h._s.get(d);return g!==void 0?R.resolve(h.os.get(g)):h.Ur.getTargetData(l,d)}(r,o,un(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?i:J.min(),t?s:de())).next(a=>(BV(r,eV(e),a),{documents:a,Ts:s})))}function jV(n,e){let t=$(n),r=$(t.Ur),i=t.os.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function UV(n,e){let t=$(n),r=t.us.get(e)||J.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.cs.getAllFromCollectionGroup(i,e,PF(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(BV(t,e,i),i))}function BV(n,e,t){let r=n.us.get(e)||J.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}function k8(n,e,t,r){return x(this,null,function*(){let i=$(n),s=de(),o=gn();for(let l of t){let d=e.Es(l.metadata.name);l.document&&(s=s.add(d));let h=e.ds(l);h.setReadTime(e.As(l.metadata.readTime)),o=o.insert(d,h)}let a=i.cs.newChangeBuffer({trackRemovals:!0}),u=yield Mu(i,function(d){return un(Uu(Ae.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>LV(l,a,o).next(d=>(a.apply(l),d)).next(d=>i.Ur.removeMatchingKeysForTargetId(l,u.targetId).next(()=>i.Ur.addMatchingKeys(l,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,d.Ps,d.Is)).next(()=>d.Ps)))})}function O8(r,i){return x(this,arguments,function*(n,e,t=de()){let s=yield Mu(n,un(Bb(e.bundledQuery))),o=$(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{let u=lt(e.readTime);if(s.snapshotVersion.compareTo(u)>=0)return o.Gr.saveNamedQuery(a,e);let l=s.withResumeToken(dt.EMPTY_BYTE_STRING,u);return o.os=o.os.insert(l.targetId,l),o.Ur.updateTargetData(a,l).next(()=>o.Ur.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Ur.addMatchingKeys(a,t,s.targetId)).next(()=>o.Gr.saveNamedQuery(a,e))})})}function yF(n,e){return`firestore_clients_${n}_${e}`}function _F(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function SD(n,e){return`firestore_targets_${n}_${e}`}var Bm=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Rs(e,t,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new k(i.error.code,i.error.message))),o?new n(e,t,i.state,s):(ut("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Sd=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){let r=JSON.parse(t),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new k(r.error.code,r.error.message))),s?new n(e,r.state,i):(ut("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},$m=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=Lb();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=VF(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new n(e,s):(ut("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},HT=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(ut("SharedClientState",`Failed to parse online state: ${e}`),null)}},Gd=class{constructor(){this.activeTargetIds=Lb()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Rd=class{constructor(e,t,r,i,s){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new ze(ae),this.started=!1,this.bs=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=yF(this.persistenceKey,this.ps),this.vs=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new Gd),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.Os=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}start(){return x(this,null,function*(){let e=yield this.syncEngine.Qi();for(let r of e){if(r===this.ps)continue;let i=this.getItem(yF(this.persistenceKey,r));if(i){let s=$m.Rs(r,i);s&&(this.Ss=this.Ss.insert(s.clientId,s))}}this.Ns();let t=this.storage.getItem(this.xs);if(t){let r=this.Ls(t);r&&this.Bs(r)}for(let r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){let i=this.storage.getItem(SD(this.persistenceKey,e));if(i){let s=Sd.Rs(e,i);s&&(r=s.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(SD(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return O("SharedClientState","READ",e,t),t}setItem(e,t){O("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){O("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){let t=e;if(t.storageArea===this.storage){if(O("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void ut("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(()=>x(this,null,function*(){if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){let r=this.Gs(t.key);return this.zs(r,null)}{let r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){let r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){let r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){let r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){let r=function(s){let o=Pn.oe;if(s!=null)try{let a=JSON.parse(s);W(typeof a=="number"),o=a}catch(a){ut("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==Pn.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){let r=this.Xs(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){let i=new Bm(this.currentUser,e,t,r),s=_F(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Vs())}Qs(e){let t=_F(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){let t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){let i=SD(this.persistenceKey,e),s=new Sd(e,t,r);this.setItem(i,s.Vs())}Ws(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){let t=this.Cs.exec(e);return t?t[1]:null}js(e,t){let r=this.Gs(e);return $m.Rs(r,t)}Hs(e,t){let r=this.Fs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Bm.Rs(new mt(s),i,t)}Ys(e,t){let r=this.Ms.exec(e),i=Number(r[1]);return Sd.Rs(i,t)}Ls(e){return HT.Rs(e)}Xs(e){return JSON.parse(e)}Js(e){return x(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);O("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){let r=t?this.Ss.insert(e,t):this.Ss.remove(e),i=this.ks(this.Ss),s=this.ks(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=Lb();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},qm=class{constructor(){this.so=new Gd,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Gd,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var GT=class{_o(e){}shutdown(){}};var Hm=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){O("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){O("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var am=null;function RD(){return am===null?am=function(){return 268435456+Math.round(2147483648*Math.random())}():am++,"0x"+am.toString(16)}var F8={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var zT=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Wt="WebChannelConnection",WT=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,o){let a=RD(),u=this.xo(t,r.toUriEncodedString());O("RestConnection",`Sending RPC '${t}' ${a}:`,u,i);let l={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(l,s,o),this.No(t,u,l,i).then(d=>(O("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw lr("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",u,"request:",i),d})}Lo(t,r,i,s,o,a){return this.Mo(t,r,i,s,o)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ju}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}xo(t,r){let i=F8[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let s=RD();return new Promise((o,a)=>{let u=new ED;u.setWithCredentials(!0),u.listenOnce(ID.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case _d.NO_ERROR:let d=u.getResponseJson();O(Wt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case _d.TIMEOUT:O(Wt,`RPC '${e}' ${s} timed out`),a(new k(N.DEADLINE_EXCEEDED,"Request time out"));break;case _d.HTTP_ERROR:let h=u.getStatus();if(O(Wt,`RPC '${e}' ${s} failed with status:`,h,"response text:",u.getResponseText()),h>0){let g=u.getResponseJson();Array.isArray(g)&&(g=g[0]);let y=g?.error;if(y&&y.status&&y.message){let v=function(A){let P=A.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(P)>=0?P:N.UNKNOWN}(y.status);a(new k(v,y.message))}else a(new k(N.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new k(N.UNAVAILABLE,"Connection failed."));break;default:z()}}finally{O(Wt,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);O(Wt,`RPC '${e}' ${s} sending request:`,i),u.send(t,"POST",l,r,15)})}Bo(e,t,r){let i=RD(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=TD(),a=DD(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;let d=s.join("");O(Wt,`Creating RPC '${e}' stream ${i}: ${d}`,u);let h=o.createWebChannel(d,u),g=!1,y=!1,v=new zT({Io:A=>{y?O(Wt,`Not sending because RPC '${e}' stream ${i} is closed:`,A):(g||(O(Wt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),g=!0),O(Wt,`RPC '${e}' stream ${i} sending:`,A),h.send(A))},To:()=>h.close()}),D=(A,P,B)=>{A.listen(P,F=>{try{B(F)}catch(K){setTimeout(()=>{throw K},0)}})};return D(h,uu.EventType.OPEN,()=>{y||(O(Wt,`RPC '${e}' stream ${i} transport opened.`),v.yo())}),D(h,uu.EventType.CLOSE,()=>{y||(y=!0,O(Wt,`RPC '${e}' stream ${i} transport closed`),v.So())}),D(h,uu.EventType.ERROR,A=>{y||(y=!0,lr(Wt,`RPC '${e}' stream ${i} transport errored:`,A),v.So(new k(N.UNAVAILABLE,"The operation could not be completed")))}),D(h,uu.EventType.MESSAGE,A=>{var P;if(!y){let B=A.data[0];W(!!B);let F=B,K=F.error||((P=F[0])===null||P===void 0?void 0:P.error);if(K){O(Wt,`RPC '${e}' stream ${i} received error:`,K);let te=K.status,X=function(E){let C=pt[E];if(C!==void 0)return pV(C)}(te),I=K.message;X===void 0&&(X=N.INTERNAL,I="Unknown error status: "+te+" with message "+K.message),y=!0,v.So(new k(X,I)),h.close()}else O(Wt,`RPC '${e}' stream ${i} received:`,B),v.bo(B)}}),D(a,CD.STAT_EVENT,A=>{A.stat===rm.PROXY?O(Wt,`RPC '${e}' stream ${i} detected buffering proxy`):A.stat===rm.NOPROXY&&O(Wt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.wo()},0),v}};function $V(){return typeof window<"u"?window:null}function hm(){return typeof document<"u"?document:null}function th(n){return new uT(n,!0)}var zd=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&O("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var Gm=class{constructor(e,t,r,i,s,o,a,u){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new zd(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return x(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return x(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return x(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===N.RESOURCE_EXHAUSTED?(ut(t.toString()),ut("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new k(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>x(this,null,function*(){this.state=0,this.start()}))}I_(e){return O("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(O("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},KT=class extends Gm{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=w8(this.serializer,e),r=function(s){if(!("targetChange"in s))return J.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?J.min():o.readTime?lt(o.readTime):J.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=dT(this.serializer),t.addTarget=function(s,o){let a,u=o.target;if(a=Im(u)?{documents:IV(s,u)}:{query:CV(s,u)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=mV(s,o.resumeToken);let l=cT(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(J.min())>0){a.readTime=Su(s,o.snapshotVersion.toTimestamp());let l=cT(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=I8(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=dT(this.serializer),t.removeTarget=e,this.a_(t)}},QT=class extends Gm{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return W(!!e.streamToken),this.lastStreamToken=e.streamToken,W(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){W(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=E8(e.writeResults,e.commitTime),r=lt(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=dT(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>$d(this.serializer,r))};this.a_(t)}};var YT=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new k(N.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,lT(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new k(N.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,lT(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new k(N.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},ZT=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ut(t),this.D_=!1):O("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var JT=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(()=>x(this,null,function*(){Cs(this)&&(O("RemoteStore","Restarting streams for network reachability change."),yield function(u){return x(this,null,function*(){let l=$(u);l.L_.add(4),yield Bu(l),l.q_.set("Unknown"),l.L_.delete(4),yield nh(l)})}(this))}))}),this.q_=new ZT(r,i)}};function nh(n){return x(this,null,function*(){if(Cs(n))for(let e of n.B_)yield e(!0)})}function Bu(n){return x(this,null,function*(){for(let e of n.B_)yield e(!1)})}function hy(n,e){let t=$(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),zb(t)?Gb(t):qu(t).r_()&&Hb(t,e))}function Pu(n,e){let t=$(n),r=qu(t);t.N_.delete(e),r.r_()&&qV(t,e),t.N_.size===0&&(r.r_()?r.o_():Cs(t)&&t.q_.set("Unknown"))}function Hb(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(J.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}qu(n).A_(e)}function qV(n,e){n.Q_.xe(e),qu(n).R_(e)}function Gb(n){n.Q_=new aT({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),qu(n).start(),n.q_.v_()}function zb(n){return Cs(n)&&!qu(n).n_()&&n.N_.size>0}function Cs(n){return $(n).L_.size===0}function HV(n){n.Q_=void 0}function V8(n){return x(this,null,function*(){n.q_.set("Online")})}function L8(n){return x(this,null,function*(){n.N_.forEach((e,t)=>{Hb(n,e)})})}function j8(n,e){return x(this,null,function*(){HV(n),zb(n)?(n.q_.M_(e),Gb(n)):n.q_.set("Unknown")})}function U8(n,e,t){return x(this,null,function*(){if(n.q_.set("Online"),e instanceof bm&&e.state===2&&e.cause)try{yield function(i,s){return x(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.N_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.N_.delete(a),i.Q_.removeTarget(a))})}(n,e)}catch(r){O("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield zm(n,r)}else if(e instanceof Eu?n.Q_.Ke(e):e instanceof Tm?n.Q_.He(e):n.Q_.We(e),!t.isEqual(J.min()))try{let r=yield VV(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let a=s.Q_.rt(o);return a.targetChanges.forEach((u,l)=>{if(u.resumeToken.approximateByteSize()>0){let d=s.N_.get(l);d&&s.N_.set(l,d.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,l)=>{let d=s.N_.get(u);if(!d)return;s.N_.set(u,d.withResumeToken(dt.EMPTY_BYTE_STRING,d.snapshotVersion)),qV(s,u);let h=new Ru(d.target,u,l,d.sequenceNumber);Hb(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){O("RemoteStore","Failed to raise snapshot:",r),yield zm(n,r)}})}function zm(n,e,t){return x(this,null,function*(){if(!Is(e))throw e;n.L_.add(1),yield Bu(n),n.q_.set("Offline"),t||(t=()=>VV(n.localStore)),n.asyncQueue.enqueueRetryable(()=>x(this,null,function*(){O("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield nh(n)}))})}function GV(n,e){return e().catch(t=>zm(n,t,e))}function $u(n){return x(this,null,function*(){let e=$(n),t=ws(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;B8(e);)try{let i=yield P8(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,$8(e,i)}catch(i){yield zm(e,i)}zV(e)&&WV(e)})}function B8(n){return Cs(n)&&n.O_.length<10}function $8(n,e){n.O_.push(e);let t=ws(n);t.r_()&&t.V_&&t.m_(e.mutations)}function zV(n){return Cs(n)&&!ws(n).n_()&&n.O_.length>0}function WV(n){ws(n).start()}function q8(n){return x(this,null,function*(){ws(n).p_()})}function H8(n){return x(this,null,function*(){let e=ws(n);for(let t of n.O_)e.m_(t.mutations)})}function G8(n,e,t){return x(this,null,function*(){let r=n.O_.shift(),i=iT.from(r,e,t);yield GV(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield $u(n)})}function z8(n,e){return x(this,null,function*(){e&&ws(n).V_&&(yield function(r,i){return x(this,null,function*(){if(function(o){return fV(o)&&o!==N.ABORTED}(i.code)){let s=r.O_.shift();ws(r).s_(),yield GV(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield $u(r)}})}(n,e)),zV(n)&&WV(n)})}function vF(n,e){return x(this,null,function*(){let t=$(n);t.asyncQueue.verifyOperationInProgress(),O("RemoteStore","RemoteStore received new credentials");let r=Cs(t);t.L_.add(3),yield Bu(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield nh(t)})}function XT(n,e){return x(this,null,function*(){let t=$(n);e?(t.L_.delete(2),yield nh(t)):e||(t.L_.add(2),yield Bu(t),t.q_.set("Unknown"))})}function qu(n){return n.K_||(n.K_=function(t,r,i){let s=$(t);return s.w_(),new KT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:V8.bind(null,n),Ro:L8.bind(null,n),mo:j8.bind(null,n),d_:U8.bind(null,n)}),n.B_.push(e=>x(this,null,function*(){e?(n.K_.s_(),zb(n)?Gb(n):n.q_.set("Unknown")):(yield n.K_.stop(),HV(n))}))),n.K_}function ws(n){return n.U_||(n.U_=function(t,r,i){let s=$(t);return s.w_(),new QT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:q8.bind(null,n),mo:z8.bind(null,n),f_:H8.bind(null,n),g_:G8.bind(null,n)}),n.B_.push(e=>x(this,null,function*(){e?(n.U_.s_(),yield $u(n)):(yield n.U_.stop(),n.O_.length>0&&(O("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var eb=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new wt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new k(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Hu(n,e){if(ut("AsyncQueue",`${e}: ${n}`),Is(n))return new k(N.UNAVAILABLE,`${e}: ${n}`);throw n}var Wm=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||q.comparator(t.key,r.key):(t,r)=>q.comparator(t.key,r.key),this.keyedMap=Cd(),this.sortedSet=new ze(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Km=class{constructor(){this.W_=new ze(q.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):z():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},ku=class n{constructor(e,t,r,i,s,o,a,u,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,Wm.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var tb=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},nb=class{constructor(){this.queries=wF(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=$(t),s=i.queries;i.queries=wF(),s.forEach((o,a)=>{for(let u of a.j_)u.onError(r)})})(this,new k(N.ABORTED,"Firestore shutting down"))}};function wF(){return new Br(n=>XF(n),Xd)}function Wb(n,e){return x(this,null,function*(){let t=$(n),r=3,i=e.query,s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new tb,r=e.J_()?0:1);try{switch(r){case 0:s.z_=yield t.onListen(i,!0);break;case 1:s.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let a=Hu(o,`Initialization of query '${pu(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&Qb(t)})}function Kb(n,e){return x(this,null,function*(){let t=$(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function W8(n,e){let t=$(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.j_)a.X_(i)&&(r=!0);o.z_=i}}r&&Qb(t)}function K8(n,e,t){let r=$(n),i=r.queries.get(e);if(i)for(let s of i.j_)s.onError(t);r.queries.delete(e)}function Qb(n){n.Y_.forEach(e=>{e.next()})}var rb,EF;(EF=rb||(rb={})).ea="default",EF.Cache="cache";var Wd=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new ku(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=ku.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==rb.Cache}};var ib=class{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}};var Qm=class{constructor(e){this.serializer=e}Es(e){return Vr(this.serializer,e)}ds(e){return e.metadata.exists?EV(this.serializer,e.document,!1):yt.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return lt(e)}},sb=class{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=KV(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;let r=Ae.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){let t=new Map,r=new Qm(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Es(i.metadata.name);for(let o of i.metadata.queries){let a=(t.get(o)||de()).add(s);t.set(o,a)}}return t}complete(){return x(this,null,function*(){let e=yield k8(this.localStore,new Qm(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(let r of this.queries)yield O8(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}})}};function KV(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var Ym=class{constructor(e){this.key=e}},Zm=class{constructor(e){this.key=e}},Jm=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=de(),this.mutatedKeys=de(),this.Aa=tV(e),this.Ra=new Wm(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new Km,i=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{let g=i.get(d),y=eh(this.query,h)?h:null,v=!!g&&this.mutatedKeys.has(g.key),D=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations),A=!1;g&&y?g.data.isEqual(y.data)?v!==D&&(r.track({type:3,doc:y}),A=!0):this.ga(g,y)||(r.track({type:2,doc:y}),A=!0,(u&&this.Aa(y,u)>0||l&&this.Aa(y,l)<0)&&(a=!0)):!g&&y?(r.track({type:0,doc:y}),A=!0):g&&!y&&(r.track({type:1,doc:g}),A=!0,(u||l)&&(a=!0)),A&&(y?(o=o.add(y),s=D?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let o=e.fa.G_();o.sort((d,h)=>function(y,v){let D=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return z()}};return D(y)-D(v)}(d.type,h.type)||this.Aa(d.doc,h.doc)),this.pa(r),i=i!=null&&i;let a=t&&!i?this.ya():[],u=this.da.size===0&&this.current&&!i?1:0,l=u!==this.Ea;return this.Ea=u,o.length!==0||l?{snapshot:new ku(this.query,e.Ra,s,o,e.mutatedKeys,u===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Km,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=de(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new Zm(r))}),this.da.forEach(r=>{e.has(r)||t.push(new Ym(r))}),t}ba(e){this.Ta=e.Ts,this.da=de();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return ku.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},ob=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},ab=class{constructor(e){this.key=e,this.va=!1}},ub=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Br(a=>XF(a),Xd),this.Ma=new Map,this.xa=new Set,this.Oa=new ze(q.comparator),this.Na=new Map,this.La=new Hd,this.Ba={},this.ka=new Map,this.qa=xu.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function Q8(n,e,t=!0){return x(this,null,function*(){let r=fy(n),i,s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=yield QV(r,e,t,!0),i})}function Y8(n,e){return x(this,null,function*(){let t=fy(n);yield QV(t,e,!0,!1)})}function QV(n,e,t,r){return x(this,null,function*(){let i=yield Mu(n.localStore,un(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),a;return r&&(a=yield Yb(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&hy(n.remoteStore,i),a})}function Yb(n,e,t,r,i){return x(this,null,function*(){n.Ka=(h,g,y)=>function(D,A,P,B){return x(this,null,function*(){let F=A.view.ma(P);F.ns&&(F=yield Um(D.localStore,A.query,!1).then(({documents:I})=>A.view.ma(I,F)));let K=B&&B.targetChanges.get(A.targetId),te=B&&B.targetMismatches.get(A.targetId)!=null,X=A.view.applyChanges(F,D.isPrimaryClient,K,te);return cb(D,A.targetId,X.wa),X.snapshot})}(n,h,g,y);let s=yield Um(n.localStore,e,!0),o=new Jm(e,s.Ts),a=o.ma(s.documents),u=Ud.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=o.applyChanges(a,n.isPrimaryClient,u);cb(n,t,l.wa);let d=new ob(e,t,o);return n.Fa.set(e,d),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),l.snapshot})}function Z8(n,e,t){return x(this,null,function*(){let r=$(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!Xd(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Nu(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Pu(r.remoteStore,i.targetId),Ou(r,i.targetId)}).catch(Es))):(Ou(r,i.targetId),yield Nu(r.localStore,i.targetId,!0))})}function J8(n,e){return x(this,null,function*(){let t=$(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Pu(t.remoteStore,r.targetId))})}function X8(n,e,t){return x(this,null,function*(){let r=e0(n);try{let i=yield function(o,a){let u=$(o),l=Ze.now(),d=a.reduce((y,v)=>y.add(v.key),de()),h,g;return u.persistence.runTransaction("Locally write mutations","readwrite",y=>{let v=gn(),D=de();return u.cs.getEntries(y,d).next(A=>{v=A,v.forEach((P,B)=>{B.isValidDocument()||(D=D.add(P))})}).next(()=>u.localDocuments.getOverlayedDocuments(y,v)).next(A=>{h=A;let P=[];for(let B of a){let F=f8(B,h.get(B.key).overlayedDocument);F!=null&&P.push(new hr(B.key,F,zF(F.value.mapValue),rt.exists(!0)))}return u.mutationQueue.addMutationBatch(y,l,P,a)}).next(A=>{g=A;let P=A.applyToLocalDocumentSet(h,D);return u.documentOverlayCache.saveOverlays(y,A.batchId,P)})}).then(()=>({batchId:g.batchId,changes:rV(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let l=o.Ba[o.currentUser.toKey()];l||(l=new ze(ae)),l=l.insert(a,u),o.Ba[o.currentUser.toKey()]=l}(r,i.batchId,t),yield _i(r,i.changes),yield $u(r.remoteStore)}catch(i){let s=Hu(i,"Failed to persist write");t.reject(s)}})}function YV(n,e){return x(this,null,function*(){let t=$(n);try{let r=yield N8(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Na.get(s);o&&(W(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?W(o.va):i.removedDocuments.size>0&&(W(o.va),o.va=!1))}),yield _i(t,r,e)}catch(r){yield Es(r)}})}function IF(n,e,t){let r=$(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((s,o)=>{let a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let u=$(o);u.onlineState=a;let l=!1;u.queries.forEach((d,h)=>{for(let g of h.j_)g.Z_(a)&&(l=!0)}),l&&Qb(u)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function eK(n,e,t){return x(this,null,function*(){let r=$(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),s=i&&i.key;if(s){let o=new ze(q.comparator);o=o.insert(s,yt.newNoDocument(s,J.min()));let a=de().add(s),u=new jd(J.min(),new Map,new ze(ae),o,a);yield YV(r,u),r.Oa=r.Oa.remove(s),r.Na.delete(e),Xb(r)}else yield Nu(r.localStore,e,!1).then(()=>Ou(r,e,t)).catch(Es)})}function tK(n,e){return x(this,null,function*(){let t=$(n),r=e.batch.batchId;try{let i=yield M8(t.localStore,e);Jb(t,r,null),Zb(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield _i(t,i)}catch(i){yield Es(i)}})}function nK(n,e,t){return x(this,null,function*(){let r=$(n);try{let i=yield function(o,a){let u=$(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return u.mutationQueue.lookupMutationBatch(l,a).next(h=>(W(h!==null),d=h.keys(),u.mutationQueue.removeMutationBatch(l,h))).next(()=>u.mutationQueue.performConsistencyCheck(l)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(l,d,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>u.localDocuments.getDocuments(l,d))})}(r.localStore,e);Jb(r,e,t),Zb(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield _i(r,i)}catch(i){yield Es(i)}})}function rK(n,e){return x(this,null,function*(){let t=$(n);Cs(t.remoteStore)||O("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=$(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(t.localStore);if(r===-1)return void e.resolve();let i=t.ka.get(r)||[];i.push(e),t.ka.set(r,i)}catch(r){let i=Hu(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function Zb(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Jb(n,e,t){let r=$(n),i=r.Ba[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Ou(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||ZV(n,r)})}function ZV(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(Pu(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Xb(n))}function cb(n,e,t){for(let r of t)r instanceof Ym?(n.La.addReference(r.key,e),iK(n,r)):r instanceof Zm?(O("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||ZV(n,r.key)):z()}function iK(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(O("SyncEngine","New document in limbo: "+t),n.xa.add(r),Xb(n))}function Xb(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new q(Ae.fromString(e)),r=n.qa.next();n.Na.set(r,new ab(t)),n.Oa=n.Oa.insert(t,r),hy(n.remoteStore,new Ru(un(Uu(t.path)),r,"TargetPurposeLimboResolution",Pn.oe))}}function _i(n,e,t){return x(this,null,function*(){let r=$(n),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,u)=>{o.push(r.Ka(u,e,t).then(l=>{var d;if((l||t)&&r.isPrimaryClient){let h=l?!l.fromCache:(d=t?.targetChanges.get(u.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(u.targetId,h?"current":"not-current")}if(l){i.push(l);let h=BT.Wi(u.targetId,l);s.push(h)}}))}),yield Promise.all(o),r.Ca.d_(i),yield function(u,l){return x(this,null,function*(){let d=$(u);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>R.forEach(l,g=>R.forEach(g.$i,y=>d.persistence.referenceDelegate.addReference(h,g.targetId,y)).next(()=>R.forEach(g.Ui,y=>d.persistence.referenceDelegate.removeReference(h,g.targetId,y)))))}catch(h){if(!Is(h))throw h;O("LocalStore","Failed to update sequence numbers: "+h)}for(let h of l){let g=h.targetId;if(!h.fromCache){let y=d.os.get(g),v=y.snapshotVersion,D=y.withLastLimboFreeSnapshotVersion(v);d.os=d.os.insert(g,D)}}})}(r.localStore,s))})}function sK(n,e){return x(this,null,function*(){let t=$(n);if(!t.currentUser.isEqual(e)){O("SyncEngine","User change. New user:",e.toKey());let r=yield FV(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(a=>{a.forEach(u=>{u.reject(new k(N.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield _i(t,r.hs)}})}function oK(n,e){let t=$(n),r=t.Na.get(e);if(r&&r.va)return de().add(r.key);{let i=de(),s=t.Ma.get(e);if(!s)return i;for(let o of s){let a=t.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}function aK(n,e){return x(this,null,function*(){let t=$(n),r=yield Um(t.localStore,e.query,!0),i=e.view.ba(r);return t.isPrimaryClient&&cb(t,e.targetId,i.wa),i})}function uK(n,e){return x(this,null,function*(){let t=$(n);return UV(t.localStore,e).then(r=>_i(t,r))})}function cK(n,e,t,r){return x(this,null,function*(){let i=$(n),s=yield function(a,u){let l=$(a),d=$(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",h=>d.Mn(h,u).next(g=>g?l.localDocuments.getDocuments(h,g):R.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?yield $u(i.remoteStore):t==="acknowledged"||t==="rejected"?(Jb(i,e,r||null),Zb(i,e),function(a,u){$($(a).mutationQueue).On(u)}(i.localStore,e)):z(),yield _i(i,s)):O("SyncEngine","Cannot apply mutation batch with id: "+e)})}function lK(n,e){return x(this,null,function*(){let t=$(n);if(fy(t),e0(t),e===!0&&t.Qa!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield CF(t,r.toArray());t.Qa=!0,yield XT(t.remoteStore,!0);for(let s of i)hy(t.remoteStore,s)}else if(e===!1&&t.Qa!==!1){let r=[],i=Promise.resolve();t.Ma.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Ou(t,o),Nu(t.localStore,o,!0))),Pu(t.remoteStore,o)}),yield i,yield CF(t,r),function(o){let a=$(o);a.Na.forEach((u,l)=>{Pu(a.remoteStore,l)}),a.La.pr(),a.Na=new Map,a.Oa=new ze(q.comparator)}(t),t.Qa=!1,yield XT(t.remoteStore,!1)}})}function CF(n,e,t){return x(this,null,function*(){let r=$(n),i=[],s=[];for(let o of e){let a,u=r.Ma.get(o);if(u&&u.length!==0){a=yield Mu(r.localStore,un(u[0]));for(let l of u){let d=r.Fa.get(l),h=yield aK(r,d);h.snapshot&&s.push(h.snapshot)}}else{let l=yield jV(r.localStore,o);a=yield Mu(r.localStore,l),yield Yb(r,JV(l),o,!1,a.resumeToken)}i.push(a)}return r.Ca.d_(s),i})}function JV(n){return JF(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function dK(n){return function(t){return $($(t).persistence).Qi()}($(n).localStore)}function hK(n,e,t,r){return x(this,null,function*(){let i=$(n);if(i.Qa)return void O("SyncEngine","Ignoring unexpected query state notification.");let s=i.Ma.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield UV(i.localStore,eV(s[0])),a=jd.createSynthesizedRemoteEventForCurrentChange(e,t==="current",dt.EMPTY_BYTE_STRING);yield _i(i,o,a);break}case"rejected":yield Nu(i.localStore,e,!0),Ou(i,e,r);break;default:z()}})}function fK(n,e,t){return x(this,null,function*(){let r=fy(n);if(r.Qa){for(let i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){O("SyncEngine","Adding an already active target "+i);continue}let s=yield jV(r.localStore,i),o=yield Mu(r.localStore,s);yield Yb(r,JV(s),o.targetId,!1,o.resumeToken),hy(r.remoteStore,o)}for(let i of t)r.Ma.has(i)&&(yield Nu(r.localStore,i,!1).then(()=>{Pu(r.remoteStore,i),Ou(r,i)}).catch(Es))}})}function fy(n){let e=$(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=YV.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=oK.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=eK.bind(null,e),e.Ca.d_=W8.bind(null,e.eventManager),e.Ca.$a=K8.bind(null,e.eventManager),e}function e0(n){let e=$(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=tK.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=nK.bind(null,e),e}function pK(n,e,t){let r=$(n);(function(s,o,a){return x(this,null,function*(){try{let u=yield o.getMetadata();if(yield function(y,v){let D=$(y),A=lt(v.createTime);return D.persistence.runTransaction("hasNewerBundle","readonly",P=>D.Gr.getBundleMetadata(P,v.id)).then(P=>!!P&&P.createTime.compareTo(A)>=0)}(s.localStore,u))return yield o.close(),a._completeWith(function(y){return{taskState:"Success",documentsLoaded:y.totalDocuments,bytesLoaded:y.totalBytes,totalDocuments:y.totalDocuments,totalBytes:y.totalBytes}}(u)),Promise.resolve(new Set);a._updateProgress(KV(u));let l=new sb(u,s.localStore,o.serializer),d=yield o.Ua();for(;d;){let g=yield l.la(d);g&&a._updateProgress(g),d=yield o.Ua()}let h=yield l.complete();return yield _i(s,h.Ia,void 0),yield function(y,v){let D=$(y);return D.persistence.runTransaction("Save bundle","readwrite",A=>D.Gr.saveBundleMetadata(A,v))}(s.localStore,u),a._completeWith(h.progress),Promise.resolve(h.Pa)}catch(u){return lr("SyncEngine",`Loading bundle failed with ${u}`),a._failWith(u),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var lb=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return x(this,null,function*(){this.serializer=th(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,r){return null}Ha(t,r){return null}za(t){return OV(this.persistence,new jm,t.initialUser,this.serializer)}Ga(t){return new Vm(Lm.Zr,this.serializer)}Wa(t){return new qm}terminate(){return x(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var Xm=class n extends lb{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){return x(this,null,function*(){yield s_(n.prototype,this,"initialize").call(this,e),yield this.Ja.initialize(this,e),yield e0(this.Ja.syncEngine),yield $u(this.Ja.remoteStore),yield this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}za(e){return OV(this.persistence,new jm,e.initialUser,this.serializer)}ja(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new TT(r,e.asyncQueue,t)}Ha(e,t){let r=new $D(t,this.persistence);return new BD(e.asyncQueue,r)}Ga(e){let t=qb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Kn.withCacheSize(this.cacheSizeBytes):Kn.DEFAULT;return new UT(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,$V(),hm(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new qm}},db=class n extends Xm{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return x(this,null,function*(){yield s_(n.prototype,this,"initialize").call(this,e);let t=this.Ja.syncEngine;this.sharedClientState instanceof Rd&&(this.sharedClientState.syncEngine={no:cK.bind(null,t),ro:hK.bind(null,t),io:fK.bind(null,t),Qi:dK.bind(null,t),eo:uK.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.yi(r=>x(this,null,function*(){yield lK(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}Wa(e){let t=$V();if(!Rd.D(t))throw new k(N.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=qb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Rd(t,e.asyncQueue,r,e.clientId,e.initialUser)}},t0=(()=>{class n{initialize(t,r){return x(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>IF(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=sK.bind(null,this.syncEngine),yield XT(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new nb}()}createDatastore(t){let r=th(t.databaseInfo.databaseId),i=function(o){return new WT(o)}(t.databaseInfo);return function(o,a,u,l){return new YT(o,a,u,l)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,s,o,a,u){return new JT(i,s,o,a,u)}(this.localStore,this.datastore,t.asyncQueue,r=>IF(this.syncEngine,r,0),function(){return Hm.D()?new Hm:new GT}())}createSyncEngine(t,r){return function(s,o,a,u,l,d,h){let g=new ub(s,o,a,u,l,d);return h&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return x(this,null,function*(){var t,r;yield function(s){return x(this,null,function*(){let o=$(s);O("RemoteStore","RemoteStore shutting down."),o.L_.add(5),yield Bu(o),o.k_.shutdown(),o.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();function DF(n,e=10240){let t=0;return{read(){return x(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return x(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Fu=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ut("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var hb=class{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new wt,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}getMetadata(){return x(this,null,function*(){return this.metadata.promise})}Ua(){return x(this,null,function*(){return yield this.getMetadata(),this.tu()})}tu(){return x(this,null,function*(){let e=yield this.nu();if(e===null)return null;let t=this.eu.decode(e),r=Number(t);isNaN(r)&&this.ru(`length string (${t}) is not valid number`);let i=yield this.iu(r);return new ib(JSON.parse(i),e.length+r)})}su(){return this.buffer.findIndex(e=>e===123)}nu(){return x(this,null,function*(){for(;this.su()<0&&!(yield this.ou()););if(this.buffer.length===0)return null;let e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}iu(e){return x(this,null,function*(){for(;this.buffer.length<e;)(yield this.ou())&&this.ru("Reached the end of bundle when more is expected.");let t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}ou(){return x(this,null,function*(){let e=yield this.Xa.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var fb=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return x(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new k(N.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,s){return x(this,null,function*(){let o=$(i),a={documents:s.map(h=>Bd(o.serializer,h))},u=yield o.Lo("BatchGetDocuments",o.serializer.databaseId,Ae.emptyPath(),a,s.length),l=new Map;u.forEach(h=>{let g=v8(o.serializer,h);l.set(g.key.toString(),g)});let d=[];return s.forEach(h=>{let g=l.get(h.toString());W(!!g),d.push(g)}),d})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new vs(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return x(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=q.fromPath(r);this.mutations.push(new Fd(i,this.precondition(i)))}),yield function(r,i){return x(this,null,function*(){let s=$(r),o={writes:i.map(a=>$d(s.serializer,a))};yield s.Mo("Commit",s.serializer.databaseId,Ae.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw z();t=J.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new k(N.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(J.min())?rt.exists(!1):rt.updateTime(t):rt.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(J.min()))throw new k(N.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return rt.updateTime(t)}return rt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var pb=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this._u=r.maxAttempts,this.t_=new zd(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(()=>x(this,null,function*(){let e=new fb(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.lu(i)}))}).catch(r=>{this.lu(r)})}))}cu(e){try{let t=this.updateFunction(e);return!Zd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!fV(t)}return!1}};var gb=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=mt.UNAUTHENTICATED,this.clientId=pm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,o=>x(this,null,function*(){O("FirestoreClient","Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,o=>(O("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new wt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>x(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Hu(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function xD(n,e){return x(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),O("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>x(this,null,function*(){r.isEqual(i)||(yield FV(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function TF(n,e){return x(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield n0(n);O("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>vF(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>vF(e.remoteStore,i)),n._onlineComponents=e})}function n0(n){return x(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){O("FirestoreClient","Using user provided OfflineComponentProvider");try{yield xD(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===N.FAILED_PRECONDITION||i.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;lr("Error using user provided cache. Falling back to memory cache: "+t),yield xD(n,new lb)}}else O("FirestoreClient","Using default OfflineComponentProvider"),yield xD(n,new lb);return n._offlineComponents})}function py(n){return x(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(O("FirestoreClient","Using user provided OnlineComponentProvider"),yield TF(n,n._uninitializedComponentsProvider._online)):(O("FirestoreClient","Using default OnlineComponentProvider"),yield TF(n,new t0))),n._onlineComponents})}function XV(n){return n0(n).then(e=>e.persistence)}function r0(n){return n0(n).then(e=>e.localStore)}function eL(n){return py(n).then(e=>e.remoteStore)}function i0(n){return py(n).then(e=>e.syncEngine)}function gK(n){return py(n).then(e=>e.datastore)}function Vu(n){return x(this,null,function*(){let e=yield py(n),t=e.eventManager;return t.onListen=Q8.bind(null,e.syncEngine),t.onUnlisten=Z8.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Y8.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=J8.bind(null,e.syncEngine),t})}function mK(n){return n.asyncQueue.enqueue(()=>x(this,null,function*(){let e=yield XV(n),t=yield eL(n);return e.setNetworkEnabled(!0),function(i){let s=$(i);return s.L_.delete(0),nh(s)}(t)}))}function yK(n){return n.asyncQueue.enqueue(()=>x(this,null,function*(){let e=yield XV(n),t=yield eL(n);return e.setNetworkEnabled(!1),function(i){return x(this,null,function*(){let s=$(i);s.L_.add(0),yield Bu(s),s.q_.set("Offline")})}(t)}))}function _K(n,e){let t=new wt;return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(i,s,o){return x(this,null,function*(){try{let a=yield function(l,d){let h=$(l);return h.persistence.runTransaction("read document","readonly",g=>h.localDocuments.getDocument(g,d))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new k(N.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let u=Hu(a,`Failed to get document '${s} from cache`);o.reject(u)}})}(yield r0(n),e,t)})),t.promise}function tL(n,e,t={}){let r=new wt;return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(s,o,a,u,l){let d=new Fu({next:g=>{d.Za(),o.enqueueAndForget(()=>Kb(s,h));let y=g.docs.has(a);!y&&g.fromCache?l.reject(new k(N.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&g.fromCache&&u&&u.source==="server"?l.reject(new k(N.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(g)},error:g=>l.reject(g)}),h=new Wd(Uu(a.path),d,{includeMetadataChanges:!0,_a:!0});return Wb(s,h)}(yield Vu(n),n.asyncQueue,e,t,r)})),r.promise}function vK(n,e){let t=new wt;return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(i,s,o){return x(this,null,function*(){try{let a=yield Um(i,s,!0),u=new Jm(s,a.Ts),l=u.ma(a.documents),d=u.applyChanges(l,!1);o.resolve(d.snapshot)}catch(a){let u=Hu(a,`Failed to execute query '${s} against cache`);o.reject(u)}})}(yield r0(n),e,t)})),t.promise}function nL(n,e,t={}){let r=new wt;return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(s,o,a,u,l){let d=new Fu({next:g=>{d.Za(),o.enqueueAndForget(()=>Kb(s,h)),g.fromCache&&u.source==="server"?l.reject(new k(N.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(g)},error:g=>l.reject(g)}),h=new Wd(a,d,{includeMetadataChanges:!0,_a:!0});return Wb(s,h)}(yield Vu(n),n.asyncQueue,e,t,r)})),r.promise}function wK(n,e){let t=new Fu(e);return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(i,s){$(i).Y_.add(s),s.next()}(yield Vu(n),t)})),()=>{t.Za(),n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(i,s){$(i).Y_.delete(s)}(yield Vu(n),t)}))}}function EK(n,e,t,r){let i=function(o,a){let u;return u=typeof o=="string"?gV().encode(o):o,function(d,h){return new hb(d,h)}(function(d,h){if(d instanceof Uint8Array)return DF(d,h);if(d instanceof ArrayBuffer)return DF(new Uint8Array(d),h);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),a)}(t,th(e));n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){pK(yield i0(n),i,r)}))}function IK(n,e){return n.asyncQueue.enqueue(()=>x(this,null,function*(){return function(r,i){let s=$(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Gr.getNamedQuery(o,i))}(yield r0(n),e)}))}function rL(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var bF=new Map;function s0(n,e,t){if(!t)throw new k(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function o0(n,e,t,r){if(e===!0&&r===!0)throw new k(N.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function AF(n){if(!q.isDocumentKey(n))throw new k(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function SF(n){if(q.isDocumentKey(n))throw new k(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function gy(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":z()}function Se(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new k(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=gy(n);throw new k(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function iL(n,e){if(e<=0)throw new k(N.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var ey=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new k(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new k(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}o0("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=rL((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new k(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new k(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new k(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},So=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ey({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new k(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new k(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ey(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new MD;switch(r.type){case"firstParty":return new OD(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new k(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return x(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=bF.get(t);r&&(O("ComponentProvider","Removing Datastore"),bF.delete(t),r.terminate())}(this),Promise.resolve()}};function my(n,e,t,r={}){var i;let s=(n=Se(n,So))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&lr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if(typeof r.mockUserToken=="string")a=r.mockUserToken,u=mt.MOCK_USER;else{a=bh(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new k(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new mt(l)}n._authCredentials=new ND(new fm(a,u))}}var Pt=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},$e=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Lr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Lr=class n extends Pt{constructor(e,t,r){super(e,t,Uu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new $e(this.firestore,null,new q(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function yy(n,e,...t){if(n=_e(n),s0("collection","path",e),n instanceof So){let r=Ae.fromString(e,...t);return SF(r),new Lr(n,null,r)}{if(!(n instanceof $e||n instanceof Lr))throw new k(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Ae.fromString(e,...t));return SF(r),new Lr(n.firestore,null,r)}}function a0(n,e){if(n=Se(n,So),s0("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new k(N.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Pt(n,null,function(r){return new dr(Ae.emptyPath(),r)}(e))}function Gu(n,e,...t){if(n=_e(n),arguments.length===1&&(e=pm.newId()),s0("doc","path",e),n instanceof So){let r=Ae.fromString(e,...t);return AF(r),new $e(n,null,new q(r))}{if(!(n instanceof $e||n instanceof Lr))throw new k(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Ae.fromString(e,...t));return AF(r),new $e(n.firestore,n instanceof Lr?n.converter:null,new q(r))}}function _y(n,e){return n=_e(n),e=_e(e),(n instanceof $e||n instanceof Lr)&&(e instanceof $e||e instanceof Lr)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function vy(n,e){return n=_e(n),e=_e(e),n instanceof Pt&&e instanceof Pt&&n.firestore===e.firestore&&Xd(n._query,e._query)&&n.converter===e.converter}var ty=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new zd(this,"async_queue_retry"),this.Vu=()=>{let r=hm();r&&O("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;let t=hm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=hm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new wt;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return x(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Is(e))throw e;O("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw ut("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let i=eb.createAndSchedule(this,e,t,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&z()}verifyOperationInProgress(){}wu(){return x(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};function mb(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var yb=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new wt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var sL=-1,Je=class extends So{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new ty,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return x(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new ty(e),this._firestoreClient=void 0,yield e}})}};function oL(n,e){let t=typeof n=="object"?n:Rs(),r=typeof n=="string"?n:e||"(default)",i=_c(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=Th("firestore");s&&my(i,...s)}return i}function kt(n){if(n._terminated)throw new k(N.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||aL(n),n._firestoreClient}function aL(n){var e,t,r;let i=n._freezeSettings(),s=function(a,u,l,d){return new qD(a,u,l,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,rL(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new gb(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(a){let u=a?._online.build();return{_offline:a?._offline.build(u),_online:u}}(n._componentsProvider))}function u0(n,e){lr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings();return uL(n,t0.provider,{build:r=>new Xm(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function c0(n){return x(this,null,function*(){lr("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=n._freezeSettings();uL(n,t0.provider,{build:t=>new db(t,e.cacheSizeBytes)})})}function uL(n,e,t){if((n=Se(n,Je))._firestoreClient||n._terminated)throw new k(N.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new k(N.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},aL(n)}function l0(n){if(n._initialized&&!n._terminated)throw new k(N.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new wt;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>x(this,null,function*(){try{yield function(r){return x(this,null,function*(){if(!hs.D())return Promise.resolve();let i=r+"main";yield hs.delete(i)})}(qb(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function d0(n){return function(t){let r=new wt;return t.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return rK(yield i0(t),r)})),r.promise}(kt(n=Se(n,Je)))}function h0(n){return mK(kt(n=Se(n,Je)))}function f0(n){return yK(kt(n=Se(n,Je)))}function p0(n,e){let t=kt(n=Se(n,Je)),r=new yb;return EK(t,n._databaseId,e,r),r}function g0(n,e){return IK(kt(n=Se(n,Je)),e).then(t=>t?new Pt(n,null,t.query):null)}var $r=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(dt.fromBase64String(e))}catch(t){throw new k(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(dt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var fr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new k(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ct(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var mi=class{constructor(e){this._methodName=e}};var Ro=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new k(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new k(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ae(this._lat,e._lat)||ae(this._long,e._long)}};var Kd=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var CK=/^__.*__$/,_b=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new hr(e,this.data,this.fieldMask,t,this.fieldTransforms):new _s(e,this.data,t,this.fieldTransforms)}},ny=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new hr(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function cL(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw z()}}var ry=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return iy(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(cL(this.Cu)&&CK.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},vb=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||th(e)}Qu(e,t,r,i=!1){return new ry({Cu:e,methodName:t,qu:r,path:ct.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Po(n){let e=n._freezeSettings(),t=th(n._databaseId);return new vb(n._databaseId,!!e.ignoreUndefinedProperties,t)}function wy(n,e,t,r,i,s={}){let o=n.Qu(s.merge||s.mergeFields?2:0,e,t,i);_0("Data must be an object, but it was:",o,r);let a=hL(r,o),u,l;if(s.merge)u=new kn(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let h of s.mergeFields){let g=Db(e,h,t);if(!o.contains(g))throw new k(N.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);pL(d,g)||d.push(g)}u=new kn(d),l=o.fieldTransforms.filter(h=>u.covers(h.field))}else u=null,l=o.fieldTransforms;return new _b(new Kt(a),u,l)}var Qd=class n extends mi{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function lL(n,e,t){return new ry({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var wb=class n extends mi{_toFieldTransform(e){return new To(e.path,new ms)}isEqual(e){return e instanceof n}},Eb=class n extends mi{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){let t=lL(this,e,!0),r=this.Ku.map(s=>ko(s,t)),i=new pi(r);return new To(e.path,i)}isEqual(e){return e instanceof n&&u_(this.Ku,e.Ku)}},Ib=class n extends mi{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){let t=lL(this,e,!0),r=this.Ku.map(s=>ko(s,t)),i=new gi(r);return new To(e.path,i)}isEqual(e){return e instanceof n&&u_(this.Ku,e.Ku)}},Cb=class n extends mi{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){let t=new ys(e.serializer,oV(e.serializer,this.$u));return new To(e.path,t)}isEqual(e){return e instanceof n&&this.$u===e.$u}};function m0(n,e,t,r){let i=n.Qu(1,e,t);_0("Data must be an object, but it was:",i,r);let s=[],o=Kt.empty();No(r,(u,l)=>{let d=v0(e,u,t);l=_e(l);let h=i.Nu(d);if(l instanceof Qd)s.push(d);else{let g=ko(l,h);g!=null&&(s.push(d),o.set(d,g))}});let a=new kn(s);return new ny(o,a,i.fieldTransforms)}function y0(n,e,t,r,i,s){let o=n.Qu(1,e,t),a=[Db(e,r,t)],u=[i];if(s.length%2!=0)throw new k(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)a.push(Db(e,s[g])),u.push(s[g+1]);let l=[],d=Kt.empty();for(let g=a.length-1;g>=0;--g)if(!pL(l,a[g])){let y=a[g],v=u[g];v=_e(v);let D=o.Nu(y);if(v instanceof Qd)l.push(y);else{let A=ko(v,D);A!=null&&(l.push(y),d.set(y,A))}}let h=new kn(l);return new ny(d,h,o.fieldTransforms)}function dL(n,e,t,r=!1){return ko(t,n.Qu(r?4:3,e))}function ko(n,e){if(fL(n=_e(n)))return _0("Unsupported field value:",e,n),hL(n,e);if(n instanceof mi)return function(r,i){if(!cL(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let u=ko(a,i.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=_e(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return oV(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Ze.fromDate(r);return{timestampValue:Su(i.serializer,s)}}if(r instanceof Ze){let s=new Ze(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Su(i.serializer,s)}}if(r instanceof Ro)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof $r)return{bytesValue:mV(i.serializer,r._byteString)};if(r instanceof $e){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ub(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Kd)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Bu("VectorValues must only contain numeric values.");return jb(a.serializer,u)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${gy(r)}`)}(n,e)}function hL(n,e){let t={};return $F(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):No(n,(r,i)=>{let s=ko(i,e.Mu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function fL(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ze||n instanceof Ro||n instanceof $r||n instanceof $e||n instanceof mi||n instanceof Kd)}function _0(n,e,t){if(!fL(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=gy(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function Db(n,e,t){if((e=_e(e))instanceof fr)return e._internalPath;if(typeof e=="string")return v0(n,e);throw iy("Field path arguments must be of type string or ",n,!1,void 0,t)}var DK=new RegExp("[~\\*/\\[\\]]");function v0(n,e,t){if(e.search(DK)>=0)throw iy(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new fr(...e.split("."))._internalPath}catch{throw iy(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function iy(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new k(N.INVALID_ARGUMENT,a+n+u)}function pL(n,e){return n.some(t=>t.isEqual(e))}var xo=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new $e(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Tb(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Ey("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Tb=class extends xo{data(){return super.data()}};function Ey(n,e){return typeof e=="string"?v0(n,e):e instanceof fr?e._internalPath:e._delegate._internalPath}function gL(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new k(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Yd=class{},Mo=class extends Yd{};function qr(n,e,...t){let r=[];e instanceof Yd&&r.push(e),r=r.concat(t),function(s){let o=s.filter(u=>u instanceof bb).length,a=s.filter(u=>u instanceof sy).length;if(o>1||o>0&&a>0)throw new k(N.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var sy=class n extends Mo{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return yL(e._query,t),new Pt(e.firestore,e.converter,nT(e._query,t))}_parse(e){let t=Po(e.firestore);return function(s,o,a,u,l,d,h){let g;if(l.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new k(N.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){xF(h,d);let y=[];for(let v of h)y.push(RF(u,s,v));g={arrayValue:{values:y}}}else g=RF(u,s,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||xF(h,d),g=dL(a,o,h,d==="in"||d==="not-in");return Ee.create(l,d,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function w0(n,e,t){let r=e,i=Ey("where",n);return sy._create(i,r,t)}var bb=class n extends Yd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Oe.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let u of a)yL(o,u),o=nT(o,u)}(e._query,t),new Pt(e.firestore,e.converter,nT(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Ab=class n extends Mo{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,o){if(i.startAt!==null)throw new k(N.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new k(N.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Co(s,o)}(e._query,this._field,this._direction);return new Pt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new dr(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function E0(n,e="asc"){let t=e,r=Ey("orderBy",n);return Ab._create(r,t)}var oy=class n extends Mo{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new Pt(e.firestore,e.converter,Dm(e._query,this._limit,this._limitType))}};function I0(n){return iL("limit",n),oy._create("limit",n,"F")}function C0(n){return iL("limitToLast",n),oy._create("limitToLast",n,"L")}var ay=class n extends Mo{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=mL(e,this.type,this._docOrFields,this._inclusive);return new Pt(e.firestore,e.converter,function(i,s){return new dr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}};function D0(...n){return ay._create("startAt",n,!0)}function T0(...n){return ay._create("startAfter",n,!1)}var uy=class n extends Mo{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=mL(e,this.type,this._docOrFields,this._inclusive);return new Pt(e.firestore,e.converter,function(i,s){return new dr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}};function b0(...n){return uy._create("endBefore",n,!1)}function A0(...n){return uy._create("endAt",n,!0)}function mL(n,e,t,r){if(t[0]=_e(t[0]),t[0]instanceof xo)return function(s,o,a,u,l){if(!u)throw new k(N.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of wu(s))if(h.field.isKeyField())d.push(Io(o,u.key));else{let g=u.data.field(h.field);if(ly(g))throw new k(N.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){let y=h.field.canonicalString();throw new k(N.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${y}' (used as the orderBy) does not exist.`)}d.push(g)}return new Ur(d,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=Po(n.firestore);return function(o,a,u,l,d,h){let g=o.explicitOrderBy;if(d.length>g.length)throw new k(N.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let y=[];for(let v=0;v<d.length;v++){let D=d[v];if(g[v].field.isKeyField()){if(typeof D!="string")throw new k(N.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof D}`);if(!Vb(o)&&D.indexOf("/")!==-1)throw new k(N.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${D}' contains a slash.`);let A=o.path.child(Ae.fromString(D));if(!q.isDocumentKey(A))throw new k(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${A}' is not because it contains an odd number of segments.`);let P=new q(A);y.push(Io(a,P))}else{let A=dL(u,l,D);y.push(A)}}return new Ur(y,h)}(n._query,n.firestore._databaseId,i,e,t,r)}}function RF(n,e,t){if(typeof(t=_e(t))=="string"){if(t==="")throw new k(N.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Vb(e)&&t.indexOf("/")!==-1)throw new k(N.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(Ae.fromString(t));if(!q.isDocumentKey(r))throw new k(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Io(n,new q(r))}if(t instanceof $e)return Io(n,t._key);throw new k(N.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${gy(t)}.`)}function xF(n,e){if(!Array.isArray(n)||n.length===0)throw new k(N.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function yL(n,e){let t=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new k(N.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new k(N.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Lu=class{convertValue(e,t="none"){switch(Eo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ke(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(fs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw z()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return No(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Ke(o.doubleValue));return new Kd(s)}convertGeoPoint(e){return new Ro(Ke(e.latitude),Ke(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Ob(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Pd(e));default:return null}}convertTimestamp(e){let t=fi(e);return new Ze(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=Ae.fromString(e);W(AV(r));let i=new ps(r.get(1),r.get(3)),s=new q(r.popFirst(5));return i.isEqual(t)||ut(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function Iy(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Sb=class extends Lu{constructor(e){super(),this.firestore=e}convertBytes(e){return new $r(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new $e(this.firestore,null,t)}};var hi=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Yn=class extends xo{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new ls(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Ey("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},ls=class extends Yn{data(e={}){return super.data(e)}},pr=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new hi(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new ls(this._firestore,this._userDataWriter,r.key,r,new hi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new k(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let u=new ls(i._firestore,i._userDataWriter,a.doc.key,a.doc,new hi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let u=new ls(i._firestore,i._userDataWriter,a.doc.key,a.doc,new hi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,d=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:TK(a.type),doc:u,oldIndex:l,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function TK(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return z()}}function Cy(n,e){return n instanceof Yn&&e instanceof Yn?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof pr&&e instanceof pr&&n._firestore===e._firestore&&vy(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function S0(n){n=Se(n,$e);let e=Se(n.firestore,Je);return tL(kt(e),n._key).then(t=>V0(e,n,t))}var yi=class extends Lu{constructor(e){super(),this.firestore=e}convertBytes(e){return new $r(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new $e(this.firestore,null,t)}};function R0(n){n=Se(n,$e);let e=Se(n.firestore,Je),t=kt(e),r=new yi(e);return _K(t,n._key).then(i=>new Yn(e,r,n._key,i,new hi(i!==null&&i.hasLocalMutations,!0),n.converter))}function x0(n){n=Se(n,$e);let e=Se(n.firestore,Je);return tL(kt(e),n._key,{source:"server"}).then(t=>V0(e,n,t))}function M0(n){n=Se(n,Pt);let e=Se(n.firestore,Je),t=kt(e),r=new yi(e);return gL(n._query),nL(t,n._query).then(i=>new pr(e,r,n,i))}function N0(n){n=Se(n,Pt);let e=Se(n.firestore,Je),t=kt(e),r=new yi(e);return vK(t,n._query).then(i=>new pr(e,r,n,i))}function P0(n){n=Se(n,Pt);let e=Se(n.firestore,Je),t=kt(e),r=new yi(e);return nL(t,n._query,{source:"server"}).then(i=>new pr(e,r,n,i))}function Dy(n,e,t){n=Se(n,$e);let r=Se(n.firestore,Je),i=Iy(n.converter,e,t);return zu(r,[wy(Po(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,rt.none())])}function Ty(n,e,t,...r){n=Se(n,$e);let i=Se(n.firestore,Je),s=Po(i),o;return o=typeof(e=_e(e))=="string"||e instanceof fr?y0(s,"updateDoc",n._key,e,t,r):m0(s,"updateDoc",n._key,e),zu(i,[o.toMutation(n._key,rt.exists(!0))])}function k0(n){return zu(Se(n.firestore,Je),[new vs(n._key,rt.none())])}function O0(n,e){let t=Se(n.firestore,Je),r=Gu(n),i=Iy(n.converter,e);return zu(t,[wy(Po(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,rt.exists(!1))]).then(()=>r)}function by(n,...e){var t,r,i;n=_e(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||mb(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(mb(e[o])){let h=e[o];e[o]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let u,l,d;if(n instanceof $e)l=Se(n.firestore,Je),d=Uu(n._key.path),u={next:h=>{e[o]&&e[o](V0(l,n,h))},error:e[o+1],complete:e[o+2]};else{let h=Se(n,Pt);l=Se(h.firestore,Je),d=h._query;let g=new yi(l);u={next:y=>{e[o]&&e[o](new pr(l,g,h,y))},error:e[o+1],complete:e[o+2]},gL(n._query)}return function(g,y,v,D){let A=new Fu(D),P=new Wd(y,A,v);return g.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return Wb(yield Vu(g),P)})),()=>{A.Za(),g.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return Kb(yield Vu(g),P)}))}}(kt(l),d,a,u)}function F0(n,e){return wK(kt(n=Se(n,Je)),mb(e)?e:{next:e})}function zu(n,e){return function(r,i){let s=new wt;return r.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return X8(yield i0(r),i,s)})),s.promise}(kt(n),e)}function V0(n,e,t){let r=t.docs.get(e._key),i=new yi(n);return new Yn(n,i,e._key,r,new hi(t.hasPendingWrites,t.fromCache),e.converter)}var bK={maxAttempts:5};var cy=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Po(e)}set(e,t,r){this._verifyNotCommitted();let i=us(e,this._firestore),s=Iy(i.converter,t,r),o=wy(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,rt.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=us(e,this._firestore),o;return o=typeof(t=_e(t))=="string"||t instanceof fr?y0(this._dataReader,"WriteBatch.update",s._key,t,r,i):m0(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,rt.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=us(e,this._firestore);return this._mutations=this._mutations.concat(new vs(t._key,rt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new k(N.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function us(n,e){if((n=_e(n)).firestore!==e)throw new k(N.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var Rb=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Po(t)}get(t){let r=us(t,this._firestore),i=new Sb(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return z();let o=s[0];if(o.isFoundDocument())return new xo(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new xo(this._firestore,i,r._key,null,r.converter);throw z()})}set(t,r,i){let s=us(t,this._firestore),o=Iy(s.converter,r,i),a=wy(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){let o=us(t,this._firestore),a;return a=typeof(r=_e(r))=="string"||r instanceof fr?y0(this._dataReader,"Transaction.update",o._key,r,i,s):m0(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){let r=us(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=us(e,this._firestore),r=new yi(this._firestore);return super.get(e).then(i=>new Yn(this._firestore,r,t._key,i._document,new hi(!1,!1),t.converter))}};function L0(n,e,t){n=Se(n,Je);let r=Object.assign(Object.assign({},bK),t);return function(s){if(s.maxAttempts<1)throw new k(N.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let u=new wt;return s.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){let l=yield gK(s);new pb(s.asyncQueue,l,a,o,u).au()})),u.promise}(kt(n),i=>e(new Rb(n,i)),r)}function j0(){return new Qd("deleteField")}function U0(){return new wb("serverTimestamp")}function B0(...n){return new Eb("arrayUnion",n)}function $0(...n){return new Ib("arrayRemove",n)}function q0(n){return new Cb("increment",n)}(function(e,t=!0){(function(i){ju=i})(Mh),Ss(new yn("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Je(new PD(r.getProvider("auth-internal")),new VD(r.getProvider("app-check-internal")),function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new k(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ps(l.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),it(S1,"4.7.3",e),it(S1,"4.7.3","esm2017")})();var rh=class{constructor(e){return e}},_L="firestore",H0=class{constructor(){return Xs(_L)}};var G0=new H("angularfire2.firestore-instances");function AK(n,e){let t=Ua(_L,n,e);return t&&new rh(t)}function SK(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new rh(r)}}var RK={provide:H0,deps:[[new tt,G0]]},xK={provide:rh,useFactory:AK,deps:[[new tt,G0],or]};function vL(n,...e){return it("angularfire",bt.full,"fst"),Xt([xK,RK,{provide:G0,useFactory:SK(n),multi:!0,deps:[le,Dt,pn,si,[new tt,ho],[new tt,nn],...e]}])}var wL=Gi(oL,!0);var ih=class{constructor(e){return e}},EL="database",z0=class{constructor(){return Xs(EL)}};var W0=new H("angularfire2.database-instances");function MK(n,e){let t=Ua(EL,n,e);return t&&new ih(t)}function NK(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new ih(r)}}var PK={provide:z0,deps:[[new tt,W0]]},kK={provide:ih,useFactory:MK,deps:[[new tt,W0],or]};function IL(n,...e){return it("angularfire",bt.full,"rtdb"),Xt([kK,PK,{provide:W0,useFactory:NK(n),multi:!0,deps:[le,Dt,pn,si,[new tt,ho],[new tt,nn],...e]}])}var CL=Gi(bO,!0);var OK="@firebase/firestore-compat",FK="0.3.38";function X0(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new k("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function DL(){if(typeof Uint8Array>"u")throw new k("unimplemented","Uint8Arrays are not available in this environment.")}function TL(){if(!qF())throw new k("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Ay=class n{constructor(e){this._delegate=e}static fromBase64String(e){return TL(),new n($r.fromBase64String(e))}static fromUint8Array(e){return DL(),new n($r.fromUint8Array(e))}toBase64(){return TL(),this._delegate.toBase64()}toUint8Array(){return DL(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function K0(n){return VK(n,["next","error","complete"])}function VK(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var Q0=class{enableIndexedDbPersistence(e,t){return u0(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return c0(e._delegate)}clearIndexedDbPersistence(e){return l0(e._delegate)}},Sy=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof ps||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&lr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){my(this._delegate,e,t,r)}enableNetwork(){return h0(this._delegate)}disableNetwork(){return f0(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,o0("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return d0(this._delegate)}onSnapshotsInSync(e){return F0(this._delegate,e)}get app(){if(!this._appCompat)throw new k("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Qu(this,yy(this._delegate,e))}catch(t){throw cn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Hr(this,Gu(this._delegate,e))}catch(t){throw cn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Lo(this,a0(this._delegate,e))}catch(t){throw cn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return L0(this._delegate,t=>e(new Ry(this,t)))}batch(){return kt(this._delegate),new xy(new cy(this._delegate,e=>zu(this._delegate,e)))}loadBundle(e){return p0(this._delegate,e)}namedQuery(e){return g0(this._delegate,e).then(t=>t?new Lo(this,t):null)}},Wu=class extends Lu{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ay(new $r(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Hr.forKey(t,this.firestore,null)}};function LK(n){xb(n)}var Ry=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Wu(e)}get(e){let t=Oo(e);return this._delegate.get(t).then(r=>new Fo(this._firestore,new Yn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=Oo(e);return r?(X0("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=Oo(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=Oo(e);return this._delegate.delete(t),this}},xy=class{constructor(e){this._delegate=e}set(e,t,r){let i=Oo(e);return r?(X0("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=Oo(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=Oo(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},Ku=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new ls(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Vo(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new n(e,new Wu(e),t),i.set(t,s)),s}};Ku.INSTANCES=new WeakMap;var Hr=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Wu(e)}static forPath(e,t,r){if(e.length%2!==0)throw new k("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new $e(t._delegate,r,new q(e)))}static forKey(e,t,r){return new n(t,new $e(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Qu(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Qu(this.firestore,yy(this._delegate,e))}catch(t){throw cn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=_e(e),e instanceof $e?_y(this._delegate,e):!1}set(e,t){t=X0("DocumentReference.set",t);try{return t?Dy(this._delegate,e,t):Dy(this._delegate,e)}catch(r){throw cn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?Ty(this._delegate,e):Ty(this._delegate,e,t,...r)}catch(i){throw cn(i,"updateDoc()","DocumentReference.update()")}}delete(){return k0(this._delegate)}onSnapshot(...e){let t=bL(e),r=AL(e,i=>new Fo(this.firestore,new Yn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return by(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=R0(this._delegate):e?.source==="server"?t=x0(this._delegate):t=S0(this._delegate),t.then(r=>new Fo(this.firestore,new Yn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ku.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function cn(n,e,t){return n.message=n.message.replace(e,t),n}function bL(n){for(let e of n)if(typeof e=="object"&&!K0(e))return e;return{}}function AL(n,e){var t,r;let i;return K0(n[0])?i=n[0]:K0(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Fo=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Hr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Cy(this._delegate,e._delegate)}},Vo=class extends Fo{data(e){let t=this._delegate.data(e);return this._delegate._converter||MF(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},Lo=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Wu(e)}where(e,t,r){try{return new n(this.firestore,qr(this._delegate,w0(e,t,r)))}catch(i){throw cn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,qr(this._delegate,E0(e,t)))}catch(r){throw cn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,qr(this._delegate,I0(e)))}catch(t){throw cn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,qr(this._delegate,C0(e)))}catch(t){throw cn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,qr(this._delegate,D0(...e)))}catch(t){throw cn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,qr(this._delegate,T0(...e)))}catch(t){throw cn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,qr(this._delegate,b0(...e)))}catch(t){throw cn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,qr(this._delegate,A0(...e)))}catch(t){throw cn(t,"endAt()","Query.endAt()")}}isEqual(e){return vy(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=N0(this._delegate):e?.source==="server"?t=P0(this._delegate):t=M0(this._delegate),t.then(r=>new sh(this.firestore,new pr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=bL(e),r=AL(e,i=>new sh(this.firestore,new pr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return by(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ku.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},Y0=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Vo(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},sh=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Lo(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Vo(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Y0(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Vo(this._firestore,r))})}isEqual(e){return Cy(this._delegate,e._delegate)}},Qu=class n extends Lo{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Hr(this.firestore,e):null}doc(e){try{return e===void 0?new Hr(this.firestore,Gu(this._delegate)):new Hr(this.firestore,Gu(this._delegate,e))}catch(t){throw cn(t,"doc()","CollectionReference.doc()")}}add(e){return O0(this._delegate,e).then(t=>new Hr(this.firestore,t))}isEqual(e){return _y(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ku.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Oo(n){return Se(n,$e)}var Z0=class n{constructor(...e){this._delegate=new fr(...e)}static documentId(){return new n(ct.keyField().canonicalString())}isEqual(e){return e=_e(e),e instanceof fr?this._delegate._internalPath.isEqual(e._internalPath):!1}};var J0=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=U0();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=j0();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=B0(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=$0(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=q0(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var jK={Firestore:Sy,GeoPoint:Ro,Timestamp:Ze,Blob:Ay,Transaction:Ry,WriteBatch:xy,DocumentReference:Hr,DocumentSnapshot:Fo,Query:Lo,QueryDocumentSnapshot:Vo,QuerySnapshot:sh,CollectionReference:Qu,FieldPath:Z0,FieldValue:J0,setLogLevel:LK,CACHE_SIZE_UNLIMITED:sL};function UK(n,e){n.INTERNAL.registerComponent(new yn("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},jK)))}function BK(n){UK(n,(e,t)=>new Sy(e,t,new Q0)),n.registerVersion(OK,FK)}BK(vt);function $K(n,e=ks){return new ce(t=>{let r;return e!=null?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}function SL(n,e){return $K(n,e)}function qK(n,e){return SL(n,e).pipe(Os(void 0),Cc(),Q(t=>{let[r,i]=t;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function nA(n,e){return SL(n,e).pipe(Q(t=>({payload:t,type:"query"})))}var My=class{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let r=this.ref.collection(e),{ref:i,query:s}=PL(r,t);return new Py(i,s,this.afs)}snapshotChanges(){return qK(this.ref,this.afs.schedulers.outsideAngular).pipe(nt)}valueChanges(e={}){return this.snapshotChanges().pipe(Q(({payload:t})=>e.idField?xe(G({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return Ce(this.ref.get(e)).pipe(nt)}};function Ny(n,e){return nA(n,e).pipe(Os(void 0),Cc(),Q(t=>{let[r,i]=t,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{let l=s.find(h=>h.doc.ref.isEqual(a.ref)),d=r?.payload.docs.find(h=>h.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&d&&JSON.stringify(d.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),o}))}function RL(n,e,t){return Ny(n,t).pipe(yr((r,i)=>HK(r,i.map(s=>s.payload),e),[]),Ic(),Q(r=>r.map(i=>({type:i.type,payload:i}))))}function HK(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=GK(n,r))}),n}function eA(n,e,t,...r){let i=n.slice();return i.splice(e,t,...r),i}function GK(n,e){switch(e.type){case"added":if(!(n[e.newIndex]&&n[e.newIndex].doc.ref.isEqual(e.doc.ref)))return eA(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||n[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return eA(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return eA(n,e.oldIndex,1);break}return n}function xL(n){return(!n||n.length===0)&&(n=["added","removed","modified"]),n}var Py=class{ref;query;afs;constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=Ny(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(Q(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(Os(void 0),Cc(),Ct(([r,i])=>i.length>0||!r),Q(([,r])=>r),nt)}auditTrail(e){return this.stateChanges(e).pipe(yr((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=xL(e);return RL(this.query,t,this.afs.schedulers.outsideAngular).pipe(nt)}valueChanges(e={}){return nA(this.query,this.afs.schedulers.outsideAngular).pipe(Q(t=>t.payload.docs.map(r=>e.idField?xe(G({},r.data()),{[e.idField]:r.id}):r.data())),nt)}get(e){return Ce(this.query.get(e)).pipe(nt)}add(e){return this.ref.add(e)}doc(e){return new My(this.ref.doc(e),this.afs)}},tA=class{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?Ny(this.query,this.afs.schedulers.outsideAngular).pipe(nt):Ny(this.query,this.afs.schedulers.outsideAngular).pipe(Q(t=>t.filter(r=>e.indexOf(r.type)>-1)),Ct(t=>t.length>0),nt)}auditTrail(e){return this.stateChanges(e).pipe(yr((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=xL(e);return RL(this.query,t,this.afs.schedulers.outsideAngular).pipe(nt)}valueChanges(e={}){return nA(this.query,this.afs.schedulers.outsideAngular).pipe(Q(r=>r.payload.docs.map(i=>e.idField?G({[e.idField]:i.id},i.data()):i.data())),nt)}get(e){return Ce(this.query.get(e)).pipe(nt)}},ML=new H("angularfire2.enableFirestorePersistence"),NL=new H("angularfire2.firestore.persistenceSettings"),zK=new H("angularfire2.firestore.settings"),WK=new H("angularfire2.firestore.use-emulator");function PL(n,e=t=>t){return{query:e(n),ref:n}}var KK=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(t,r,i,s,o,a,u,l,d,h,g,y,v,D,A,P,B){this.schedulers=u;let F=eo(t,a,r),K=d;h&&Ml(F,a,g,v,D,A,y,P),[this.firestore,this.persistenceEnabled$]=Ba(`${F.name}.firestore`,"AngularFirestore",F.name,()=>{let te=a.runOutsideAngular(()=>F.firestore());if(s&&te.settings(s),K&&te.useEmulator(...K),i&&!ii(o)){let X=()=>{try{return Ce(te.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(I){return typeof console<"u"&&console.warn(I),Z(!1)}};return[te,a.runOutsideAngular(X)]}else return[te,Z(!1)]},[s,K,i])}collection(t,r){let i;typeof t=="string"?i=this.firestore.collection(t):i=t;let{ref:s,query:o}=PL(i,r),a=this.schedulers.ngZone.run(()=>s);return new Py(a,o,this)}collectionGroup(t,r){let i=r||(o=>o),s=this.firestore.collectionGroup(t);return new tA(i(s),this)}doc(t){let r;typeof t=="string"?r=this.firestore.doc(t):r=t;let i=this.schedulers.ngZone.run(()=>r);return new My(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||n)(V(Wi),V(Ki,8),V(ML,8),V(zK,8),V(at),V(le),V(pn),V(NL,8),V(WK,8),V(Nl,8),V(Tl,8),V(bl,8),V(Al,8),V(Sl,8),V(Rl,8),V(xl,8),V(nn,8))};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),kL=(()=>{class n{constructor(){vt.registerVersion("angularfire",bt.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:ML,useValue:!0},{provide:NL,useValue:t}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Gt({type:n});static \u0275inj=Ht({providers:[KK]})}return n})();var OL={apiKey:"AIzaSyB80VTr7cPxvt1N8cX5DXRaO1z_VWinuJo",authDomain:"employee-management-c1a06.firebaseapp.com",databaseURL:"https://employee-management-c1a06-default-rtdb.firebaseio.com",projectId:"employee-management-c1a06",storageBucket:"employee-management-c1a06.firebasestorage.app",messagingSenderId:"481676635426",appId:"1:481676635426:web:3c371ff5fdd31fbabf497b",measurementId:"G-LWLWMSWGE9"};var FL={providers:[yP(I1),Wv([LP.initializeApp(OL),jP,LO,kL]),xN(),CP(()=>DP({projectId:"employee-management-c1a06",appId:"1:481676635426:web:3c371ff5fdd31fbabf497b",databaseURL:"https://employee-management-c1a06-default-rtdb.firebaseio.com",storageBucket:"employee-management-c1a06.firebasestorage.app",apiKey:"AIzaSyB80VTr7cPxvt1N8cX5DXRaO1z_VWinuJo",authDomain:"employee-management-c1a06.firebaseapp.com",messagingSenderId:"481676635426",measurementId:"G-LWLWMSWGE9"})),D1(()=>T1()),vL(()=>wL()),IL(()=>CL())]};var VL=(()=>{class n{constructor(){this.title="employee-management-system"}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Un({type:n,selectors:[["app-root"]],standalone:!0,features:[Hn],decls:12,vars:0,consts:[[1,"navbar"],[1,"logo"],[1,"list"],[1,"item"],["href","#"],[1,"container","my-4"]],template:function(r,i){r&1&&(Te(0,"nav",0)(1,"div",1),ke(2,"Employeeeep"),we(),Te(3,"ul",2)(4,"li",3)(5,"a",4),ke(6,"Home"),we()(),Te(7,"li",3)(8,"a"),ke(9,"EmployeeList"),we()()()(),Te(10,"div",5),qn(11,"router-outlet"),we())},dependencies:[vl],styles:["ul[_ngcontent-%COMP%]{display:flex;list-style:none;list-style-type:none}li[_ngcontent-%COMP%]{padding:15px}a[_ngcontent-%COMP%]{text-decoration:none;color:#fff}a[_ngcontent-%COMP%]:hover{color:#00aeff}.logo[_ngcontent-%COMP%]{font-size:32px;font-weight:700}.navbar[_ngcontent-%COMP%]{background-color:#000;padding:0 50px;color:#fff}"]})}}return n})();SN(VL,FL).catch(n=>console.error(n));
